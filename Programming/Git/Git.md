Команда `git init` запускает процесс инициализации нового Git-репозитория в текущей директории.

## Что создаётся

- Появляется скрытая папка `.git` — это **основной репозиторий**. В ней хранятся:
    
    - `HEAD` — указатель на текущую ветку
        
    - `config` — настройки репозитория
        
    - `objects/` — база данных всех коммитов, файлов и деревьев
        
    - `refs/` — ссылки на ветки и теги
        
    - `hooks/` — скрипты, которые можно запускать при событиях (например, перед коммитом)

Git — это не просто система версий, это **база данных объектов**, и всё, что мы видим (файлы, коммиты, ветки) — это ссылки на эти объекты.

Git хранит всё в виде **4 типов объектов**, каждый из которых имеет уникальный `SHA-1` хеш:

### 1. **Blob (Binary Large Object)** Файлы

- Содержит **содержимое файла** (только данные, без имени или прав доступа).
    
- Один и тот же файл с одинаковым содержимым будет иметь один и тот же blob — даже в разных коммитах.

Пример: файл `README.md` → blob с хешем `a1b2c3...`

### 2. **Tree** (Директории)

- Представляет **директорию**: содержит список файлов и поддиректорий, указывая на blob'ы и другие tree'ы.
    
- Хранит имена файлов, права доступа и ссылки на объекты.

Пример: корневая папка проекта → tree с ссылками на blobs и другие trees

### 3. **Commit**

- Содержит:
    
    - Ссылку на tree (состояние проекта)
        
    - Ссылку на родительский коммит (или несколько, если это merge)
        
    - Метаданные: автор, дата, сообщение

Пример: `git commit -m "Initial commit"` → создаёт commit-объект

### 4. **Tag**

- Указывает на commit (или другой объект) и может содержать подпись.
    
- Бывают **аннотированные** (с метаданными) и **легковесные** (просто ссылка).

Пример: `v1.0.0` → tag на коммит с релизом

**Как они связаны**

```text
Commit
  └── Tree
        ├── Blob (file1.txt)
        ├── Blob (main.py)
        └── Tree (subfolder/)
               └── Blob (nested.txt)
```

## Как посмотреть объекты

```bash
git cat-file -p <hash>   # Посмотреть содержимое объекта
git ls-tree HEAD         # Посмотреть дерево текущего коммита
git rev-parse HEAD       # Получить хеш текущего коммита
```

## Как **Git** работает под капотом? 

Мы создадим `blob`, `tree` и `commit` вручную, без `git add` и `git commit`.

##### Шаг 1: Инициализируем репозиторий

```shell
mkdir git-lab && cd git-lab
git init
```

##### Шаг 2: Создаём blob-объект

Создаём файл:

```shell
echo "Hello Git World" > hello.txt
```

Создаём **blob** вручную:

```shell
git hash-object -w hello.txt
```

**Git** вернёт `SHA-1` хеш — это `ID` blob-объекта. 

```
ea701271a58054773256b0ff0dbf2fde425f19d6
```

И создаст `blob` объект в директории `.git/objects`

Посмотреть содержимое:

```shell
git cat-file -p <blob_hash>
```

##### Шаг 3: Создаём tree-объект

Создаем индекс вручную:

```shell
git update-index --add hello.txt
```

Создай tree:

```shell
git write-tree
```

Это создаёт **snapshot** текущего состояния файлов. 

Посмотреть дерево:

```shell
git ls-tree <tree_hash>
```

```shell
100644 blob ea701271a58054773256b0ff0dbf2fde425f19d6    hello.txt
```

##### Шаг 4: Создаём commit вручную


```shell
git commit-tree <tree_hash> -m "Мой ручной коммит"
```

**Git** вернёт хеш коммита.

```
565c1e81e364d72767d6c0c95ae0513473cdb237
```

Посмотреть:

```shell
git cat-file -p <commit_hash>
```

```shell
tree e497723a6beb377202329333c7fa5b074f298fb7
author Alexandr <ale88andr@gmail.com> 1756380844 +0000
committer Alexandr <ale88andr@gmail.com> 1756380844 +0000

Мой ручной коммит
```

##### Шаг 5: Привязываем HEAD

```shell
git update-ref HEAD <commit_hash>
```

при этом в `.git/refs/heads/main` изменится `SHA-1` коммита на `<commit_hash>`

| Объект | Команда               | Назначение                   |
| ------ | --------------------- | ---------------------------- |
| Blob   | `git hash-object -w`  | Содержимое файла             |
| Tree   | `git write-tree`      | Структура файлов             |
| Commit | `git commit-tree`     | Снимок состояния + сообщение |
| HEAD   | `git update-ref HEAD` | Указатель на текущий коммит  |
Создадим ветку вручную:

Создадим новый файл в директории `.git/refs/heads`

```
sudo nano .git/refs/heads/new
```

и занесем туда хеш коммита из существующей ветки, например, `main`

проверяем ветки:

```shell
git branch 
* main
  new
```

## Области **Git**

![[Pasted image 20250828175325.png]]



## Commit Messages

![[Pasted image 20250828175644.png]]
