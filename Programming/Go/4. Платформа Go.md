## Слайсы

Слайс -  реализация в Go динамического массива

Структура слайса:

```go
type slice struct { 
	array unsafe.Pointer 
	len int 
	cap int
}
```

```go
a := []int8{1, 2, 3}
```

![[Pasted image 20251103130616.png]]

### `append`

Допустим мы хотим добавить элемент в слайс

```go
a = append(a, 4)
```

При этом происходит следующее:

1. Вычисляется новая длинна массива `new len = 4`
2. Новая длинна массива сравнивается с `cap`(вместимостью) текущего массива
3. Если новая длинна больше текущей `cap`, то в памяти выделяется место под новый массив (при этом у нового массива `cap` будет вычисляться по формуле: `new cap = cap * 2`)
4. В новый массив копируются значения старого и добавляется новое значение
5. Обновляется ссылка `array` в структуре на новую ячейку памяти
6. Обновляются значения `len` и `cap` в структуре

![[Pasted image 20251103132554.png]]

### Механика работы ссылочного типа

Слайс - **ссылочный** тип.

При передачи слайса в функцию - передается копия слайса, но сама ссылка на массив в копии остается **прежней**:

Если мы хотим поменять значения в копии - обновится исходный массив:

![[Pasted image 20251103135000.png]]

Если мы хотим добавить элемент в слайс - создастся новый слайс не имеющий отношение к старому

![[Pasted image 20251103133928.png]]

допустим, мы хотим к копии слайса добавить элемент:

![[Pasted image 20251103134300.png]]

при этом выделится новая область памяти, значения из старого массива скопируются в новый, а так же добавится новый элемент. Затем в копии слайса обновится ссылка на `array`

![[Pasted image 20251103134656.png]]

