
## Аутентификация в Astra Linux 1.6 / Настройка блокировки и парольной политики / PAM

Назначение `Astra Linux`: **Построение автоматизированных систем в защищенном исполнении обрабатывающих информацию содержащие сведения составляющие гос.тайну с грифом не выше сов. секретно**

В  `Astra Linux` входит комплекс средств защиты(PARSEC), предназначенный для реализации функций ОС по защите информации от несанкционированного доступа(НСД) и предоставляет администратору безопасности средства управления функционирования комплекса средств защиты(КСЗ)

После первой загрузки ОС в систему может зайти лишь пользователь из группы `astraadmin`, пользователю `root` вход запрещён

![[Pasted image 20231023123421.png]]

Первый вход рекомендуется осуществлять с `Высоким` уровнем целостности (УЦ)

Функции идентификации и аутентификации пользователей в `Astra linux` основываются на механизме `PAM`. `PAM` - это набор библиотек с помощью которых системный администратор может организовать процедуру идентификации и аутентификации пользователей и прикладных программ. Каждый модуль `PAM` реализует собственный механизм аутентификации, так же можно менять порядок модулей, тем самым строить свои сценарии аутентификации. Сценарии аутентификации описываются в конфигурационном файле `etc/pam.conf` и вспомогательной директории `etc/pam.d`

### Настройка аутентификации с помощью графического интерфейса

- `Панель управления` -> `Безопасность` -> `Политика безопасности`

![[Pasted image 20231023125114.png]]

![[Pasted image 20231023125502.png]]

Создадим пользователя:

![[Pasted image 20231023125900.png]]

Создадим для нового пользователя пароль:

![[Pasted image 20231023130206.png]]

Настройка политик учётных записей:

![[Pasted image 20231023130412.png]]

- **Блокировка**
![[Pasted image 20231023130630.png]]

- `Неуспешных попыток` - количество неудачных попыток до блокировки пользователя
- `Период блокировки` - количество секунд блокировки при введении неправильного пароля
- `Период разблокировки` - количество секунд автоматической разблокировки пользователя после количества `Неуспешных попыток`

После изменения политики, изменения запишутся в файл `/etc/pam.d/common-account`

![[Pasted image 20231023131406.png]]

где:
- `pam_tally.so` - модуль отвечающий за локальную аутентификацию
- `deny` -  количество неудачных попыток до блокировки
- `lock_time` - количество секунд блокировки
- `unlock_time` - количество секунд автоматической разблокировки

Эти же изменения записываются в файл `/etc/pam.d/common-auth`

![[Pasted image 20231023133136.png]]

> Если править конфигурационные файлы вручную, то в графическом интерфейсе это отображаться не будет

- **Политика паролей**
![[Pasted image 20231023133513.png]]
![[Pasted image 20231023133727.png]]

Эти же изменения записываются в файл `/etc/pam.d/common-password`

![[Pasted image 20231023134208.png]]

- **Политика создания пользователей** - эта политика будет влиять на утилиту командной строки `adduser`

Утилита командной строки `faillog` покажет текущее состояние пользователей:

![[Pasted image 20231023134759.png]]

либо через графический режим:

![[Pasted image 20231023135013.png]]

