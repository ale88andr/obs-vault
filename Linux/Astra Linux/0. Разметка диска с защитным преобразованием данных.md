
При проведении разметки диска, выбрать `Вручную`

![[Pasted image 20231023141217.png]]

`Продолжить` или `Double click`

Выбираем диск

![[Pasted image 20231023141518.png]]

`Продолжить` или `Double click`

![[Pasted image 20231023141709.png]]

Далее необходимо создать новый раздел

![[Pasted image 20231023144156.png]]

![[Pasted image 20231023144322.png]]

Задаем размер

![[Pasted image 20231023144436.png]]

Выбираем `Первичный`

![[Pasted image 20231023144602.png]]

Выбираем местоположение раздела

![[Pasted image 20231023144717.png]]

Корневой раздел создан!

![[Pasted image 20231023145016.png]]

Создаем раздел `boot`

![[Pasted image 20231023145213.png]]

Создать новый раздел:

![[Pasted image 20231023145413.png]]
Размер
![[Pasted image 20231023145705.png]]
Тип - первичный
![[Pasted image 20231023145730.png]]
Выбираем местоположение
![[Pasted image 20231023145908.png]]

Изменяем точку монтирования

![[Pasted image 20231023150017.png]]

Выбираем `boot - статические файлы системного загрузчика`

![[Pasted image 20231023150116.png]]

Настройка раздела закончена

![[Pasted image 20231023150247.png]]

Теперь создаём swap раздел

![[Pasted image 20231023150420.png]]

![[Pasted image 20231023150727.png]]

![[Pasted image 20231023150827.png]]

![[Pasted image 20231023150920.png]]

![[Pasted image 20231023151027.png]]

Выбираем `Использовать как` **раздел подкачки**

![[Pasted image 20231023151143.png]]

![[Pasted image 20231023151300.png]]

![[Pasted image 20231023151356.png]]

Итого:

![[Pasted image 20231023151902.png]]

Создадим раздел для защищенной информации

![[Pasted image 20231023154119.png]]

![[Pasted image 20231023154158.png]]

![[Pasted image 20231023154223.png]]

Тип раздела выбираем '`Логический`'

![[Pasted image 20231023154315.png]]

Выбираем `Использовать как` **Физический том для защитного преобразования**

![[Pasted image 20231023154549.png]]

![[Pasted image 20231023154625.png]]

Далее можно менять настройки шифрования раздела

![[Pasted image 20231023154801.png]]

Итого получим раздел с типом `crypto`

![[Pasted image 20231023154908.png]]

Далее нужно настроить `защитное преобразование для томов`

![[Pasted image 20231023155120.png]]

Сохраняем все изменения на диск

![[Pasted image 20231023155220.png]]

Создаём **защитно преобразованные тома**

![[Pasted image 20231023155551.png]]

Выбираем наш раздел с типом `crypto`

![[Pasted image 20231023162502.png]]

и нажимаем **закончить**

![[Pasted image 20231023162722.png]]

Появится ошибка связанная с разделом подкачки

![[Pasted image 20231023163018.png]]

Нажимаем `Вернуться` и в окне **Разметка диска** опять выбираем `защитное преобразование для томов`  и выбираем `Создать защитно преобразованные тома`

![[Pasted image 20231023163506.png]]

и выбираем раздел с подкачкой

![[Pasted image 20231023163612.png]]

![[Pasted image 20231023163722.png]]

![[Pasted image 20231023163849.png]]

Задаем пароль для шифрования для каждого из разделов:

![[Pasted image 20231023163953.png]]

![[Pasted image 20231023164136.png]]

Итого получилось два зашифрованных раздела:

![[Pasted image 20231023164251.png]]

Теперь необходимо привязать менеджер логических томов к шифрованным разделам

![[Pasted image 20231023164537.png]]

Соглашаемся

![[Pasted image 20231023164643.png]]

Выбираем `Создать группу томов`

![[Pasted image 20231023164815.png]]

Задаем имя группы

![[Pasted image 20231023165021.png]]

Выбираем зашифрованный том

![[Pasted image 20231023165136.png]]

то же самое повторяем для swap раздела

Далее необходимо создать логический том:

![[Pasted image 20231023170641.png]]

Вибираем группу 

![[Pasted image 20231023170756.png]]

Задаем имя логического тома

![[Pasted image 20231023170903.png]]

Далее размер оставляем тот же

![[Pasted image 20231023171100.png]]

Логический том для файла подкачки создан, назначаем его использование как `раздел подкачки` :

![[Pasted image 20231023171426.png]]

![[Pasted image 20231023171520.png]]

![[Pasted image 20231023171705.png]]

Теперь настраиваем логические тома для основного шифрованного раздела:

![[Pasted image 20231023171851.png]]

Соглашаемся

![[Pasted image 20231023171930.png]]

Создаём новый логический том

![[Pasted image 20231023172056.png]]

Выбараем группу:

![[Pasted image 20231023172212.png]]

Создаём для `/var`

![[Pasted image 20231023172349.png]]

Задаем размер (так как будет создаваться 2 тома - половиним размер)

![[Pasted image 20231023172532.png]]

Логический том для `/var` создан, создаём логический том для `/home`

![[Pasted image 20231023172706.png]]

![[Pasted image 20231023172740.png]]

![[Pasted image 20231023172817.png]]

Используем весь оставшийся объем, итого:

![[Pasted image 20231023172906.png]]

Теперь необходимо настроить эти тома:

![[Pasted image 20231023173102.png]]

Настраиваем home, `Использовать как`: **Журналируемая файловая система Ext4**

![[Pasted image 20231023173229.png]]

`Точка монтирования`: `/home`

![[Pasted image 20231023173407.png]]

Настройка раздела закончена

![[Pasted image 20231023173459.png]]

То же самое проделываем для **var**

![[Pasted image 20231023173621.png]]

Итого, диск стал выглядеть так:

![[Pasted image 20231023173744.png]]

Разметка диска с шифрованием подкаталогов ОС `/home` и `/var` закончена

![[Pasted image 20231023173957.png]]

---
# Разметка диска по RedBook

Astra RedBook:

https://wiki.astralinux.ru/pages/viewpage.action?pageId=57444116
# При установке ОС

- Обязательно использовать при установке ОС [защитное преобразование дисков](https://wiki.astralinux.ru/pages/viewpage.action?pageId=36078012),  
    и по возможности обеспечить невозможность физического доступа к жесткому диску, на котором установлена ОС  

- Создать отдельные дисковые разделы 
    
    `/`  
    `/boot`  
    `/home`  
    `/tmp`  
    `/var/tmp`

-  Создать отдельные дисковые разделы в соответствии с рекомендациями:  
 
|Раздел|Рекомендации по установке/настройке|Рекомендованная файловая система|Рекомендованные опции монтирования|
    |---|---|---|---|---|
    |1|/|С защитным преобразованием (при условии, что каталог /boot размещён в отдельном дисковом разделе).|ext4|defaults|
    |2|/boot|Без защитного преобразования данных.  <br>Нельзя размещать этот раздел в LVM!!!  <br>При установке ОС с размещением каталога /boot в отдельном дисковом разделе (в том числе - при установке с использованием LVM) рекомендуется выделить под этот раздел не менее 512МБ.|ext2, ext3, ext4|defaults|
    |3|/home|С защитным преобразованием.|ext4|noexec,nodev,nosuid|
    |4|/tmp|С защитным преобразованием.  <br>При размере раздела /tmp менее 250МБ весьма вероятно возникновение ошибок при работе с графикой или с большими объёмами данных.|ext4|noexec,nodev,nosuid|
    |5|/var|С защитным преобразованием.  <br>Монтирование возможно с опциями noexec,nodev,nosuid, однако использовать их следует с осторожностью:<br><br>- включение опции noexec при установке ОС приведёт к невозможности установки, при необходимости эту опцию можно включить  после установки;<br>- использование опции noexec после установки может привести к неработоспособности части ПО (в частности, будет нарушена работа установщика пакетов dpkg);|ext4|defaults  <br>по возможности noexec,nodev,nosuid|
    |6|/var/tmp|С защитным преобразованием.  <br>В отличие от каталога /var подкаталог /var/tmp рекомендуется монтировать с опциями `noexec,nodev,nosuid`.|ext4|noexec,nodev,nosuid|
    |7|swap|По возможности не использовать. См. [Область подкачки (swap): особенности применения и обеспечения безопасности](https://wiki.astralinux.ru/pages/viewpage.action?pageId=48759505)  <br>Если необходимо использовать - то использовать с включенным защитным преобразованием и с включенным гарантированным удалением.|swap||
  
> Для всех перечисленных дисковых разделов (кроме раздела /boot) рекомендуется использовать журналируемую файловую систему ext4.  При выборе размера дисковых размеров следует помнить, что при размере раздела /tmp менее 250МБ весьма вероятно возникновение ошибок при работе с графикой или с большими объёмами данных. «В качестве файловых систем на носителях информации компьютеров с ОС (в том числе съемных машинных носителях информации) должны использоваться только файловые системы Ext2/Ext3/Ext4, поддерживающие расширенные (в т.ч. мандатные) атрибуты пользователей и обеспечивающие гарантированное уничтожение (стирание) информации»  «Руководство по КСЗ, Часть 1» РУСБ.10015-01 97 01-1, 2020г., п. 17.3.1 «Условия применения ОС»

- Разделы `/home` `/tmp` `/var/tmp` рекомендуется монтировать с опциями `noexec,nodev,nosuid      `

- В ОС Astra Linux Special Edition РУСБ.10015-01 (очередное обновление 1.6) для предотвращения возможных атак извне установленные сетевые сервисы по умолчанию НЕ ЗАПУСКАЮТСЯ АВТОМАТИЧЕСКИ.  
	Это сервисы:
	- apache2.service
	- bind9.service
	- exim4 dovecot.service
	- ejabberd.service
	- nfs-client.target
	- ntp
	- nfs-server.service
	- nmbd.service
	- smbd.service
	- snmpd.service
	- pppd-dns.service
	- ssh.service
	- vsftpd.service
	- winbind.service
	- bluetooth.service
	- openvpn.service
	- sssd.service
	- firewalld.service

Выбираем диск для разметки:

![[Pasted image 20231024161713.png]]

создаём пустую таблицу разделов

![[Pasted image 20231024162347.png]]

Выбираем свободное дисковое пространство

![[Pasted image 20231024162447.png]]

Сперва создадим раздел `/boot` он не будет шифроваться

создаем новый раздел:

![[Pasted image 20231024162556.png]]

указываем размер (достаточно не менее 512 МБ)

![[Pasted image 20231024163021.png]]

Тип диска - `Первичный`, местоположение - `Начало`

![[Pasted image 20231024163109.png]]

![[Pasted image 20231024163208.png]]

В меню `Настройка раздела`:
- `Точка монтирования`: `/boot`
- `Метка загрузочный`: `вкл`

![[Pasted image 20231024163557.png]]

раздел `/boot` создан.

Далее создаём раздел для защищаемых данных:

![[Pasted image 20231024163820.png]]

![[Pasted image 20231024163916.png]]

Отдаём всё оставшееся место

![[Pasted image 20231024164023.png]]

Тип нового раздела: `Логический`

![[Pasted image 20231024164157.png]]

В меню `Настройка раздела`:
- `Использовать как`: `физический том для защитного преобразования`

![[Pasted image 20231024164403.png]]

Итого получаем незащищенный раздел `/boot` и защищенный логический раздел с типом `crypto`, где будут находится шифрованные разделы(тома)

![[Pasted image 20231024164604.png]]

Переходим к настройке защитного преобразования для томов

![[Pasted image 20231024164818.png]]

записываем изменения

![[Pasted image 20231024164945.png]]

Далее создаем защитно преобразованные тома

![[Pasted image 20231024165038.png]]

и выбираем устройство из предложенных с типом `crypto`

![[Pasted image 20231024165236.png]]

Далее нажимаем `Закончить`

![[Pasted image 20231024165401.png]]

и соглашаемся на очистку данных

![[Pasted image 20231024165543.png]]

после очистки диска вводим парольную фразу для шифрования

Создание защитного тома закончено.

![[Pasted image 20231024173915.png]]

Переходим к настройке логических томов:

![[Pasted image 20231024174040.png]]

Сохраняем изменения на диск:

![[Pasted image 20231024174119.png]]

После форматирования, выбираем `Создать группу томов`

![[Pasted image 20231024174235.png]]

и вводим название группы томов

![[Pasted image 20231024174410.png]]

выбираем нужное устройство

![[Pasted image 20231024174511.png]]

Создаем логический том для корня файловой системы `/`

![[Pasted image 20231024174858.png]]

Выбираем ранее созданную группу

![[Pasted image 20231024174934.png]]

Вводим название

![[Pasted image 20231024175031.png]]

и определяем размер

![[Pasted image 20231024175154.png]]

Логический том для `/` создан, создаем логический том для `/home`:

![[Pasted image 20231024175317.png]]

![[Pasted image 20231024175353.png]]

![[Pasted image 20231024175414.png]]

Задаем размер
![[Pasted image 20231024175154.png]]

Логический том для `/home` создан, создаем логический том для `/tmp:

по аналогии с предыдущими

Логический том для `/tmp` создан, создаем логический том для `/var:

по аналогии с предыдущими

Логический том для `/var` создан, создаем логический том для `/swap`:

по аналогии с предыдущими

Итого

![[Pasted image 20231024175903.png]]

![[Pasted image 20231024175928.png]]

Получим следующую разметку диска

![[Pasted image 20231024180035.png]]

Далее, для каждого тома, необходимо указать **точку монтирования** и **файловую систему**

Для корневой системы:

![[Pasted image 20231025092542.png]]

В меню `Настройка раздела`:
- `Точка монтирования`: `/`
- `Использовать как`: `Журналируемая файловая система Ext4`
![[Pasted image 20231025092753.png]]

Настройка раздела закончена

Для директории `/home`:

![[Pasted image 20231025093223.png]]

В меню `Настройка раздела`:
- `Точка монтирования`: `/home`
- `Использовать как`: `Журналируемая файловая система Ext4`

![[Pasted image 20231025093334.png]]

Настройка раздела закончена

Для директории `/swap`:

![[Pasted image 20231025093517.png]]

В меню `Настройка раздела`:
- `Использовать как`: `Раздел подкачки`

![[Pasted image 20231025093635.png]]

Настройка раздела закончена

Для директории `/tmp`:

![[Pasted image 20231025093748.png]]

В меню `Настройка раздела`:
- `Точка монтирования`: `/tmp`
- `Использовать как`: `Журналируемая файловая система Ext4`

![[Pasted image 20231025093846.png]]

Настройка раздела закончена

Для директории `/var`:

![[Pasted image 20231025093944.png]]

В меню `Настройка раздела`:
- `Точка монтирования`: `/var`
- `Использовать как`: `Журналируемая файловая система Ext4`

![[Pasted image 20231025094023.png]]

Итого:

![[Pasted image 20231025094126.png]]

Нажимаем `Закончить разметку и записать изменения на диск`

![[Pasted image 20231025094237.png]]

Соглашаемся с записью

Далее устанавливаем систему!

После установки системы и перезагрузки, в момент обращения OC к зашифрованным дискам нужно будет ввести парольную фразу.