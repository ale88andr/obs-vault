Концептуально уязвимости аутентификации легко понять. Однако они обычно являются критическими из‑за очевидной связи между аутентификацией и безопасностью.

Уязвимости аутентификации могут позволить злоумышленникам получить доступ к конфиденциальным данным и функционалу. Они также открывают дополнительную поверхность атаки для дальнейших эксплойтов. По этой причине важно научиться выявлять и эксплуатировать уязвимости аутентификации, а также обходить распространённые меры защиты.

В этом разделе:

- Наиболее распространённые механизмы аутентификации, используемые на веб‑сайтах.
- Потенциальные уязвимости в этих механизмах.
- Присущие уязвимости различных механизмов аутентификации.
- Типичные уязвимости, возникающие из‑за их неправильной реализации.
- Как сделать собственные механизмы аутентификации максимально надёжными.

![[password-reset-poisoning.svg]]

## Что такое аутентификация?

Аутентификация — это процесс проверки личности пользователя или клиента. Веб‑сайты потенциально доступны любому, кто подключён к интернету. Это делает надёжные механизмы аутентификации неотъемлемой частью эффективной веб‑безопасности.

Существует три основных типа аутентификации:

- **То, что вы знаете**, например пароль или ответ на секретный вопрос. Иногда это называют «факторами знания».
- **То, что у вас есть**, физический объект, такой как мобильный телефон или токен безопасности. Иногда это называют «факторами владения».
- **То, чем вы являетесь или что вы делаете.** Например, биометрические данные или поведенческие шаблоны. Иногда это называют «факторами присущности».

Механизмы аутентификации используют различные технологии для проверки одного или нескольких из этих факторов.

## В чём разница между аутентификацией и авторизацией?

Аутентификация — это процесс проверки того, что пользователь действительно является тем, за кого себя выдаёт. Авторизация — это проверка того, имеет ли пользователь право что‑то делать.

Например, аутентификация определяет, действительно ли человек, пытающийся войти на сайт под именем пользователя **Carlos123**, является тем самым человеком, который создал эту учётную запись.

После того как **Carlos123** прошёл аутентификацию, его права определяют, что он **авторизован** делать. Например, он может быть авторизован для доступа к личной информации других пользователей или для выполнения действий, таких как удаление учётной записи другого пользователя.

## Как возникают уязвимости аутентификации?

Большинство уязвимостей в механизмах аутентификации возникают двумя способами:

- Механизмы аутентификации слабы, потому что они не обеспечивают достаточной защиты от атак перебора (brute‑force).
- Логические ошибки или плохое программирование в реализации позволяют злоумышленнику полностью обойти механизмы аутентификации. Иногда это называют «сломанная аутентификация» (broken authentication).

Во многих областях веб‑разработки логические ошибки приводят к неожиданному поведению сайта, что может быть, а может и не быть проблемой безопасности. Однако, поскольку аутентификация критически важна для безопасности, очень вероятно, что ошибки в логике аутентификации подвергают сайт угрозам.

## Каков ущерб от уязвимой аутентификации?

Последствия уязвимостей аутентификации могут быть серьёзными. Если злоумышленник обходит аутентификацию или подбирает пароль к чужой учётной записи, он получает доступ ко всем данным и функциям, доступным этой скомпрометированной учётной записи.

Если ему удаётся взломать учётную запись с высокими привилегиями, например системного администратора, он может получить полный контроль над всем приложением и потенциально доступ к внутренней инфраструктуре.

Даже компрометация учётной записи с низкими привилегиями может предоставить злоумышленнику доступ к данным, к которым он не должен иметь доступ, например к коммерчески чувствительной информации. Даже если учётная запись не имеет доступа к конфиденциальным данным, она может позволить злоумышленнику попасть на дополнительные страницы, что расширяет поверхность атаки. Часто атаки высокой степени опасности невозможны с публично доступных страниц, но могут быть возможны с внутренних страниц.

## Уязвимости в механизмах аутентификации

Система аутентификации веб‑сайта обычно состоит из нескольких отдельных механизмов, в которых могут возникать уязвимости. Некоторые уязвимости применимы ко всем этим контекстам. Другие более специфичны для предоставляемой функциональности.