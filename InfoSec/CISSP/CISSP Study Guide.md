Как CISSP, вы должны понимать и следовать **Кодексу этики (ISC)²**, а также **внутреннему кодексу этики вашей организации**.

### 1.1.1 Кодекс профессиональной этики (ISC)²

Минимум — знать и понимать этические каноны:

#### Канон I
**Защищать общество, общее благо, необходимое общественное доверие и уверенность, а также инфраструктуру** — это означает «поступай правильно»; ставьте общее благо выше личных интересов — обеспечьте, чтобы общественность могла доверять вашей инфраструктуре и безопасности

#### Канон II
**Действовать благородно, честно, справедливо, ответственно и законно** — всегда соблюдайте законы — если вы работаете над проектом, где действуют противоречивые законы разных стран или юрисдикций, следует отдавать приоритет местной юрисдикции, из которой вы предоставляете услуги

#### Канон III
**Предоставлять добросовестные и компетентные услуги принципалам** — избегайте представления себя как эксперта или квалифицированного специалиста в областях, в которых вы не разбираетесь — поддерживайте и развивайте свои навыки, чтобы предоставлять компетентные услуги

#### Канон IV
**Продвигать и защищать профессию** — не создавайте негативную репутацию профессии — предоставляйте компетентные услуги, проходите обучение и действуйте благородно — думайте так: если вы соблюдаете первые три канона кодекса этики, вы автоматически соблюдаете и этот

### 1.1.2 Внутренний кодекс этики организации

Вы также должны поддерживать этику в своей организации; это можно интерпретировать как продвижение этики внутри организации, предоставление документации и обучения по этике или поиск способов улучшения существующей организационной этики. Некоторые организации могут иметь немного отличающиеся нормы этики, поэтому обязательно ознакомьтесь с этикой и руководящими принципами вашей организации.

## 1.2 — Понимание и применение концепций безопасности

### 1.2.1 Конфиденциальность, целостность, доступность, подлинность и неподверженность отказу (5 столпов информационной безопасности)

#### Конфиденциальность (Confidentiality):

- Принцип, согласно которому объекты не раскрываются неавторизованным субъектам
- Концепция мер, используемых для обеспечения защиты секретности данных, объектов и ресурсов
- Механизмы конфиденциальности предотвращают раскрытие, обеспечивая авторизованный доступ
- Сохранение авторизованных ограничений на доступ к информации и её раскрытие, включая средства защиты личной конфиденциальности и коммерческой тайны
- Конфиденциальные данные, включая персонально идентифицируемую информацию (PII), должны оставаться конфиденциальными
- Конфиденциальность отличается от секретности
- Сохранение конфиденциальности означает защиту актива или данных, даже если они не являются секретными

#### Целостность (Integrity):

- Принцип, согласно которому объекты сохраняют достоверность и намеренно изменяются только авторизованными субъектами
- Концепция защиты надёжности и корректности данных; защита от неправильного изменения/уничтожения информации; включает обеспечение неподдельности и подлинности
- Защита целостности предотвращает несанкционированные изменения данных
- Предотвращение несанкционированных изменений авторизованными субъектами, например, по ошибке
- Поддержание внутренней и внешней согласованности объектов

#### Доступность (Availability):

- Принцип, согласно которому авторизованные субъекты получают своевременный и непрерывный доступ к объектам
- Для обеспечения высокой доступности сервисов и данных применяются такие методы, как кластеризация с переключением при отказе, устойчивость площадок, автоматическое переключение, балансировка нагрузки, резервирование аппаратных и программных компонентов, устойчивость к сбоям

#### Подлинность (Authenticity):

- Обеспечение того, что передача, сообщение или отправитель являются легитимными

#### Неотказуемость (Nonrepudiation):

- Обеспечивает невозможность отрицания субъектом факта совершения действия или события
- Неподверженность отказу обеспечивается через идентификацию, аутентификацию, авторизацию, учёт и аудит

### Сервисы AAA:

- **Идентификация (Identification):** утверждение личности пользователя; попытка получить доступ к защищённой области или системе
- **Аутентификация (Authentication):** доказательство того, что вы — это заявленная личность, с помощью одного или нескольких факторов: знания, владения, характеристики (то, что вы знаете, имеете, кем являетесь)
- **Авторизация (Authorization):** определение необходимых ресурсов, разрешений (разрешить/отказать) к ресурсу и доступ к объекту для конкретной личности или субъекта
- **Аудит (Auditing):** ведение журнала событий и действий, связанных с системой и субъектами
- **Учётность (Accountability):** правильная идентификация, аутентификация и авторизация, которые регистрируются и отслеживаются; процесс контроля доступа, фиксирующий информацию о попытках всех субъектов получить доступ к ресурсам; анализ журналов для проверки соблюдения и нарушений с целью привлечения субъектов к ответственности, особенно за нарушения политики безопасности организации

## 1.3 Оценка, применение и поддержание принципов управления безопасностью

### **Управление безопасностью (Security governance)**

— **это совокупность политик, ролей, процессов и практик, используемых для принятия решений в области безопасности в организации**; связано с поддержкой, оценкой, определением и направлением усилий по обеспечению безопасности в организации; включает в себя обеспечение того, чтобы стратегии безопасности соответствовали бизнес-целям и были всеобъемлющими и последовательными по всей организации.

Управление безопасностью — это реализация решений в области безопасности и методов управления, которые тесно взаимосвязаны.

**Функция безопасности** — это аспект ведения бизнеса, сосредоточенный на задаче оценки и улучшения безопасности с течением времени.

Для управления безопасностью организация должна внедрить **надлежащее и достаточное** управление безопасностью.

Наиболее ясным и прямым примером управления функцией безопасности является проведение оценки рисков для формирования политики безопасности.

### **Управление третьими сторонами (Third-party governance)**

— это контроль со стороны внешних организаций, который может быть предписан законом, нормативными актами, отраслевыми стандартами, договорными обязательствами или требованиями лицензирования; часто вовлекаются внешние аудиторы или следователи.

### 1.3.1 — Соответствие функции безопасности стратегии, целям, миссии и задачам бизнеса:

- **Планирование управления безопасностью (Security Management Planning)**: Обеспечивает надлежащее создание, внедрение и соблюдение политики безопасности, а также её соответствие стратегии, целям, миссии и задачам организации. Управление безопасностью основано на трёх типах планов: стратегическом, тактическом и операционном.

- **Стратегический план (Strategic Plan):** Стратегический план — это долгосрочный план (примерно на 5 лет); он определяет цель безопасности организации. Стратегический план должен включать оценку рисков.

- **Тактический план (Tactical Plan):** Среднесрочный план (на 1 год или меньше), разработанный для более детального описания достижения целей, изложенных в стратегическом плане.

- **Операционный план (Operational Plan):** Краткосрочный, высоко детализированный план, основанный на стратегических или тактических планах.
	- **Миссия, стратегия, цели и задачи — поддерживают друг друга в иерархии:**
	- **Задачи (Objectives):** находятся ближе всего к «земле» и представляют собой небольшие усилия, помогающие достичь миссии
	- **Миссии (Missions):** представляют собой совокупность задач, и одна или несколько миссий ведут к целям
	- **Цели (Goals):** достижение целей означает реализацию стратегии

- Фреймворк безопасности должен быть тесно связан с миссией и задачами, позволяя бизнесу достигать своих целей и продвигать миссию, одновременно обеспечивая защиту среды в соответствии с допустимым уровнем риска.

---

### 1.3.2 — Организационные процессы

Организационные процессы в управлении безопасностью - Это **внутренние и внешние действия**, которые могут повлиять на безопасность компании. Управление безопасностью должно охватывать **все аспекты бизнеса**, включая:

- **Слияния**: когда компания покупает или объединяется с другой — важно понимать, **в каком состоянии находится ИТ-инфраструктура** другой стороны. Часто она неизвестна, и без тщательной проверки можно получить уязвимости. Поэтому важно проводить **due diligence** — проверку всех систем, данных и процессов.

- **Разделения**: когда компания отделяет часть бизнеса — нужно решить, **как разделить ИТ-системы**, **что делать с учётными записями**, **доступами и паролями**. Это может быть сложно и рискованно.

##### Комитеты по управлению (Governance Committees)

Это группы внутри организации, которые **оценивают и утверждают решения**, связанные с безопасностью, архитектурой, проектами и инцидентами.

- В них входят руководители, менеджеры и назначенные специалисты
- Они дают **свежий взгляд**, особенно если не связаны напрямую с ИБ
- Примеры: комитеты по управлению поставщиками, проектами, архитектурой

##### Оценка третьих сторон (Third-party Evaluation)

Если вы интегрируете внешнего партнёра или поставщика в свою систему безопасности, важно провести:

- **Оценку на месте** (on-site assessment) — физический аудит
- **Обмен и анализ документации** — проверка политик, сертификатов, соглашений
- **Анализ процессов и политик** — насколько они соответствуют вашим требованиям
- **Аудит третьей стороны** — независимая проверка их безопасности

>Управление безопасностью — это не только технологии, но и **процессы, люди и взаимодействие с внешними сторонами**. Чтобы система была надёжной, нужно учитывать риски при слияниях, разделениях, вовлекать комитеты и тщательно проверять партнёров.

---

### 1.3.3 Основные роли в системе безопасности

Эти роли — ключевые участники, которые обеспечивают защиту информации и соблюдение политики безопасности в организации. Каждая из них играет свою уникальную роль:

**Старший менеджер (Senior Manager)**

- Это **лицо, принимающее решения** на уровне всей организации.
- Он несёт **общую ответственность за безопасность**, но при этом должен **обеспечивать прибыльность и рост стоимости компании для акционеров**.
- Он **утверждает политику безопасности**, выделяет ресурсы и поддерживает инициативы по защите информации.

**Специалист по безопасности (Security Professional)**

- Это **технический эксперт**, который **разрабатывает, внедряет и поддерживает политику безопасности**.
- Он отвечает за **практическую реализацию защиты**, настройку систем, обучение сотрудников и реагирование на инциденты.

**Владелец актива (Asset Owner)**

- Это человек, который **владеет данными или ресурсами** (например, базой данных, системой, документами).
- Он определяет, **насколько важен актив**, и **как его нужно классифицировать** (например, конфиденциальный, публичный).
- Его задача — **указать уровень защиты**, который должен применяться.

**Специалист по внедрению (Custodian)**

- Это тот, кто **физически или технически реализует защиту**, определённую владельцем актива и политикой безопасности.
- Например, системный администратор, который **настраивает права доступа**, **шифрует данные** или **обновляет антивирус**.
- Он **не принимает решений**, а **выполняет инструкции**.

**Аудитор (Auditor)**

- Это **независимый проверяющий**, который **оценивает, насколько правильно реализована политика безопасности**.
- Он проводит **аудиты, анализ журналов, проверку соответствия стандартам**.
- Его задача — **обнаружить слабые места**, **дать рекомендации** и **подтвердить соблюдение требований**.

Почему это важно?

Понимание ролей помогает:
- Чётко распределить ответственность
- Избежать конфликтов и недопонимания
- Обеспечить надёжную защиту информации
- Подготовиться к аудиту и сертификации

---

### 1.3.4 **due diligence** и **due care** в контексте информационной безопасности

##### **Due Diligence** (должная осмотрительность)

Это **проактивный процесс планирования и подготовки**, направленный на защиту интересов организации. Проще говоря, это **«знать, что нужно сделать, и подготовиться к этому»**.

Примеры due diligence:

- Проведение оценки рисков
- Сбор информации о текущем состоянии безопасности
- Разработка политики безопасности, стандартов, процедур
- Документирование этих политик
- Распространение информации среди сотрудников

**Цель**: создать надёжную и формальную основу для защиты организации.

##### **Due Care** (должная забота)

Это **фактические действия**, которые вы предпринимаете, чтобы реализовать то, что было запланировано в рамках due diligence. Проще говоря, это **«делать правильные вещи на практике»**.

Примеры due care:

- Следовать политике безопасности
- Реализовывать меры контроля
- Обучать сотрудников
- Принимать разумные решения в рамках закона и политики компании

**Цель**: показать, что вы **ответственно защищаете активы** и соблюдаете правила.

##### Как они связаны?

- **Due diligence** — это **планирование и подготовка**
- **Due care** — это **реализация и соблюдение**

Можно сказать:

> _Due care — это ваша ответственность, а due diligence — это ваша доказательная база._

Пример из жизни:

Представь, что ты владелец магазина:
- **Due diligence** — ты устанавливаешь камеры, нанимаешь охрану, пишешь инструкции по безопасности
- **Due care** — ты следишь, чтобы камеры работали, охрана была на месте, а сотрудники соблюдали инструкции

---

## 1.5 Типы расследований и их особенности

В зависимости от инцидента, расследование может быть разных типов. Например:

- Взлом финансовой системы → **регуляторное расследование**
- Компрометация сайта → **уголовное расследование**

Каждый тип имеет свои цели, процедуры и уровень формальности:

##### Административное расследование (Administrative)

- **Внутреннее расследование**, проводимое организацией
- Обычно связано с **операционными проблемами** или **нарушениями внутренних политик**
- Часто связано с HR-сценариями или техническим анализом
- **Низкий уровень формальности**: минимальные требования к документации и процедурам
- Основная цель — **найти первопричину проблемы**

##### Уголовное расследование (Criminal)

- Проводится при наличии **преступления**
- Взаимодействие с **правоохранительными органами**
- Цель — **собрать доказательства**, которые можно использовать в суде
- Доказательства должны быть **собраны и обработаны по строгим правилам**, чтобы быть допустимыми в суде
- Требуется доказать вину **«вне разумного сомнения»** — это более высокий стандарт, чем в гражданском деле

##### Гражданское расследование (Civil)

- Возникает, когда **одна сторона подаёт иск против другой** (например, за нарушение товарного знака)
- Обычно связано с **финансовыми убытками**, а не с преступлением
- Требуется **«преобладание доказательств»** — более мягкий стандарт, чем в уголовном деле
- Требования к сбору доказательств **ниже**, чем в уголовных делах

##### Расследование по отраслевым стандартам (Industry Standards)

- Проверка соблюдения **отраслевых стандартов**, например **PCI DSS**
- Стандарты — это **не законы**, но могут быть частью **договорных обязательств**
- Организация может быть обязана пройти **аудит или оценку**
- Многие компании соблюдают стандарты **добровольно**, чтобы повысить безопасность и снизить риски

##### Регуляторное расследование (Regulatory)

- Проводится **регуляторным органом**, таким как SEC или FINRA
- Направлено против организации, подозреваемой в нарушении
- Организация **обязана сотрудничать**, например, **не скрывать и не уничтожать доказательства**

Вывод

Каждый тип расследования требует:
- Разного уровня формальности
- Разных стандартов доказательств
- Разных участников (внутренние команды, юристы, аудиторы, госорганы)

Понимание этих различий помогает правильно реагировать на инциденты и соблюдать юридические и профессиональные нормы.

- **Если инцидент внутренний** (например, сотрудник нарушил правила) → административное расследование
- **Если есть признаки преступления** → уголовное расследование
- **Если спор между компаниями** → гражданское
- **Если проверка на соответствие стандарту** → отраслевое
- **Если проверка от госоргана** → регуляторное

---

### 1.6 Разработка, документирование и внедрение политики безопасности, стандартов, процедур и рекомендаций

1. **Политика безопасности (Security Policy)**
	Это **основа всей системы безопасности**. Создаётся **высшим руководством** и описывает:
	- стратегические цели безопасности,
	- какие активы нужно защищать,
	- насколько глубоко должны внедряться меры защиты.
	Пример: политика может сказать, что все данные клиентов должны быть защищены, но **не объясняет, как именно** — это делают другие документы.
2. **Политика допустимого использования (Acceptable Use Policy, AUP)**
	Это часть общей политики, которая:
	- определяет, **что разрешено и запрещено** сотрудникам (например, нельзя использовать рабочий ноутбук для личных целей),
	- описывает последствия нарушений (например, дисциплинарные меры или увольнение).
3. **Стандарты (Standards)**
	Это **обязательные требования**, которые:
	- конкретизируют, **что именно должно быть сделано**,
	- обеспечивают **однородность**: все используют одинаковое оборудование, ПО, настройки.
	Пример: стандарт может требовать, чтобы все пароли были не менее 12 символов и обновлялись каждые 90 дней.
4. **Базовые уровни (Baselines)**
	Это **минимальный уровень безопасности**, который должен быть реализован **на всех системах**.
	Пример: базовый уровень для серверов может включать:
	- отключение ненужных служб,
	- установка антивируса,
	- настройка журналирования.
	Часто реализуется через **GPO** (групповая политика в Windows) или системы управления конфигурацией.
5. **Рекомендации (Guidelines)**
	Это **гибкие советы**, которые:
	- помогают понять, **как лучше внедрить стандарты и базовые уровни**,
	- **не обязательны**, но **желательны**.
	Пример: рекомендация может советовать использовать двухфакторную аутентификацию, но не указывать конкретный сервис.
6. **Процедуры (Procedures / SOP)**
	Это **пошаговые инструкции**, которые:
	- описывают **точные действия** для реализации конкретной меры безопасности.
	Пример: процедура может объяснять, как настроить межсетевой экран или как реагировать на инцидент.

##### Как всё это связано?

- **Политика** говорит, что нужно защищать
- **Стандарты** говорят, что должно быть реализовано
- **Базовые уровни** устанавливают минимальные требования
- **Рекомендации** подсказывают, как лучше действовать
- **Процедуры** объясняют, как это сделать на практике

### 1.7 — Идентификация, анализ, оценка, приоритизация и реализация требований по обеспечению непрерывности бизнеса (BCP)

Business Continuity Planning **BCP** — это процесс, который помогает организации **продолжать работу во время и после чрезвычайной ситуации**. Он включает в себя:

- Оценку рисков
- Разработку политики и процедур
- Подготовку к восстановлению критических функций

Цель — обеспечить **быстрый, спокойный и эффективный ответ** на инцидент и **минимизировать ущерб**.

**Основные этапы BCP**:

1. **Проектирование и планирование (Project Scope and Planning):**
    - Получение поддержки руководства
    - Обоснование проекта (анализ затрат/выгоды, соответствие требованиям)
    - Формирование команды (представители бизнеса и ИТ)
    - Создание политики непрерывности бизнеса
2. **Анализ воздействия на бизнес (Business Impact Analysis, BIA):**
    - Определение критичных систем и сервисов
    - Оценка последствий сбоев (например, на продажи или бухгалтерию)
    - Этапы:
        - Приоритизация
        - Идентификация рисков
        - Оценка вероятности
        - Приоритизация ресурсов
	В рамках BIA определяются:
	    - **RTO (Recovery Time Objective):** сколько времени можно потратить на восстановление
	    - **RPO (Recovery Point Objective):** сколько данных можно потерять (в часах/минутах)
	    - **MTD/MAD (Maximum Tolerable Downtime):** сколько времени организация может быть недоступна, прежде чем это станет критичным
3. **Планирование непрерывности (Continuity Planning):**
    - Разработка стратегии: какие риски будут снижаться
    - Механизмы и процедуры: как именно будут снижаться риски
    - Итог — **COOP (Continuity of Operations Plan)**: как выполнять критические функции в течение месяца после сбоя
4. **Утверждение и внедрение (Approval and Implementation):**
    - Поддержка руководства
    - График внедрения
    - Обучение всех участников

### 1.8 Обеспечения безопасности персонала и связанных процедур

Общие положения
- Люди — самый уязвимый элемент в системе безопасности.
- Атаки на персонал: фишинг, социальная инженерия, спуфинг.
- Компрометация одного аккаунта может привести к захвату всей сети.
- Обученные и мотивированные сотрудники — важный актив безопасности.

Люди часто считаются самым слабым элементом в любой системе безопасности; независимо от того, какие физические или логические средства контроля внедрены, человек может найти способ обойти, обмануть или отключить их.

Злоумышленники регулярно нацеливаются на пользователей с помощью фишинга, целевого фишинга (spear phishing), социальной инженерии и других видов атак — и каждый может стать целью.

После того как злоумышленники компрометируют учётную запись, они могут использовать эту точку входа для перемещения по сети и повышения своих привилегий.

Люди также могут стать ключевым активом безопасности, если они должным образом обучены и мотивированы защищать не только себя, но и безопасность организации.

Часть планирования безопасности включает наличие стандартов для описания должностей, классификации должностей, рабочих задач, обязанностей, предотвращения сговора, проверки кандидатов, проверки биографии, получения допуска к секретной информации, трудовых и соглашений о неразглашении.

##### Проверка кандидатов и найм

Следующие стратегии могут снизить ваш риск:

**Проверка кандидатов и найм**:

- тщательная проверка кандидатов на трудоустройство — ключевая часть процесса найма
- обязательно проведите полную проверку биографии, включая проверку судимости, подтверждение трудовой истории, образования, сертификатов и других достижений, если возможно
- необходимо связаться со всеми рекомендателями

##### Трудовые соглашения и требования, основанные на политике

**Трудовое соглашение**: определяет должностные обязанности, ожидания, уровень оплаты, льготы и информацию об увольнении; иногда такие соглашения заключаются на определённый срок (например, контракт или временная работа)

Трудовые соглашения облегчают увольнение при необходимости, например, при неудовлетворительной работе сотрудника.

Чем больше информации и деталей в трудовом соглашении, тем меньше риск (например, риск судебного иска о неправомерном увольнении) для компании в процессе увольнения.

Например, уволенный сотрудник может взять с собой копию своей электронной почты, не считая это кражей, но он с меньшей вероятностью поступит так, если трудовое соглашение или другой документ политики явно это запрещает.

**Примеры трудовых соглашений**:

- соглашение о неконкуренции
- кодекс поведения, такой как политика допустимого использования (AUP), которая определяет, какие действия, практики или использование оборудования и ресурсов компании допустимы, а какие — нет
- соглашение о неразглашении (NDA) — документ, используемый для защиты конфиденциальной информации от разглашения текущим или бывшим сотрудником

**Соблюдение (compliance)**: акт подтверждения или соблюдения правил, политик, нормативов, стандартов или требований

На уровне персонала соблюдение связано с тем, что отдельные сотрудники следуют корпоративным политикам и процедурам

Сотрудники должны быть обучены корпоративным стандартам, определённым в политике безопасности, и соблюдать любые договорные обязательства (например, PCI DSS)

Соблюдение является формой административного или управленческого контроля безопасности

**Контроль соблюдения**: применение санкций или последствий за несоблюдение политики, обучения, лучших практик или нормативов

Персональные идентифицируемые данные (PII) о сотрудниках, партнёрах, подрядчиках, клиентах и других лицах должны храниться безопасным образом, доступным только тем, кому они необходимы для выполнения работы

Организации должны иметь документированную политику конфиденциальности, в которой указаны типы данных, охватываемых политикой, и лица, к которым она применяется

Сотрудники и подрядчики должны быть обязаны прочитать и согласиться с политикой конфиденциальности при приёме на работу и регулярно после этого (например, ежегодно)

##### Процессы приёма, перевода и увольнения

**Приём (onboarding)**: процесс ввода нового сотрудника в организацию
- создание документированных процессов, позволяющих быстро и последовательно интегрировать нового сотрудника

**Перевод**: сотрудник переходит с одной должности на другую, что, вероятно, требует корректировки доступа к учётным записям для соблюдения принципа минимальных привилегий

**Увольнение (offboarding)**: удаление идентификации сотрудника из системы управления доступом (IAM) после его ухода из организации; может также применяться при переводе сотрудника на новую должность

- независимо от того, было ли увольнение мирным или резким, бывший сотрудник должен быть выведен с территории и не должен иметь возможности вернуться

##### Соглашения и контроль для поставщиков, консультантов и подрядчиков

Организации часто передают на аутсорсинг множество ИТ-функций, особенно хостинг дата-центров, поддержку контакт-центров и разработку приложений

Политики и процедуры информационной безопасности должны охватывать безопасность аутсорсинга и использование поставщиков услуг, подрядчиков и консультантов

Примеры аспектов безопасности при аутсорсинге:
- контроль доступа
- обмен и проверка документов
- техническое обслуживание
- оценка на месте
- обзор процессов и политик
- соглашения об уровне обслуживания (SLA)

## 1.9 Понимание и применение концепций управления рисками

### 1.9.1 Идентификация угроз и уязвимостей

**Управление рисками**: процесс выявления факторов, которые могут повредить или раскрыть данные, оценки этих факторов с учётом ценности данных и стоимости контрмер, а также внедрение экономически эффективных решений для смягчения или снижения риска.

**Угроза**: любое потенциальное событие, которое может вызвать нежелательный или нежелательный результат для конкретного актива; может быть преднамеренной или случайной; условно можно считать угрозу оружием, которое может нанести вред цели.

**Уязвимость**: слабое место в активе или слабость (или отсутствие) средства защиты или контрмеры; дефект, ограничение, ошибка, хрупкость или восприимчивость к вреду.

Угрозы и уязвимости связаны: угроза возможна, когда присутствует уязвимость.

Угрозы используют уязвимости, что приводит к подверженности.

Подверженность — это риск, а риск смягчается с помощью средств защиты.

Средства защиты защищают активы, находящиеся под угрозой.

**Агент/актор угрозы**: преднамеренно использует уязвимости.

**Событие угрозы**: случайные происшествия и преднамеренные использования уязвимостей.

**Вектор угрозы** (также известен как вектор атаки): путь или способ, с помощью которого атака или атакующий может получить доступ к цели, чтобы нанести вред.

**Подверженность**: быть восприимчивым к потере актива из-за угрозы; потенциальная возможность нанесения вреда.

**Фактор подверженности (EF)**: вытекает из этого понятия; элемент количественного анализа риска, который представляет собой процент потерь, которые организация понесёт, если конкретный актив будет нарушен в результате реализованного риска.

**Ожидаемые потери от одного случая (SLE)**: элемент количественного анализа риска, представляющий собой стоимость, связанную с одним реализованным риском для конкретного актива;

Формула: `SLE = стоимость актива (AV) × фактор подверженности (EF)`

Где `EF` — это показатель, представляющий потери, которые реализованная угроза нанесёт конкретному активу, выраженный в процентах: например,` EF = 0.2` (или 20%) для конкретной угрозы означает, что её реализация приведёт к потере 20% стоимости актива.

Обратите внимание, что `EF` — это не фиксированное число для актива, а уникальное значение, определяемое конкретной угрозой, воздействующей на конкретный актив.

**Годовая частота возникновения (ARO)**: элемент количественного анализа риска, представляющий ожидаемую частоту, с которой конкретная угроза или риск будет возникать в течение одного года.

**Годовая ожидаемая потеря (ALE)**: элемент количественного анализа риска, представляющий возможную годовую стоимость всех случаев конкретной реализованной угрозы для конкретного актива.

Формула: `ALE = SLE × ARO`

**Оценка средства защиты**: ALE для актива при внедрении средства защиты:

Формула: `ALE до защиты − ALE после защиты − годовая стоимость средства защиты`

или `(ALE1 − ALE2) − ACS`

**Риск**: возможность или вероятность того, что угроза использует уязвимость для нанесения вреда активу, и степень ущерба, который может возникнуть; чем больше потенциальный вред — тем выше риск.

### 1.9.2 Анализ, оценка и масштаб риска

**Оценка риска**: используется для выявления рисков и установления приоритетов критичности, а затем реакция на риск используется для определения наилучшей защиты для каждого выявленного риска.

Риск — это угроза при наличии уязвимости.

Формула: `Риск = угроза × уязвимость` (или вероятность вреда × серьёзность вреда)

Устранение угрозы, агента угрозы или уязвимости напрямую приводит к снижению риска (называется смягчением угрозы).

Все ИТ-системы имеют риски; все организации имеют риски; невозможно устранить 100% всех рисков.

Вместо этого высшее руководство должно решить, какие риски являются приемлемыми, а какие — нет.

Существуют две основные методологии оценки риска:
- **Количественный анализ риска**: присваивает реальные денежные значения потере актива и основан на математических расчётах.
- **Качественный анализ риска**: присваивает субъективные и нематериальные значения потере актива и учитывает перспективы, чувства, интуицию, предпочтения, идеи и инстинктивные реакции; качественный анализ риска больше основан на сценариях, чем на расчётах, и угрозы ранжируются для оценки рисков, затрат и последствий.

Большинство организаций используют гибрид обеих методологий оценки риска.

Цель оценки риска — выявить риски (на основе пар актив–угроза) и ранжировать их по степени критичности.

### 1.9.3 Реакция на риск и методы обработки (например, страхование в области кибербезопасности)

**Реакция на риск**: формулирование плана для каждого выявленного риска; для конкретного риска у вас есть выбор возможной реакции:

- **Снижение риска (Risk Mitigation)**: снижение риска или его смягчение — это внедрение средств защиты, средств контроля безопасности и контрмер для уменьшения и/или устранения уязвимостей или блокирования угроз.
- **Назначение риска (Risk Assignment)**: назначение или передача риска — это возложение ответственности за потери, вызванные риском, на другое лицо или организацию; также известно как передача риска.
- **Сдерживание риска (Risk Deterrence)**: сдерживание — это процесс внедрения средств устрашения для потенциальных нарушителей безопасности и политики. Цель — убедить агента угрозы не атаковать. Например: внедрение аудита, камер видеонаблюдения, предупреждающих баннеров; использование охраны.
- **Избежание риска (Risk Avoidance)**: определение того, что воздействие или вероятность конкретного риска слишком велики, чтобы быть компенсированы потенциальной выгодой, и отказ от выполнения определённой бизнес-функции на основании этого вывода; процесс выбора альтернативных вариантов или действий, которые связаны с меньшим риском, чем стандартный, распространённый, удобный или дешёвый вариант.
- **Принятие риска (Risk Acceptance)**: результат анализа затрат/выгоды, определяющий, что стоимость контрмер превышает возможные потери от риска; также означает, что руководство согласилось принять последствия/потери, если риск реализуется.
- **Отказ от риска (Risk Rejection)**: неприемлемая возможная реакция — это отказ от риска или игнорирование риска; отрицание существования риска и надежда на то, что он никогда не реализуется — это не обоснованные действия, соответствующие должной осмотрительности.
- **Передача риска (Risk Transference)**: оплата внешней стороне (например, страховой компании) за принятие финансовых последствий конкретного риска.

### Дополнительные определения

- **Присущий риск (Inherent Risk)**: уровень естественного, исходного или стандартного риска, существующего в среде, системе или продукте до проведения каких-либо мероприятий по управлению рисками (также известен как начальный риск); это риск, выявленный в процессе оценки риска.
- **Остаточный риск (Residual Risk)**: состоит из угроз для конкретных активов, против которых руководство решило не внедрять меры защиты (риск, который руководство решило принять, а не смягчать); риск, остающийся после внедрения средств защиты.
- **Общий риск (Total Risk)**: объём риска, с которым организация столкнется, если не будут внедрены никакие средства защиты. Формула концептуального общего риска: `угрозы × уязвимости × стоимость актива = общий риск`
- **Разрыв в контроле (Controls Gap)**: объём риска, который снижается за счёт внедрения средств защиты, или разница между общим риском и остаточным риском. Формула концептуального остаточного риска: `общий риск − разрыв в контроле = остаточный риск`

##### Примечания
- Риск должен переоцениваться периодически для поддержания разумного уровня безопасности, поскольку безопасность со временем изменяется.
- **Контрмера** (также известная как "контроль" или "средство защиты") может помочь снизить риск.
- Для подготовки к экзамену важно понимать, как эти концепции интегрируются в вашу среду; это не пошаговая техническая настройка, а процесс внедрения — с чего начать, в каком порядке происходит и как завершить.
- Имейте в виду, что безопасность должна быть разработана для поддержки и обеспечения бизнес-задач и функций.
- Средства контроля, контрмеры и средства защиты могут быть реализованы:
    - административно, 
    - логически / технически,
    - физически.
- Эти 3 категории должны быть реализованы концептуально в виде **многоуровневой защиты (defense-in-depth)** для достижения максимального эффекта:
    - политики (часть административного контроля) управляют всеми аспектами безопасности и, таким образом, формируют начальный защитный слой вокруг активов;
    - затем логические и технические средства защиты обеспечивают защиту от логических атак и эксплойтов;
    - затем физические средства защиты обеспечивают защиту от реальных физических атак на объекты и устройства.

### 1.9.4 Применимые типы средств контроля (например, превентивные, обнаруживающие, корректирующие)

Три способа реализации компенсирующих (смягчающих) средств контроля:
- **Административные**: политики и процедуры, определённые политикой безопасности организации и другими нормативными актами или требованиями.
- **Технические / Логические**: примеры включают межсетевые экраны (firewalls), автоматическое резервное копирование, шифрование.
- **Физические**: механизмы безопасности, направленные на обеспечение защиты объекта и реальных физических предметов.

Средства защиты:
- **Превентивные**: превентивное средство контроля внедряется для предотвращения или остановки нежелательной или несанкционированной активности.
- **Сдерживающие**: сдерживающее средство контроля внедряется для предотвращения нарушений политики безопасности; сдерживающие и превентивные средства контроля похожи, но сдерживающие средства часто зависят от того, что индивид будет убеждён не предпринимать нежелательные действия.
- **Директивные**: директивное средство контроля внедряется для направления, ограничения или управления действиями субъектов с целью принуждения или поощрения соблюдения политик безопасности.

Контрмеры:

- **Обнаруживающие**: обнаруживающее средство контроля внедряется для выявления или обнаружения нежелательной или несанкционированной активности; такие средства работают после факта.
- **Корректирующие**: корректирующее средство контроля изменяет среду для возвращения систем к нормальному состоянию после того, как произошла нежелательная или несанкционированная активность; оно пытается устранить любые проблемы, возникшие в результате инцидента безопасности.
- **Восстановительные**: расширение корректирующих средств контроля, но с более продвинутыми или сложными возможностями; восстановительное средство контроля пытается восстановить или вернуть ресурсы, функции и возможности после нарушения политики безопасности. Восстановительные средства контроля, как правило, решают более серьёзные разрушительные события по сравнению с корректирующими средствами, особенно когда могли произойти нарушения безопасности.
- **Компенсирующие**: компенсирующее средство контроля внедряется для предоставления различных вариантов другим существующим средствам контроля, для содействия соблюдению и поддержке политик безопасности. Они могут быть любыми средствами контроля, используемыми в дополнение к другому средству или вместо него. Они могут быть способом повышения эффективности основного средства контроля или альтернативой/резервным вариантом в случае отказа основного средства контроля.

### 1.9.5 Оценка средств контроля (например, безопасность и конфиденциальность)

**Оценка средств контроля безопасности (SCA)**: формальная оценка и анализ отдельных средств контроля по сравнению с эталоном.

Цель SCA — обеспечить эффективность механизмов безопасности; периодически оценивайте средства контроля безопасности и конфиденциальности, чтобы определить, что работает, а что нет.

В рамках этой оценки существующие документы должны быть тщательно изучены, а некоторые средства контроля протестированы случайным образом.

Обычно составляется отчёт, отражающий результаты и позволяющий организации устранить недостатки.

Часто оценки средств контроля безопасности и конфиденциальности выполняются и/или подтверждаются разными командами, при этом команда по конфиденциальности отвечает за соответствующие аспекты.

Для федеральных агентств процесс SCA, как правило, основан на SP 800-53.

### 1.9.6 Непрерывный мониторинг и измерение

Мониторинг и измерение тесно связаны с выявлением рисков.

Хотя мониторинг используется не только для целей безопасности, он должен быть настроен таким образом, чтобы организация получала уведомления о потенциальных инцидентах безопасности как можно раньше.

Если происходит нарушение безопасности, отслеживаемые системы и данные становятся ценными с точки зрения криминалистики: от возможности определить первопричину инцидента до внесения корректировок, минимизирующих вероятность повторения.

### 1.9.7 Отчётность (например, внутренняя, внешняя)

Отчётность по рискам — ключевая задача, выполняемая по завершении анализа рисков (то есть составление и представление итогового отчёта).

**Реестр рисков** или **журнал рисков** — это документ, в котором перечислены все выявленные риски для организации, системы или отдельного проекта.

Реестр рисков используется для регистрации и отслеживания деятельности по управлению рисками, включая:
- выявление рисков
- оценку степени серьёзности и приоритизацию этих рисков
- назначение ответных мер для снижения или устранения рисков
- отслеживание прогресса в смягчении рисков

### 1.9.8 Непрерывное улучшение (например, моделирование зрелости управления рисками)

Анализ рисков проводится для предоставления высшему руководству информации, необходимой для принятия решений о том, какие риски следует смягчить, какие — передать, какие — сдерживать, какие — избегать, а какие — принять.

Для полной оценки рисков и последующего принятия надлежащих мер предосторожности необходимо проанализировать следующее:
- активы
- оценку стоимости активов
- угрозы
- уязвимости
- подверженность
- риск
- реализованный риск
- средства защиты
- контрмеры
- атаки
- нарушения

Программа управления корпоративными рисками (ERM) может быть оценена с использованием **модели зрелости управления рисками (RMM)**.

**Модель зрелости управления рисками (RMM)**: оценивает ключевые показатели и действия зрелого, устойчивого и воспроизводимого процесса управления рисками, обычно соотносит оценку зрелости риска с пятиуровневой моделью:
1. **Ad hoc**: хаотичная начальная точка, с которой все организации начинают управление рисками
2. **Preliminary**: предпринимаются неструктурированные попытки следовать процессам управления рисками, но каждое подразделение может выполнять оценку рисков по-своему
3. **Defined**: общая или стандартизированная структура управления рисками принята на уровне всей организации
4. **Integrated**: операции по управлению рисками интегрированы в бизнес-процессы, используются метрики для сбора данных об эффективности, а риск рассматривается как элемент принятия бизнес-решений
5. **Optimized**: управление рисками сосредоточено на достижении целей, а не просто на реагировании на внешние угрозы; стратегическое планирование направлено на успех бизнеса, а не только на предотвращение инцидентов; полученные уроки повторно интегрируются в процесс управления рисками

## 1.10 Понимание и применение концепций и методологий моделирования угроз

#### Моделирование угроз

**Моделирование угроз** — это процесс обеспечения безопасности, при котором потенциальные угрозы идентифицируются, классифицируются и анализируются; может выполняться как проактивная мера на этапе проектирования и разработки (также известный как оборонительный подход), либо как реактивная мера после развертывания продукта (также известный как атакующий подход).

Моделирование угроз определяет потенциальный вред, вероятность возникновения, приоритет проблемы и способы устранения или снижения угрозы.

#### MITRE ATT&CK

**MITRE ATT&CK (Атакующая тактика, техники и общие знания)** — это всеобъемлющая структура с глобально доступной базой знаний, документирующей реальные тактики, техники и процедуры (TTP), используемые киберпротивниками; широко используется организациями для улучшения обнаружения угроз, реагирования на инциденты и защиты от киберугроз; ATT&CK используется как модель по умолчанию во многих программных продуктах.

#### Microsoft SDL

Microsoft использует **Security Development Lifecycle (SDL)** с девизом: **«Безопасно по дизайну, безопасно по умолчанию, безопасно при развертывании и коммуникации»**

Цели SDL:
- Сократить количество дефектов, связанных с безопасностью, в дизайне и коде
- Снизить серьёзность оставшихся дефектов

Оборонительный подход к моделированию угроз применяется на ранних этапах разработки; метод основан на прогнозировании угроз и внедрении конкретных средств защиты в процессе написания кода и создания продукта.

Решения по безопасности на этом этапе более экономичны, чем позже; эту концепцию следует рассматривать как проактивный подход к управлению угрозами.

#### Модель STRIDE от Microsoft

**STRIDE** — это модель категоризации угроз, важная часть моделирования угроз приложений:

- **Spoofing (Подмена)**: атака с целью получения доступа к целевой системе с использованием поддельной личности
- **Tampering (Подделка)**: любые действия, приводящие к несанкционированным изменениям или манипуляциям с данными, как в передаче, так и в хранении
- **Repudiation (Отказ от действий)**: возможность пользователя или атакующего отрицать выполнение действия, сохраняя правдоподобное отрицание
- **Information Disclosure (Разглашение информации)**: раскрытие или распространение частной, конфиденциальной или контролируемой информации внешним или несанкционированным лицам
- **Denial of Service (Отказ в обслуживании)**: атака, пытающаяся предотвратить авторизованное использование ресурса; может осуществляться через эксплуатацию уязвимостей, перегрузку соединений или затопление трафиком; например, SYN flood — это DoS-атака, нарушающая трёхстороннее рукопожатие TCP
- **Elevation of Privilege (Повышение привилегий)**: атака, при которой ограниченная учётная запись превращается в учётную запись с большими привилегиями, полномочиями и доступом

#### Методология PASTA

**Process for Attack Simulation and Threat Analysis (PASTA)** — семиступенчатая методология моделирования угроз:

1. Определение целей (DO) для анализа риска
2. Определение технической области (DTS)
3. Декомпозиция и анализ приложения (ADA)
4. Анализ угроз (TA)
5. Анализ слабых мест и уязвимостей (WVA)
6. Моделирование и симуляция атак (AMS)
7. Анализ и управление рисками (RAM)

Каждый этап PASTA имеет конкретный список целей и результатов, которые необходимо достичь для завершения этапа.

#### Концепция VAST

**Visual, Agile, and Simple Threat (VAST)** — концепция моделирования угроз, интегрирующая управление угрозами и рисками в среду Agile-программирования на масштабируемой основе.

##### Методы идентификации угроз

Задача команды безопасности — идентифицировать угрозы, используя различные методы:

- **Фокус на атакующих**: полезен в конкретных ситуациях Например, если разработчик был уволен, и после анализа его компьютера выяснилось, что он был недовольным и злым — понимание этой ситуации как потенциальной угрозы позволяет предпринять шаги по её смягчению.
- **Фокус на активах**: наиболее ценные активы организации, скорее всего, будут целью атакующих
- **Фокус на программном обеспечении**: организации, разрабатывающие приложения внутри компании, могут рассматриваться как часть ландшафта угроз; цель — не выявить каждую возможную атаку, а сосредоточиться на общей картине, выявляя риски и векторы атак

Понимание угроз для организации позволяет документировать потенциальные векторы атак; можно использовать диаграммы для перечисления различных технологий, находящихся под угрозой.

##### Анализ сокращения

**Reduction analysis** — с целью лучшего понимания логики продукта и взаимодействия с внешними элементами включает разбиение системы на пять основных элементов:

- границы доверия
- пути потока данных
- точки ввода
- привилегированные операции
- детали средств контроля безопасности

Также известен как декомпозиция приложения, системы или среды.

#### Модель DREAD

Microsoft разработала подход **DREAD** для моделирования угроз, чтобы выявлять и приоритизировать угрозы, позволяя сначала устранять наиболее серьёзные:

- **D**: Потенциальный ущерб (Damage potential)
- **R**: Воспроизводимость (Reproducibility)
- **E**: Возможность эксплуатации (Exploitability)
- **A**: Затронутые пользователи (Affected users)
- **D**: Обнаруживаемость (Discoverability)

Обратите внимание: **STRIDE** используется для идентификации угроз, а **DREAD** — для их приоритизации.

#### Методология Trike

**Trike** — методология моделирования угроз с открытым исходным кодом, основанная на рисках; предоставляет способ проведения надёжного и воспроизводимого аудита безопасности, а также структуру для совместной работы и коммуникации.

## Стандарты потоков разведданных об угрозах

- **CAPEC (Common Attack Pattern Enumeration and Classification)**: словарь известных шаблонов атак
- **STIX (Structured Threat Information eXpression language)**: используется для описания угроз в стандартизированной форме
- **TAXII (Trusted Automated eXchange of Indicator Information)**: определяет, как информация об угрозах может быть передана и обменена

#### Моделирование угроз — концепции, модели и примеры

|Категория|Метод / Модель|Описание|Пример использования|
|---|---|---|---|
|**Подходы**|**Defensive**|Проактивный: на этапе проектирования и разработки|Внедрение защиты от SQL-инъекций при создании веб-приложения|
||**Adversarial**|Реактивный: после развертывания, анализ поведения атакующих|Анализ логов после инцидента для выявления вектора атаки|
|**Модели**|**STRIDE**|Категоризация угроз: Spoofing, Tampering, Repudiation, Info Disclosure, DoS, Elevation of Privilege|Используется при проектировании API для выявления угроз: подделка токенов, утечка данных|
||**DREAD**|Приоритизация угроз: Damage, Reproducibility, Exploitability, Affected users, Discoverability|Оценка угроз в облачном хранилище: DoS имеет высокий ущерб и воспроизводимость|
||**PASTA**|7 этапов: цели, область, анализ приложения, угрозы, уязвимости, моделирование атак, управление рисками|Применяется в банке для оценки рисков мобильного приложения с учётом бизнес-целей|
||**VAST**|Интеграция моделирования угроз в Agile-среду|Используется в DevOps-команде для оценки угроз при каждом релизе спринта|
||**Trike**|Методология с открытым исходным кодом, ориентирована на аудит и совместную работу|Применяется в малом бизнесе для совместной оценки рисков между IT и юристами|
|**Анализ**|**Reduction Analysis**|Декомпозиция системы: доверие, потоки, ввод, привилегии, защита|Используется при анализе IoT-устройства: выявление точек ввода и границ доверия|
|**Фреймворки**|**MITRE ATT&CK**|База знаний по реальным TTP киберпреступников|Используется SOC-аналитиками для корреляции событий SIEM с известными техниками атак|
|**Стандарты разведданных**|**CAPEC**|Словарь известных шаблонов атак|Используется при обучении сотрудников безопасности для распознавания типовых атак|
||**STIX**|Стандартизированное описание угроз|Применяется для обмена данными об угрозах между организациями|
||**TAXII**|Протокол обмена информацией об угрозах|Используется для автоматической передачи индикаторов компрометации между партнёрами|
|**Фокусные методы**|**На атакующих**|Анализ поведения конкретных лиц|Уволенный разработчик — потенциальная угроза, проводится аудит его активности|
||**На активах**|Определение ценных целей для защиты|Защита базы данных с персональными данными клиентов|
||**На ПО**|Анализ уязвимостей в собственных приложениях|Оценка угроз в CRM-системе, разработанной внутри компании|
### 1.12 — Установление и поддержание программы повышения осведомлённости, обучения и подготовки в области безопасности

#### 1.12.1 Методы и техники повышения осведомлённости и обучения

Прежде чем начнётся фактическое обучение, необходимо провести ознакомление пользователей с вопросами безопасности; после этого можно начинать обучение, то есть обучение сотрудников выполнению их рабочих задач и соблюдению политики безопасности.

Все новые сотрудники требуют определённого уровня обучения, чтобы они могли соблюдать все стандарты, руководства и процедуры, предписанные политикой безопасности.

Образование — это более детальное мероприятие, в рамках которого студенты/пользователи изучают гораздо больше, чем им действительно нужно знать для выполнения рабочих задач.

Образование чаще всего связано с пользователями, стремящимися получить сертификат или повышение по службе.

Сотрудники должны понимать, на что следует обращать внимание (например, типы угроз, такие как фишинг и бесплатные USB-накопители), как безопасно выполнять свою работу (например, шифровать конфиденциальные данные, физически защищать ценные активы) и как безопасность влияет на общую картину (репутация компании, прибыль и убытки).

Обучение должно быть обязательным и предоставляться как новым сотрудникам, так и ежегодно (как минимум) для текущего обучения.

Следует регулярно проводить тесты операционной безопасности (такие как фишинговые кампании, проход за другими сотрудниками через двери компании и тесты социальной инженерии).

**Социальная инженерия**: форма атаки, использующая человеческую природу и поведение; распространённые принципы социальной инженерии — авторитет, запугивание, согласие, дефицит, знакомство, доверие и срочность.

- **Знакомство**: как принцип социальной инженерии — попытка использовать врождённое доверие человека к знакомым вещам; может включать утверждение о знакомстве с коллегой (реальным или вымышленным) и направлено на то, чтобы привести цель в состояние, способствующее предоставлению информации.

Атаки социальной инженерии включают фишинг, целевой фишинг (spear phishing), компрометацию деловой электронной почты (BEC), охоту на крупных жертв (whaling), смс-фишинг (smishing), голосовой фишинг (vishing), спам, подсматривание через плечо (shoulder surfing), мошенничество с накладными, обманы, выдавание себя за другого, маскировку, проход за другим (tailgating), совместный проход (piggybacking), поиск в мусоре (dumpster diving), мошенничество с личностью, типографические подделки (typo squatting) и кампании влияния.

Хотя многие организации не проводят кампании социальной инженерии (тестирование сотрудников с помощью безвредных попыток социальной инженерии) как часть повышения осведомлённости, это направление, вероятно, будет развиваться; вне кампаний представление сценариев социальной инженерии и информации — распространённый способ обучения.

**Фишинг**: фишинговые кампании популярны, и многие организации используют сторонние сервисы для регулярного тестирования своих сотрудников с помощью поддельных фишинговых писем.

Такие кампании дают ценные данные, такие как процент сотрудников, открывших фишинговое письмо, процент открывших вложения или перешедших по ссылкам, и процент сотрудников, сообщивших о поддельном фишинговом письме как о вредоносном.

**Чемпионы безопасности**: термин «чемпион» набирает популярность; организации часто используют его для обозначения человека в команде, который является экспертом в определённой области или отвечает за конкретную сферу.

- Например, кто-то в команде может быть чемпионом по мониторингу — он обладает глубокими знаниями в области мониторинга и продвигает его преимущества в команде или других командах.

Чемпион безопасности — это человек, отвечающий за продвижение безопасности, помощь в выявлении областей, требующих внимания, и содействие повышению квалификации команды.

**Геймификация**: традиционное обучение и образование обычно основаны на чтении и последующем ответе на вопросы с несколькими вариантами ответа для подтверждения знаний; геймификация направлена на то, чтобы сделать обучение и образование более увлекательными и интересными, упаковывая учебный материал в игру.

Геймификация позволила организациям получить больше пользы от типичного обучения сотрудников.

Чемпион безопасности — член команды, который действует как связующее звено между своей командой и командой безопасности, продвигает безопасные практики разработки и помогает интегрировать безопасность в повседневные рабочие процессы.

#### 1.12.2 Периодический пересмотр содержания с учётом новых технологий и тенденций (например, криптовалюты, искусственный интеллект (ИИ), блокчейн)

Текущее обучение (или обучение людей выполнению их задач и соблюдению политик) и образование (обучение студентов/пользователей большему объёму знаний, чем необходимо для выполнения конкретных задач) важны, как и развитие чемпионов безопасности.

Также важно периодически пересматривать содержание учебных материалов, особенно с учётом быстрого темпа изменений новых технологий, таких как ИИ, блокчейн и даже криптовалюты.

Новые технологические тенденции должны быть включены в учебные материалы.

Не только материалы, но и методы должны обновляться, чтобы содержание и подход оставались актуальными и не устаревали.

Угрозы сложны, поэтому обучение должно быть актуальным и интересным, чтобы быть эффективным; это означает обновление учебных материалов и изменение способов тестирования и оценки безопасности.

Если вы всегда используете одну и ту же фишинговую кампанию или отправляете её с одного и того же аккаунта в один и тот же день — это неэффективно, и то же самое относится к другим материалам.

Вместо того чтобы полагаться на длинную/подробную документацию по безопасности для обучения и повышения осведомлённости, рассмотрите возможность использования внутренних инструментов социальных сетей, видео и интерактивных кампаний.

## 1.12.3 Оценка эффективности программы

Необходимо выделить время и средства на оценку осведомлённости и обучения в области безопасности в компании; компания должна отслеживать ключевые показатели, такие как процент сотрудников, которые переходят по ссылкам в поддельных фишинговых письмах.

# Domain 2: Asset Security — Обеспечение безопасности активов

## 2.1 Идентификация и классификация информации и активов

### 2.1.1 Классификация данных

Управление жизненным циклом данных означает защиту данных от момента их создания до уничтожения — необходимо предпринимать шаги для защиты данных с момента их создания и до их удаления.

Одним из первых шагов в жизненном цикле является идентификация и классификация информации и активов, часто в рамках политики безопасности.

В этом контексте активы включают чувствительные данные, оборудование, используемое для обработки этих данных, и носители, используемые для хранения/удержания данных.

**Категоризация данных**: процесс группировки наборов данных, информации или знаний, обладающих сопоставимой чувствительностью (например, рейтинг воздействия или потерь), и имеющих схожие требования к безопасности по закону, контракту или нормативам; акт присвоения уровня классификации активу.

**Чувствительные данные**: любая информация, которая не является общедоступной или неклассифицированной, и может включать всё, что организация должна защищать из-за её ценности или для соблюдения действующих законов и нормативов.

**Персонально идентифицируемая информация (PII)**: любая информация, позволяющая идентифицировать личность. Более конкретно, информация о человеке, включая: (1) любую информацию, которую можно использовать для различения или отслеживания личности, такую как имя, номер социального страхования, дата и место рождения, девичья фамилия матери или биометрические данные; (2) любую другую информацию, связанную или потенциально связуемую с личностью, такую как медицинская, образовательная, финансовая и трудовая информация (NIST SP 800-122).

**Защищённая медицинская информация (PHI)**: любая информация, связанная со здоровьем, в любой форме, которая может быть отнесена к конкретному человеку; обратите внимание, что HIPAA применяется к медицинским учреждениям, страховым компаниям, клиринговым центрам и любой организации, обрабатывающей PHI.

**Конфиденциальные данные (Proprietary data)**: любые данные, которые помогают организации сохранять конкурентное преимущество.

Организации классифицируют данные с использованием меток.

**Государственные метки классификации** включают:
- **Совершенно секретно (Top Secret)**: раскрытие может нанести огромный ущерб национальной безопасности, например, раскрытие информации о спутниках-шпионах
- **Секретно (Secret)**: раскрытие может негативно повлиять на национальную безопасность
- **Неклассифицировано (Unclassified)**: не является чувствительным

**Метки классификации негосударственных организаций** включают:

- **Конфиденциально / Внутренние данные (Confidential/Proprietary)**: используются только внутри организации; при несанкционированном раскрытии могут быть серьёзные последствия
- **Приватные данные (Private)**: могут включать личную информацию, такую как данные кредитных карт и банковских счетов; несанкционированное раскрытие может быть катастрофическим
- **Чувствительные данные (Sensitive)**: требуют особых мер для обеспечения конфиденциальности и целостности
- **Публичные данные (Public)**: могут быть доступны широкой публике, и их раскрытие не приведёт к ущербу

Метки могут быть настолько детализированными и индивидуальными, насколько это необходимо организации.

Важно защищать данные во всех состояниях:
- **в состоянии покоя (at rest)**
- **в передаче (in transit)**
- **в использовании (in use)**

Лучший способ защиты конфиденциальности данных — использование надёжного шифрования.

### 2.1.2 Классификация активов

Важно идентифицировать и классифицировать активы, такие как системы, мобильные устройства и т. д.

**Владельцы** несут ответственность за актив и защиту его ценности.

**Классификация активов**: присвоение активам уровня защиты, необходимого в зависимости от их ценности для организации; активы требуют назначенного владельца, чтобы быть надлежащим образом классифицированными и защищёнными; классификация активов вытекает из требований нормативов и включает оценку организационных последствий, если информация подвергнется компрометации (в отношении конфиденциальности, целостности, доступности, непричётности, подлинности, конфиденциальности или безопасности).

Классификация активов должна соответствовать классификации данных. Например, если компьютер обрабатывает совершенно секретные данные, он должен быть классифицирован как совершенно секретный актив.

**Допуск (Clearance)**: относится к доступу к определённому уровню классификации данных или оборудования, и к тому, кто имеет доступ к этому уровню.

Для изменения доступа пользователя должен использоваться формальный процесс одобрения доступа; процесс должен включать одобрение владельца данных/актива, а пользователь должен быть проинформирован о правилах и ограничениях.

Прежде чем пользователю будет предоставлен доступ, его необходимо обучить работе с соответствующим уровнем классификации.

Уровни классификации могут использоваться организациями при слияниях и поглощениях, чтобы обеспечить участие только тех сотрудников, которым необходимо знать.

В целом, метки классификации помогают пользователям правильно использовать данные и активы, например, ограничивая распространение или использование активов в соответствии с их классификацией.

Классификация активов должна учитывать:
- **Конфиденциальность (чувствительность)**
- **Целостность (точность)**
- **Доступность (критичность)**

### 2.2 Установление требований к обработке информации и активов

**Обработка активов**: процедуры, которые снижают риски, связанные с тем, кто и как перемещает, хранит и извлекает активы, обеспечивая использование надлежащих инструментов и технологий; требования к обработке основаны на классификации актива (а не на типе носителя); обработка может означать безопасную транспортировку носителя на протяжении всего его жизненного цикла.

Ключевая цель обработки данных и активов — предотвращение утечек данных, с использованием следующих подходов:

- **Поддержка данных (Data Maintenance)**: постоянные усилия по организации и уходу за данными на протяжении их жизненного цикла
- **Ограничения на сбор данных (Data Collection Limitations)**: хранить только те данные, которые имеют чёткую бизнес-цель
- **Предотвращение потери данных (Data Loss Prevention, DLP)**: системы, обнаруживающие и блокирующие попытки утечки данных; три основных типа:
    - **DLP на уровне сети**: размещается на границе сети, сканирует все исходящие сетевые данные
    - **DLP на уровне конечных устройств**: сканирует сохранённые файлы и может использоваться для предотвращения печати или копирования чувствительных данных на съёмные носители
    - **DLP в облаке**: аналогично сетевому DLP, но специально разработано для облачных сред
- **Маркировка (Labeling)**: присвоение атрибутов безопасности субъектам и объектам, представленным внутренними структурами данных; метки читаются системой и позволяют системе применять политики безопасности; маркировка часто использует такие элементы, как метаданные, штрих-коды, QR-коды, RFID или GPS-метки
- **Пометки (Marking)**: присвоение атрибутов безопасности в форме, читаемой человеком, позволяющее применять политики безопасности на уровне процессов; чувствительная информация/активы требуют надлежащей обработки (как физической, так и электронной)
- **Ограничение сбора данных**: предотвращение потерь за счёт отказа от сбора ненужных чувствительных данных; лучшая практика при сборе данных клиентов — ограничить объём собираемых данных только необходимым
- **Расположение данных (Data Location)**: хранить дублирующие копии резервных данных как локально, так и вне площадки
- **Хранение (Storage)**: хранение данных и соответствующих носителей должно основываться на классификации данных; определить места хранения и процедуры по типу хранения; использовать физические замки для бумажных носителей и шифрование для электронных данных
- **Уничтожение (Destruction)**: хранение и уничтожение данных должны основываться на классификации данных и политике архивирования; уничтожать данные, которые больше не нужны организации; политика должна определять допустимые методы уничтожения по типу и классификации (см. NIST SP-800-88)

### Методы удаления данных

- **Стирание (Erasing)**: обычно означает операцию удаления на носителе, оставляющую остаточные данные
- **Очистка (Clearing)**: удаление чувствительных данных с устройства хранения таким образом, чтобы данные не могли быть восстановлены с помощью обычных функций программного восстановления; перезапись существующих данных шаблоном; при этом методе существует вероятность восстановления данных с помощью продвинутых техник
- **Очистка с гарантией (Purging)**: удаление чувствительных данных с системы или устройства с намерением, чтобы данные не могли быть восстановлены никакими известными методами; более интенсивная версия очистки; обычно включает несколько проходов очистки в сочетании с другими инструментами (например, многократная перезапись 1 и 0); часто означает более надёжные способы удаления данных, такие как использование сильного магнитного поля (размагничивание) для уничтожения данных на носителях — хотя это не считается приемлемым для совершенно секретных данных и не гарантирует защиту от продвинутых методов восстановления
- **Физическое уничтожение (Destruction)**: включает физическое уничтожение носителей путём измельчения, сжигания, дробления или сжигания в печи; физическое уничтожение используется для SSD/электронных компонентов или в сочетании с другими менее надёжными методами; методы уничтожения включают: сжигание, дробление, измельчение, дезинтеграцию, а также использование сильного шифрования для логического уничтожения данных — более надёжный способ, чем даже очистка с гарантией

#### Остаточные данные (Data Remanence)

Остаточные данные — это данные, остающиеся на носителе после обычного удаления; чтобы гарантировать удаление всех остаточных данных, могут использоваться следующие инструменты:

- **Размагничивание (Degaussing)**: используется для магнитных носителей, удаляет данные с лент и жёстких дисков; не влияет на оптические носители или SSD
- **Криптографическое стирание (Cryptographic Erasure / Crypto Shredding)**: использование сильного шифрования для шифрования данных, а затем уничтожение ключа шифрования; лучший метод для работы с остаточными данными в облаке
- **Извлечение файлов (File Carving)**: метод компьютерной криминалистики, восстанавливающий файлы из необработанных данных устройства хранения на основе их структуры и содержимого; часто используется для восстановления файлов, не индексированных файловой системой, таких как удалённые, отформатированные или зашифрованные; также полезен для восстановления файлов, если вся директория повреждена или отсутствует

## 2.3 Безопасное предоставление информации и активов

Основная цель практик операционной безопасности — защита активов, таких как информация, системы, устройства, помещения и приложения. Эти практики помогают выявлять угрозы, уязвимости и внедрять средства контроля для снижения риска для этих активов.

Реализация общих концепций операционной безопасности наряду с проведением периодических аудитов и проверок безопасности демонстрирует уровень должной заботы.

### Принципы доступа
- **Необходимость знать (Need-to-know)**: принцип, согласно которому пользователям предоставляется доступ только к тем данным или ресурсам, которые необходимы для выполнения назначенных рабочих задач. Другими словами, доступ к активу предоставляется только в случае абсолютной необходимости, основанной на роли, функции или конкретном разрешении.
- **Минимальные привилегии (Least privilege)**: принцип, согласно которому субъектам предоставляются только те привилегии, которые необходимы для выполнения назначенных рабочих задач, и не более. Человеку предоставляется только строго необходимый доступ — и ничего сверх того.

### 2.3.1 Владение информацией и активами

**Владелец информации и активов**: назначение владельца — ключевое требование для обеспечения ответственности за защиту. Владелец — это лицо или роль, несущие окончательную организационную ответственность за защиту актива; обычно это старший менеджер (генеральный директор, президент, руководитель отдела). Владельцы, как правило, делегируют задачи по защите данных другим сотрудникам организации. Владелец актива должен убедиться, что внедрены соответствующие средства защиты.

### 2.3.2 Инвентаризация активов (например, материальные, нематериальные)

**Инвентаризация**: полный список объектов.
- **Материальные активы**: включают аппаратные и программные средства, принадлежащие организации.
- **Нематериальные активы**: такие как патенты, авторские права, репутация компании и другие активы, представляющие потенциальную прибыль.

Организация должна отслеживать нематериальные активы, такие как интеллектуальная собственность, патенты, товарные знаки, репутация компании и авторские права, чтобы обеспечить их защиту.

Примечание: патенты в США действуют в течение 20 лет.

### 2.3.3 Управление активами

**Управление активами** — это управление как материальными, так и нематериальными активами; начинается с инвентаризации активов и включает их отслеживание, а также принятие дополнительных мер по защите на протяжении всего жизненного цикла.

Основная цель управления активами — предотвращение потерь (путём отслеживания и защиты активов).

- **Аппаратные активы**: ИТ-ресурсы, такие как компьютеры, серверы, маршрутизаторы, коммутаторы и периферийные устройства
    - использовать автоматизированную систему управления конфигурацией (CMS) для помощи в управлении аппаратными активами
    - использовать штрих-коды, RFID-метки для отслеживания аппаратных активов
- **Программные активы**: операционные системы и приложения
    - важно отслеживать соблюдение лицензионных соглашений, чтобы избежать юридических проблем
    - лицензирование программного обеспечения также означает обеспечение отсутствия несанкционированного ПО в системах

Для защиты нематериальных активов (таких как интеллектуальная собственность, патенты, товарные знаки, репутация компании и авторские права) необходимо их отслеживать.

## 2.4 Управление жизненным циклом данных

**Жизненный цикл данных** — это комплексный процесс, через который проходят данные: от их создания до окончательного уничтожения. В качестве ориентира можно использовать версию жизненного цикла данных от CSA.

Вот немного модифицированная версия:

- **Создание (Creation)**: создание или изменение данных
- **Классификация и хранение (Classify & Store)**: обеспечение классификации данных и их хранения в соответствии с классификацией, с применением соответствующих средств защиты данных в состоянии покоя
- **Использование (Use)**: защита данных при передаче/движении и от неправильной утечки или распространения при использовании
- **Архивирование (Archived)**: помещение данных в долгосрочное хранилище с соответствующей защитой данных в состоянии покоя
- **Уничтожение (Destroyed)**: окончательное уничтожение данных в соответствии с их классификацией, с использованием метода, обеспечивающего невозможность восстановления

## 2.4.1 Роли, связанные с данными

- **Владелец системы (System Owner)**: контролирует компьютер, на котором хранятся данные; включает конфигурации ПО и оборудования, а также сопутствующие сервисы (например, облачные решения). Ответственен за работу и обслуживание системы, обновления/патчи и закупки. Согласно NIST SP 800-18, владелец информационной системы:
    - отвечает за безопасность системы, хранящей или обрабатывающей данные
    - разрабатывает план безопасности системы
    - поддерживает план безопасности и обеспечивает соответствие требованиям
    - обеспечивает обучение пользователей и технического персонала
    - обновляет план безопасности по мере необходимости
    - участвует в идентификации, внедрении и оценке общих средств защиты
- **Владелец данных (Data Owner)**: отвечает за классификацию, категоризацию и разрешение доступа к данным; обычно это генеральный директор, президент или руководитель отдела
- **Контролёр данных (Data Controller)**: принимает решение о том, какие данные обрабатывать и как Пример: компания, собирающая персональные данные сотрудников для расчёта зарплаты, является контролёром данных
- **Обработчик данных (Data Processor)**: действует от имени контролёра данных, обрабатывает персональные данные (PII); обязан защищать конфиденциальность и использовать данные только по назначению Пример: сторонняя компания, обрабатывающая зарплату, является обработчиком данных Согласно GDPR: «физическое или юридическое лицо, государственный орган, агентство или другой орган, который обрабатывает персональные данные исключительно от имени контролёра данных»
- **Хранитель данных (Data Custodian)**: назначается владельцем системы, отвечает за ежедневное хранение и защиту данных, резервное копирование, архивирование, предотвращение потерь и восстановление
- **Уполномоченный по данным (Data Steward)**: отвечает за качество данных, управление, соответствие требованиям, определение метаданных
- **Администратор безопасности (Security Administrator)**: обеспечивает общую безопасность инфраструктуры; выявляет уязвимости, мониторит трафик, настраивает средства защиты (межсетевые экраны, антивирусы), разрабатывает политики, планы восстановления и обучает персонал
- **Руководители (Supervisors)**: контролируют деятельность всех вышеперечисленных ролей и вспомогательного персонала; обеспечивают квалификацию сотрудников и координацию работы
- **Пользователи (Users)**: любые лица, получающие доступ к данным с устройства или системы для выполнения работы Доступ должен соответствовать роли и необходимости Пользователи обязаны соблюдать правила, политики, стандарты и процедуры Пользователи — это субъекты, а субъект — это любое лицо или процесс, получающий доступ к объекту (например, файлу)

## 2.4.2 Сбор данных

Один из самых простых способов предотвратить потерю данных — просто не собирать их.

**Рекомендация по сбору данных**: если у данных нет чёткой цели использования — не собирайте и не храните их. Именно поэтому многие законы о конфиденциальности требуют ограничения сбора данных.

## 2.4.3 Расположение данных

**Расположение данных** — в данном контексте относится к местоположению резервных копий или дубликатов данных.

Если система компании находится локально, и данные хранятся на месте, но регулярно создаются резервные копии — лучшая практика: хранить одну копию на месте, другую — вне площадки.

Следует учитывать расстояние между основным и резервным хранилищем, чтобы снизить риск одновременного повреждения.

## 2.4.4 Поддержка данных

**Поддержка данных** — управление данными на протяжении их жизненного цикла; часто автоматизированный процесс, обеспечивающий доступность данных в зависимости от стадии жизненного цикла.

Для надлежащей защиты активов необходимо:
- сохранять чувствительные данные не менее необходимого бизнесу срока, но не дольше, чем требуется
- шифровать чувствительные данные
- защищать активы с помощью базовых средств безопасности, обеспечивающих конфиденциальность, целостность и доступность
- действовать в соответствии с политиками, стандартами, процедурами и руководствами по безопасности

## 2.4.5 Хранение данных

Требования к хранению распространяются на:

- данные и записи
- носители, содержащие чувствительные данные
- системы, обрабатывающие чувствительные данные
- персонал, имеющий доступ к чувствительным данным

**Хранение записей**: хранение и поддержка информации до тех пор, пока она необходима, и её уничтожение, когда она больше не нужна.

Примечание: текущая тенденция — сокращение юридических рисков путём внедрения краткосрочной политики хранения, особенно для электронной почты.

**Три ключевых вопроса политики хранения**:

1. **Как хранить**: данные должны быть доступны при необходимости; учитывать классификацию
2. **Как долго хранить**: общее правило — 7 лет для бизнес-данных (может варьироваться по стране/региону/нормативам)
3. **Какие данные хранить**: в соответствии с требованиями организации

## 2.4.6 Остаточные данные

**Остаточные данные (Data Remanence)** — данные, остающиеся на носителе после удаления.

Обычно это данные на жёстком диске в виде остаточного магнитного потока или свободного пространства (slack space) в кластере диска.

Примечание: многие ОС хранят файлы в кластерах — группах секторов (наименьшая единица хранения на жёстком диске).

Если носитель содержит конфиденциальные данные, важно устранить остаточные данные.

Некоторые ОС заполняют свободное пространство данными из памяти — поэтому нельзя обрабатывать секретные данные на несекретных системах.

## 2.4.7 Уничтожение данных

Уничтожайте чувствительные данные, когда они больше не нужны.

Политика безопасности или работы с данными должна определять допустимые методы уничтожения в зависимости от классификации данных.

- **Размагничивание (Degaussing)**: применяется к жёстким дискам/магнитным носителям
- **Лучший способ очистки SSD** — физическое уничтожение, так как даже при использовании фирменных инструментов данные могут остаться

**Защищённое уничтожение (Defensible destruction)**: удаление данных контролируемым, юридически обоснованным и соответствующим нормативным требованиям способом

## 2.5 Обеспечение надлежащего хранения активов (например, End-of-Life (EOL), End-of-Support)

- **Аппаратное обеспечение**: даже если вы сохраняете данные в течение установленного срока хранения, это не принесёт пользы, если у вас нет оборудования, способного прочитать эти данные.
- **Персонал**: помимо хранения данных в течение требуемого периода и поддержания оборудования для их чтения, необходимо наличие персонала, который умеет работать с этим оборудованием и способен выполнить процессы восстановления.
- **End-Of-Life (EOL)** — «окончание срока службы»: обычно определяется поставщиками как момент, когда продукт больше не предлагается к продаже.
- **End-Of-Support (EOS)** / **End-Of-Service-Life (EOSL)** — «окончание поддержки» / «окончание срока обслуживания»: обычно используется для обозначения момента, когда прекращается поддержка продукта.

EOL и EOS/EOSL могут применяться как к программному обеспечению, так и к аппаратному обеспечению.

## 2.6 Определение средств защиты данных и требований к соблюдению нормативов

Необходимы средства защиты, которые обеспечивают безопасность данных в каждом возможном состоянии:

- в состоянии покоя (at rest)
- в передаче (in transit)
- в использовании (in use)

Каждое состояние требует разного подхода к защите. Обратите внимание, что для данных в использовании доступно меньше вариантов защиты, чем для данных в покое или в передаче.

На практике основными средствами защиты данных в использовании являются:

- установка обновлений
- поддержание стандартного процесса сборки компьютеров
- запуск антивирусного/антивредоносного ПО

### 2.6.1 Состояния данных (например, в использовании, в передаче, в покое)

- **Данные в покое (Data at rest)**: любые данные, хранящиеся на носителях, таких как жёсткие диски или внешние накопители
- **Данные в передаче (Data in transit / in motion)**: любые данные, передаваемые по сети
- **Данные в использовании (Data in use)**: данные в оперативной памяти, используемые приложением
    - Приложения должны очищать буферы памяти после завершения работы с данными

Методы шифрования защищают данные в покое и в передаче.

### 2.6.2 Объём и адаптация (Scoping and Tailoring)

- **Базовый уровень (Baseline)**: задокументированный минимальный уровень конфигурации безопасности, допустимый стандартом или организацией

После выбора базового уровня организации настраивают его с помощью процессов адаптации и определения объёма. Большая часть адаптации заключается в согласовании средств защиты с конкретными требованиями безопасности организации.

**Адаптация (Tailoring)** — модификация перечня средств защиты в рамках базового уровня для соответствия миссии организации. Включает:

- определение и назначение общих средств защиты
- задание параметров, определённых организацией
- применение рекомендаций по объёму
- выбор/указание компенсирующих средств защиты
- присвоение значений средствам защиты

**Определение объёма (Scoping)** — установление границ реализации средств защиты; исключение рекомендаций базового уровня, которые не применимы. Это часть процесса адаптации и включает выбор только тех средств защиты, которые применимы к защищаемым системам.

### 2.6.3 Выбор стандартов

Организации должны определить применимые стандарты (например, PCI DSS, GDPR) и убедиться, что выбранные средства защиты полностью соответствуют этим стандартам.

Даже если организация не обязана соблюдать конкретный стандарт, использование хорошо разработанных отраслевых стандартов (например, документов NIST SP 800) может быть полезным.

**Выбор стандартов (Standards selection)** — процесс, в рамках которого организация планирует, выбирает и документирует технологии или архитектуры для внедрения.

Пример: вы оцениваете трёх поставщиков средств защиты — процесс выбора стандартов помогает определить, какое решение лучше всего подходит организации.

**Выбор поставщика (Vendor selection)** тесно связан с выбором стандартов, но фокусируется на поставщиках, а не на технологиях.

Цель — обеспечить объективный и измеримый процесс выбора. Если процесс повторит совершенно другая команда, она должна прийти к тому же выбору.

### 2.6.4 Методы защиты данных (например, DRM, DLP, CASB)

**Методы защиты данных включают:**

- **Управление цифровыми правами (DRM)**: методы, направленные на защиту авторских материалов; цель — предотвратить несанкционированное использование, изменение и распространение защищённых работ
- **Cloud Access Security Broker (CASB)**: программное обеспечение, логически размещённое между пользователями и облачными ресурсами, обеспечивающее, чтобы облачные ресурсы имели такую же защиту, как и ресурсы внутри сети CASB обеспечивает соблюдение политик безопасности и соответствие требованиям при доступе к облачным приложениям и данным Может использоваться как локально, так и в облаке Четыре ключевых элемента CASB: видимость, безопасность данных, обнаружение угроз и соответствие
- **GDPR** требует дополнительных методов защиты данных, таких как:
    - **Анонимизация** и **рандомизированное маскирование** (необратимые)
    - **Квази-анонимизация** (обратимые):
        - **Псевдонимизация**: замена элементов данных псевдонимами/алиасами
        - **Токенизация**: замена данных случайными токенами, не имеющими значения вне системы

#### Защита данных по состояниям

##### Данные в покое:

- Шифрование томов ОС, томов с данными, резервных копий
- Учитывать все места хранения: ленты, USB, внешние диски, RAID, SAN, NAS, оптические носители
- DRM полезен, так как «путешествует» вместе с данными, независимо от состояния
- DRM особенно полезен, когда невозможно зашифровать весь том

##### Данные в передаче:

- Шифрование при передаче данных между любыми точками
    - Пример: веб-сервер использует сертификат для шифрования данных, просматриваемых пользователем
    - Пример: IPsec шифрует сеанс связи
- Использовать шифрование даже для внутренних веб-приложений
- DLP-решения полезны для сканирования трафика и блокировки передачи по заданным правилам
    - Пример: блокировка исходящего трафика, содержащего номера, похожие на номера соцстраховки

##### Данные в использовании:

- CASB объединяет DLP, веб-фаервол, аутентификацию/авторизацию и сетевой фаервол
- CASB полезен для защиты данных в использовании и в передаче
- **Псевдонимизация**: замена данных псевдонимами, которые можно расшифровать при наличии ключа
- **Токенизация**: замена данных токенами, не имеющими значения вне системы

**Пример токенизации в транзакциях с банковскими картами:**

1. **Регистрация**: приложение отправляет данные карты в процессинговый центр
2. **Создание токена**: процессинговый центр создаёт токен и связывает его с устройством
3. **Покупка**: POS-терминал отправляет токен для авторизации
4. **Проверка**: токен отправляется в хранилище, где восстанавливаются данные карты
5. **Завершение**: подтверждение транзакции возвращается в POS

Такой подход предотвращает кражу данных карты на терминале.

# Domain 3: Архитектура и инженерия безопасности

## 3.1 Исследование, внедрение и управление инженерными процессами с использованием принципов безопасного проектирования

**Стандартные принципы безопасного проектирования:**

- Минимальные привилегии (Least privilege)
- Безопасные настройки по умолчанию (Secure defaults)
- Безопасный отказ (Fail securely)
- Моделирование угроз (Threat modeling)
- Простота (Keep it simple)
- Разделение обязанностей (Separation of duties)
- Нулевое доверие (Zero trust)
- Конфиденциальность по проекту (Privacy by design)

### 3.1.1 Моделирование угроз

Моделирование угроз — это процесс безопасности, при котором потенциальные угрозы идентифицируются, классифицируются и анализируются. Может выполняться как проактивная мера на этапе проектирования и разработки, либо как реактивная — после развертывания продукта.

Моделирование угроз определяет:

- потенциальный вред
- вероятность возникновения
- приоритет угроз
- способы устранения или снижения угроз

Обычно включает декомпозицию приложения для понимания его работы и взаимодействия с другими компонентами или пользователями. Идентификация и ранжирование угроз позволяет расставить приоритеты, а определение способов их устранения завершает процесс.

### 3.1.2 Минимальные привилегии

Как указано в домене 2, принцип минимальных привилегий означает, что субъектам предоставляются только те права, которые необходимы для выполнения назначенных рабочих задач — и не более. Этот принцип распространяется на данные и системы. Ограничение и контроль привилегий защищает конфиденциальность и целостность данных.

### 3.1.3 Глубинная защита (Defense in Depth)

Глубинная защита (или слоистая защита) — использование нескольких средств контроля последовательно, чтобы отказ одного не привёл к компрометации системы или данных. Слои должны использоваться последовательно, а не параллельно.

Если вы видите термины вроде уровней, многослойности, зон, областей, колец защиты — это относится к глубинной защите.

### 3.1.4 Безопасные настройки по умолчанию

Безопасные настройки по умолчанию — это то, как система работает «из коробки», сразу после передачи от поставщика. Примеры:

- стандартный пароль администратора на маршрутизаторе
- конфигурация межсетевого экрана, требующая изменений для соответствия требованиям организации

### 3.1.5 Безопасный отказ

Если система, актив или процесс выходит из строя, он не должен раскрывать конфиденциальную информацию или становиться менее безопасным, чем в нормальном режиме. Безопасный отказ может включать возврат к настройкам по умолчанию.

**Сравнение цифрового и физического отказа:**

|Состояние|Цифровое поведение|Физическое поведение|
|---|---|---|
|Fail-Open|Поддержание доступности системы|Защита людей|
|Fail-Safe|Поддержание конфиденциальности и целостности|Защита людей|
|Fail-Closed|Поддержание конфиденциальности и целостности|Защита актива|
|Fail-Secure|Поддержание конфиденциальности и целостности|Защита актива|

### 3.1.6 Разделение обязанностей (SoD)

Разделение обязанностей — это обеспечение того, чтобы ни один человек не имел полного контроля над критически важной функцией или системой. Цель — минимизировать возможности злоупотребления данными или нанесения ущерба среде. Помогает предотвратить мошенничество.

Пример: один человек продаёт билеты, другой проверяет билеты и ограничивает доступ в кинотеатр.

### 3.1.7 Простота

Принцип «Keep it simple» (или KISS — Keep It Simple, Stupid) — призыв избегать чрезмерной сложности в среде, организации или проектировании продукта.

### 3.1.8 Нулевое доверие (Zero Trust) и «доверяй, но проверяй»

**Zero Trust** — концепция безопасности, предполагающая «взлом по умолчанию»; альтернатива традиционному подходу «замок и ров», при котором ничто не считается доверенным автоматически. Каждый запрос на доступ или действие считается поступающим из неизвестного и ненадёжного источника до тех пор, пока не будет проверен.

**Trust but verify** — основано на русской пословице, но больше не считается достаточным. Это традиционный подход, при котором субъекты и устройства внутри периметра безопасности организации автоматически считаются доверенными, что делает организацию уязвимой для внутренних атак и позволяет злоумышленникам легко перемещаться по сети.

**«Никогда не доверяй, всегда проверяй»** заменяет «доверяй, но проверяй» как принцип проектирования безопасности, утверждая, что все действия всех пользователей/сущностей должны контролироваться, аутентифицироваться, авторизоваться и управляться на максимально детализированном уровне.

Цель — чтобы каждый запрос на доступ был аутентифицирован, авторизован и зашифрован до предоставления доступа к ресурсу.

### 3.1.9 Конфиденциальность по проекту (Privacy by Design)

Конфиденциальность по проекту — это руководство по интеграции механизмов защиты конфиденциальности в продукты на самых ранних этапах проектирования, а не в конце разработки.

Аналогично концепции «безопасность по проекту», где безопасность — элемент архитектуры продукта с самого начала и на протяжении всего жизненного цикла разработки ПО (SDLC).

**7 признанных принципов PbD:**

1. **Проактивность, предупреждение** — предвидеть и проектировать с учётом возможных событий
2. **Настройки по умолчанию** — конфиденциальность по умолчанию (например, соцсеть не должна делиться данными пользователя со всеми)
3. **Встроенность** — конфиденциальность должна быть встроена, а не добавлена позже
4. **Полная функциональность, положительная сумма** — достижение и безопасности, и конфиденциальности
5. **Защита на всём протяжении жизненного цикла** — конфиденциальность до, во время и после транзакции; включая безопасное удаление данных
6. **Прозрачность, открытость** — публикация требований и целей, аудит и публикация результатов
7. **Уважение, ориентация на пользователя** — вовлечение пользователей, предоставление информации для принятия осознанных решений

### 3.1.10 Разделение ответственности

Разделение ответственности — принцип проектирования безопасности, согласно которому организации не действуют изолированно. Каждый сотрудник несёт определённую ответственность за безопасность.

- Задача CISO и команды безопасности — устанавливать и поддерживать безопасность
- Задача обычных сотрудников — выполнять свои обязанности в рамках политики безопасности
- Задача аудитора — мониторить среду на предмет нарушений

При работе с третьими сторонами, особенно облачными провайдерами, каждая сторона должна понимать свою часть ответственности за выполнение операций и поддержание безопасности. Это часто называется моделью разделения ответственности в облаке.

### 3.1.11 Безопасный доступ через периферийную инфраструктуру (SASE)

**SASE (Secure Access Service Edge)** — облачная платформа, объединяющая функции сетевой и информационной безопасности в единую систему. Включает: SD-WAN, SWG, CASB, FWaaS, ZTNA.

**Цели SASE:**

- Устранение ограничений традиционной архитектуры безопасности
- Защита удалённого доступа в гибридных моделях работы
- Поддержка облачных решений и интеграция с локальной инфраструктурой
- Приближение безопасности и сетевых функций к пользователю/устройству через периферийные вычисления (edge computing)

**Сравнение традиционной модели и SASE:**

|Аспект|Традиционная модель|SASE|
|---|---|---|
|Философия безопасности|«Замок и ров» — доверие внутри|Нулевое доверие — всегда проверяй|
|Сетевая архитектура|Централизованная|Распределённая, облачная|
|Предположение о местоположении|Пользователи и ресурсы внутри сети|Пользователи, устройства и данные — везде|
|Маршрутизация трафика|Перенаправление в центр для проверки|Прямое подключение к ближайшему облачному узлу|
|Ключевые технологии|Фаерволы, VPN, IDS/IPS|SD-WAN, ZTNA, CASB, SWG,|
## 3.2 Понимание фундаментальных концепций моделей безопасности

**Модели безопасности** предназначены для предоставления явного набора правил, которым компьютер может следовать для реализации фундаментальных концепций, процессов и процедур политики безопасности.

Они позволяют разработчику преобразовать абстрактные утверждения в политику безопасности, предписывающую алгоритмы и структуры данных, необходимые для создания аппаратного и программного обеспечения.

Цель — обеспечить доступ пользователей только к тем данным, которые соответствуют их уровню допуска.

#### Модель Bell-LaPadula (BLP)

##### Общая характеристика

- Разработана в 1973 году для Министерства обороны США.
- Основная цель: **обеспечение конфиденциальности** информации.
- Применяется в системах с **мандатным управлением доступом (MAC)**, где доступ к данным регулируется на основе уровня допуска пользователя и уровня секретности информации.

##### Основные принципы

Модель основана на **иерархии уровней безопасности**, например:

- Top Secret (Совершенно секретно)
- Secret (Секретно)
- Confidential (Конфиденциально)
- Unclassified (Неклассифицировано)

Каждому пользователю (субъекту) и каждому ресурсу (объекту) присваивается уровень безопасности. Доступ разрешается или запрещается в зависимости от этих уровней.

##### Ключевые свойства модели

|Свойство|Название|Правило|Цель|
|---|---|---|---|
|**Simple Security Property**|«Нет чтения вверх» (No Read Up)|Субъект не может читать данные, классифицированные выше его уровня|Защита от несанкционированного доступа к более секретной информации|
|_Star (_) Property*|«Нет записи вниз» (No Write Down)|Субъект не может записывать данные в объекты с более низким уровнем|Предотвращение утечки секретной информации в менее защищённые области|
|**Strong Star Property**|Сильное звёздное свойство|Субъект может читать и писать только на своём уровне|Полная изоляция между уровнями|
|**Discretionary Security Property**|Дискреционное управление|Используется матрица доступа (например, ACL)|Дополнительный контроль доступа на основе «необходимости знать»|

##### Архитектурная модель

- Основана на **модели конечного автомата**: система переходит из одного безопасного состояния в другое, и каждое действие проверяется на соответствие политике безопасности.
- **Модель потока информации**: расширяет модель конечного автомата, предотвращая несанкционированный поток данных между уровнями.

##### Ограничения модели

- Не решает проблему **скрытых каналов** (covert channels), через которые информация может передаваться в обход официальных механизмов.
- Не обеспечивает **целостность** данных — для этого используется модель Biba.
- Не подходит для систем, где важна гибкость или динамическое изменение прав доступа.

##### Применение

- Используется в государственных и военных системах, где критично важно предотвратить утечку секретной информации.
- Применяется в системах, где пользователи имеют фиксированные уровни допуска, а данные строго классифицированы.

#### Zero Trust

**Zero Trust** — это модель безопасности, основанная на принципе:

> **«Никогда не доверяй, всегда проверяй»**

**Zero Trust** — это не просто технология, а **архитектурный подход к безопасности**, в котором **никому и ничему не доверяют по умолчанию**, даже если это находится внутри корпоративной сети.

Она отвергает традиционную идею, что всё внутри корпоративной сети можно считать безопасным. Вместо этого каждый запрос на доступ — от пользователя, устройства или приложения — должен быть проверен, независимо от его местоположения или происхождения.

*Почему традиционная модель устарела?*

Традиционная модель безопасности строилась по принципу **"замок и ров"**:
- Всё внутри сети считается безопасным
- Всё снаружи — потенциально опасным
**Проблема**: если злоумышленник попал внутрь (например, через фишинг или заражённое устройство), он получает **широкий доступ** и может свободно перемещаться по сети.

##### Ключевые принципы Zero Trust

| Принцип                      | Описание                                                                         |
| ---------------------------- | -------------------------------------------------------------------------------- |
| **Предположение о взломе**   | Всегда предполагается, что система может быть скомпрометирована                  |
| **Минимальные привилегии**   | Пользователи и процессы получают только те права, которые им действительно нужны |
| **Контекстная проверка**     | Учитываются устройство, местоположение, поведение, время суток и др.             |
| **Проверка каждого запроса** | Каждый доступ требует аутентификации и авторизации                               |
| **Микросегментация**         | Сеть делится на изолированные зоны, чтобы ограничить распространение угроз       |
| **Непрерывный мониторинг**   | Поведение пользователей и устройств постоянно анализируется                      |
| **Шифрование данных**        | Все данные — в покое и в передаче — должны быть зашифрованы                      |

##### Как работает Zero Trust

- Пользователь пытается получить доступ к ресурсу
- Система проверяет:
    - Кто это (идентификация)
    - Где он находится (геолокация, устройство)
    - Что он хочет сделать (запрос)
    - Имеет ли он право (авторизация)
- Только после успешной проверки доступ предоставляется — временно и строго ограниченно

##### Где применяется

- Облачные среды (SaaS, IaaS, PaaS)
- Гибридные и удалённые рабочие модели
- Корпоративные сети с высокой степенью риска
- Защита критически важных данных и инфраструктуры

##### Отличие от традиционной модели

|Традиционная модель|Zero Trust|
|---|---|
|«Замок и ров»: всё внутри сети считается безопасным|Всё считается потенциально опасным|
|Доверие по местоположению|Доверие по идентичности и контексту|
|Сложно масштабировать|Гибкая, облачная, масштабируемая|
|Уязвима к внутренним угрозам|Защита от внутренних и внешних атак|
##### Пример: как выглядит Zero Trust в действии

**Сценарий**: сотрудник подключается к CRM из кафе

| Этап              | Что делает Zero Trust                                     |
| ----------------- | --------------------------------------------------------- |
| 1. Ввод логина    | Проверка через MFA                                        |
| 2. Устройство     | Проверка на соответствие политике (антивирус, обновления) |
| 3. Местоположение | Подозрительное? — ограниченный доступ или блокировка      |
| 4. Поведение      | Необычная активность? — триггер на расследование          |
| 5. Доступ         | Только к нужным данным, на ограниченное время             |

#### Сочетание с SASE

**SASE (Secure Access Service Edge)** — это современная облачная архитектура, которая объединяет **сетевые функции и функции безопасности** в единую платформу, доставляемую через облако.

##### Основная идея SASE

> **Объединить сеть и безопасность в облаке, ближе к пользователю.**

Вместо того чтобы направлять весь трафик через центральный офис или дата-центр (как в традиционных моделях), SASE позволяет пользователям подключаться напрямую к ближайшему облачному узлу с полной проверкой безопасности.

##### Преимущества SASE

- **Безопасность**: встроенные механизмы Zero Trust, шифрование, контроль доступа
- **Гибкость**: поддержка удалённой и гибридной работы
- **Производительность**: снижение задержек за счёт подключения к ближайшему облачному узлу
- **Централизованное управление**: единая панель для мониторинга и настройки политик
- **Интеграция с облаком**: защита SaaS, IaaS и других облачных сервисов

##### SASE vs Традиционная модель

|Аспект|Традиционная модель|SASE|
|---|---|---|
|Архитектура|Централизованная (через дата-центр)|Распределённая, облачная|
|Безопасность|Доверие внутри сети|Zero Trust: проверка каждого запроса|
|Доступ|Через VPN или локальную сеть|Через облако, с проверкой личности|
|Масштабируемость|Ограничена оборудованием|Легко масштабируется в облаке|
|Поддержка удалёнки|Ограничена|Полноценная и безопасная|

##### Компоненты SASE

|Компонент|Назначение|
|---|---|
|**SD-WAN** (Software-Defined WAN)|Интеллектуальная маршрутизация трафика между пользователями и приложениями|
|**ZTNA** (Zero Trust Network Access)|Доступ по принципу «никогда не доверяй, всегда проверяй»|
|**SWG** (Secure Web Gateway)|Фильтрация веб-трафика и защита от вредоносных сайтов|
|**CASB** (Cloud Access Security Broker)|Контроль доступа к облачным приложениям и защита данных|
|**FWaaS** (Firewall as a Service)|Облачный межсетевой экран для защиты от угроз|
### 3.3 Выбор средств контроля на основе требований к безопасности системы

Организации должны выбирать средства защиты (контроли) в зависимости от:
- типа системы
- уровня риска
- требований к конфиденциальности, целостности и доступности

Для оценки и сравнения решений используется международный стандарт **Common Criteria (CC)**.

#### Что такое Common Criteria?

**Common Criteria for Information Technology Security Evaluation (CC)** — это международный стандарт (ISO/IEC 15408), который определяет, как оценивать безопасность ИТ-продуктов.

> Цель: обеспечить **объективную и стандартизированную оценку** безопасности программного и аппаратного обеспечения.

#### Основные элементы Common Criteria

|Элемент|Описание|
|---|---|
|**TOE (Target of Evaluation)**|Объект оценки — например, антивирус, фаервол, ОС|
|**PP (Protection Profile)**|Профиль защиты — документ с требованиями заказчика|
|**ST (Security Target)**|Цели безопасности — описание функций безопасности от поставщика|
|**SAR (Security Assurance Requirements)**|Требования к обеспечению безопасности — как будет проводиться оценка|
|**EAL (Evaluation Assurance Level)**|Уровень гарантии оценки — числовая шкала от 1 до 7|

##### Важные понятия:

- Чтобы провести оценку, необходимо выбрать **объект оценки (TOE)** (например, фаервол или антивирусное приложение).
- Процесс оценки будет рассматривать **профиль защиты (PP)** — это документ, в котором изложены потребности в безопасности (то, что хочет заказчик); поставщик может использовать конкретный профиль защиты для определённого решения.
- Процесс оценки будет рассматривать **цель безопасности (ST)**, в которой указаны заявления о безопасности от поставщика, встроенные в TOE (ST обычно публикуется для клиентов и партнёров и доступен внутреннему персоналу).
- Профиль защиты организации сравнивается с различными ST от выбранных TOE поставщика, и организация приобретает наиболее близкое или лучшее соответствие.
- Оценка будет пытаться определить уровень доверия к функции безопасности.
- **Требования к обеспечению безопасности (SARs)**: описание того, как TOE должен быть оценён, на основе разработки решения.
- Ключевые действия во время разработки и тестирования должны быть зафиксированы.

#### Уровни EAL — шкала надёжности

|Уровень|Название|Описание|
|---|---|---|
|**EAL1**|Функциональное тестирование|Быстро, дёшево, минимальная проверка|
|**EAL2**|Структурное тестирование|Базовая проверка архитектуры|
|**EAL3**|Методическое тестирование|Проверка по методике, с анализом|
|**EAL4**|Методическое проектирование и обзор|Стандартный уровень для коммерческих продуктов|
|**EAL5**|Полуформальное проектирование|Повышенная надёжность, частично формализовано|
|**EAL6**|Полуформальная верификация|Почти формальное доказательство безопасности|
|**EAL7**|Формальная верификация|Максимальный уровень, используется в критических системах (военные, ядерные)|

#### Как проходит оценка

1. Организация определяет **свои требования** (PP)
2. Сравнивает их с **предложениями поставщиков** (ST)
3. Выбирает продукт с подходящим уровнем **EAL**
4. Проводится оценка с учётом **SAR** — как продукт был разработан и протестирован
5. Назначается **Authorization to Operate (ATO)** — официальное разрешение на использование

### 3.4 Понимание возможностей безопасности информационных систем

Возможности безопасности информационных систем включают защиту памяти, виртуализацию, Trusted Platform Module (TPM), шифрование/дешифрование, интерфейсы и отказоустойчивость.

Вычислительное устройство, скорее всего, одновременно запускает несколько приложений и сервисов, каждое из которых занимает сегмент памяти; цель защиты памяти — **предотвратить влияние одного приложения или сервиса на другое**.

Существует два основных метода защиты памяти:
- **Изоляция процессов**: ОС предоставляет отдельные области памяти для каждой инструкции и данных процесса и предотвращает влияние одного процесса на другой.
- **Аппаратная сегментация**: обеспечивает разделение с помощью физических аппаратных средств, а не логических процессов; при таком типе сегментации операционная система сопоставляет процессы с выделенными участками памяти.

**Виртуализация**: технология, используемая для размещения одной или нескольких операционных систем в памяти одного хоста или для запуска приложений, несовместимых с ОС хоста; цель — защитить гипервизор и гарантировать, что компрометация одной виртуальной машины не повлияет на другие на этом хосте.

**Виртуальное программное обеспечение**: программное обеспечение, развернутое таким образом, что оно действует как будто взаимодействует с полной ОС хоста; виртуализированное приложение изолировано от ОС хоста, поэтому оно не может вносить прямые/постоянные изменения в ОС хоста.

**Trusted Platform Module (TPM)**: криптографический чип, который иногда включается в клиентский компьютер или сервер; TPM расширяет возможности компьютера, предлагая аппаратные криптографические операции.

`TPM` — это устойчивый к взлому интегральный модуль, встроенный в некоторые материнские платы, который может выполнять криптографические операции (включая генерацию ключей) и защищать небольшие объёмы конфиденциальной информации, такие как пароли и криптографические ключи.

Многие продукты безопасности и решения по шифрованию требуют наличия `TPM`.

`TPM` — это как спецификация криптопроцессорного чипа на материнской плате, так и общее название реализации этой спецификации.

`TPM` — пример аппаратного модуля безопасности (HSM): криптопроцессор, используемый для управления и хранения цифровых ключей шифрования, ускорения криптографических операций, поддержки более быстрых цифровых подписей и улучшения аутентификации.

**Пользовательский интерфейс**: ограниченный пользовательский интерфейс может использоваться в приложении для ограничения того, что пользователи могут делать или видеть, в зависимости от их привилегий. Например, затемнение/отключение функций для пользователей без соответствующих привилегий.

Интерфейс — это также способ, с помощью которого две или более систем взаимодействуют.

Безопасность интерфейсов:
- **Шифрование/дешифрование**: когда коммуникации зашифрованы, клиент и сервер могут взаимодействовать, не раскрывая информацию в сети; если интерфейс не предоставляет такую возможность, используйте IPsec или другой механизм защищённой передачи.
- **Подпись**: используется для обеспечения неотказуемости; в условиях высокой безопасности желательно шифровать и подписывать все коммуникации, если возможно.

**Отказоустойчивость**: возможность, используемая для повышения доступности; в случае атаки (например, DoS) или сбоя системы отказоустойчивость помогает системе оставаться работоспособной.

### 3.5 Оценка и устранение уязвимостей архитектур безопасности, дизайна и элементов решений

Эта глава относится к **выявлению уязвимостей** и соответствующих **мер по их смягчению и решений**; ключевым моментом является **понимание типов уязвимостей**, которые обычно присутствуют в различных средах, и **вариантов их устранения**.

#### 3.5.1 Клиентские системы

- **Клиентские компьютеры** являются наиболее часто атакуемой точкой входа.
- **Скомпрометированные клиентские компьютеры** могут быть использованы для запуска других атак.
- **Программное обеспечение для повышения производительности** и **веб-браузеры** являются постоянными целями.
- Даже **обновлённые клиентские компьютеры** находятся под угрозой из-за фишинга и векторов социальной инженерии.

**Устранение**: Запуск полного набора программного обеспечения безопасности, включая:
- антивирус / анти-вредоносное ПО,
- антишпионское ПО,
- и межсетевой экран на стороне хоста (host-based firewall).

#### 3.5.2 Серверные системы

**Управление потоком данных (Data Flow Control)**: перемещение данных между процессами, между устройствами, по сети или через канал связи.

Управление потоком данных направлено на:
- минимизацию задержек / промедлений,
- сохранение конфиденциальности трафика (например, с использованием шифрования),
- недопущение перегрузки трафика (например, с помощью балансировщика нагрузки), и может обеспечиваться сетевыми устройствами / приложениями и службами.

Хотя злоумышленники могут изначально нацеливаться на клиентские компьютеры, **целью часто являются серверы**.

**Устранение**:
- регулярное применение обновлений (патчей)
- развертывание защищённых (hardened) сборок образов серверных ОС
- использование межсетевых экранов на стороне хоста (host-based firewalls)

#### 3.5.3 Системы баз данных

- Базы данных часто хранят **наиболее конфиденциальные данные компании** (например, собственническую информацию, данные кредитных карт, защищённую медицинскую информацию (PHI) и персональные данные (PII)).
- **Кардинальность (Cardinality)**: относится к количеству строк в таблице.
- **Степень (Degree)**: относится к количеству столбцов в таблице.

##### Общие свойства ACID баз данных

(**Atomicity, Consistency, Isolation, Durability** — атомарность, согласованность, изолированность, надёжность):

- **Атомарность (Atomicity)**: транзакции выполняются полностью или не выполняются вовсе; транзакция должна быть атомарной единицей работы, то есть все её изменения данных выполняются либо полностью, либо не выполняются вообще.
- **Согласованность (Consistency)**: транзакции должны оставлять базу данных в согласованном состоянии.
- **Изолированность (Isolation)**: транзакции обрабатываются независимо друг от друга.
- **Надёжность (Durability)**: после фиксации транзакции она навсегда записывается.

##### Атаки на базы данных

Злоумышленники могут использовать **вывод (inference)** или **агрегацию (aggregation)** для получения конфиденциальной информации.

##### Атака агрегации

Атака агрегации — это тип атаки на базы данных, при которой злоумышленник **получает конфиденциальную информацию**, используя **математические функции и объединение данных**, даже если отдельные элементы информации сами по себе не являются секретными.

**Суть атаки агрегации**

> Злоумышленник использует **встроенные функции SQL** (например, `SUM`, `AVG`, `COUNT`, `GROUP BY`) для **объединения записей** из одной или нескольких таблиц, чтобы получить **обобщённую информацию**, которая может быть чувствительной.

**Пример**

Допустим, у вас есть таблица с зарплатами сотрудников, но доступ к конкретным значениям ограничен. Однако пользователь может выполнить запрос:

```sql
SELECT AVG(salary) FROM employees WHERE department = 'Finance';
```

Если в отделе всего один сотрудник, то **средняя зарплата = его зарплата**, и таким образом можно обойти ограничения.

**Способы защиты**
- **Контроль доступа на уровне запросов**: ограничить выполнение агрегатных функций для определённых ролей.
- **Минимальный размер выборки**: запретить агрегирование, если выборка слишком мала (например, менее 5 записей).
- **Маскирование данных**: использовать обобщённые или округлённые значения.
- **Аудит запросов**: отслеживать подозрительные агрегатные запросы.

##### Атака вывода

Атака вывода (inference attack) — это тип атаки на информационные системы и базы данных, при которой злоумышленник **получает доступ к конфиденциальной информации**, **не напрямую**, а **путём логических умозаключений**, используя **несекретные данные**.

**Суть атаки вывода**

> Злоумышленник **комбинирует фрагменты открытой или низкоуровневой информации**, чтобы **вывести** или **догадаться** о данных, которые должны быть защищены.

Это не взлом, а **интеллектуальное использование доступных данных** — атака основана на **дедукции**, а не на технических уязвимостях.

**Пример**

Допустим, в базе данных скрыты зарплаты сотрудников, но доступны их должности и отделы. Злоумышленник может:
- Узнать, что в отделе «Финансы» всего один сотрудник
- Видеть, что средняя зарплата отдела — 120 000 ₽
- Сделать вывод, что зарплата этого сотрудника — 120 000 ₽

Таким образом, **конфиденциальная информация получена без прямого доступа**.

#### 3.5.4 Криптографические системы

Цель хорошо реализованной криптографической системы — сделать компрометацию слишком трудоёмкой и/или дорогостоящей.

Каждый компонент имеет уязвимости:

**Принцип Керкгоффа (также известный как предположение Керкгоффа)**: Криптографическая система должна быть безопасной, даже если всё о системе, кроме ключа, является общедоступной информацией.

**Программное обеспечение**: Используется для шифрования/дешифрования данных; может быть автономным приложением, командной строкой, встроенным в ОС или вызываться через API; как и любое программное обеспечение, вероятны ошибки/проблемы, поэтому регулярное обновление важно.

**Ключи**: Определяют, как шифрование применяется через алгоритм; ключ должен оставаться секретным, иначе безопасность зашифрованных данных находится под угрозой.

**Пространство ключей (key space)**: Представляет все возможные перестановки ключа.

**Рекомендации по пространству ключей**:
- Длина ключа — важный фактор; используйте максимально возможную длину ключа (ваша цель — опередить предполагаемый рост криптоаналитических возможностей в течение времени, пока данные должны оставаться защищёнными); более длинные ключи препятствуют атакам методом перебора (brute-force).
- Ключ длиной 256 бит — типичная минимальная рекомендация для симметричного шифрования.
- Ключ длиной 2048 бит — типичная минимальная рекомендация для асимметричного шифрования.
- Всегда храните секретные ключи безопасно, и если необходимо передавать их по сети — делайте это способом, защищающим от несанкционированного раскрытия.
- Выбирайте ключ с максимально возможной случайностью, используя всё пространство ключей.
- Уничтожайте ключи безопасно, когда они больше не нужны.
- Всегда основывайте длину ключа на требованиях и чувствительности обрабатываемых данных.

**Алгоритмы**: Выбирайте алгоритмы (или шифры) с большим пространством ключей и большим случайным значением ключа (значение ключа используется алгоритмом в процессе шифрования).

Сами алгоритмы не являются секретными; они имеют обширную публичную информацию об истории и принципах работы.

#### 3.5.9 Микросервисы

Что такое микросервисы?

**Микросервисы** — это архитектурный подход, при котором приложение состоит из **небольших, независимых компонентов**, каждый из которых выполняет **одну конкретную функцию**. Эти компоненты могут быть:
- отдельной бизнес-логикой,
- функцией (например, авторизация),
- или сервисом (например, обработка платежей).

Они **взаимодействуют друг с другом через API** — интерфейсы прикладного программирования.

Микросервисы — это **производная от сервис-ориентированной архитектуры (SOA)**. SOA объединяет отдельные сервисы в новое приложение. Проблема: такие приложения часто **новые**, и их **уязвимости ещё не изучены и не защищены**.

**Особенности микросервисов**:
- Маленькие и узкоспециализированные
- Слабо связаны друг с другом
- Разрабатываются быстро, часто по методологии Agile
- Легко масштабируются и обновляются

##### Безопасность микросервисов

Ключевые меры:

| Мера                      | Объяснение                                                 |
| ------------------------- | ---------------------------------------------------------- |
| Использовать только HTTPS | Защита данных при передаче                                 |
| Шифровать всё возможное   | Защита конфиденциальности                                  |
| Регулярное сканирование   | Выявление уязвимостей                                      |
| «Сдвиг влево»             | Внедрение безопасности на ранних этапах разработки         |
| Интеграция в CI/CD        | Автоматическая проверка безопасности при каждом обновлении |
| Контроль цепочки поставок | Проверка библиотек и зависимостей                          |
| Защита API                | Аутентификация, авторизация, шифрование                    |
| Безопасность контейнеров  | Контроль доступа, безопасные образы, регулярные обновления |

#### 3.5.10 Контейнеризация

**Контейнеризация**, также известная как **виртуализация ОС**, основана на концепции устранения дублирования элементов операционной системы в виртуальной машине; вместо этого каждое приложение помещается в контейнер, который включает только фактические ресурсы, необходимые для поддержки приложения, а общие или совместно используемые элементы ОС используются от гипервизора.

**Преимущества**

- **Высокая плотность приложений**: на одном физическом сервере можно запустить **в 10–100 раз больше контейнеров**, чем виртуальных машин.
- **Быстрая разработка и масштабирование**: контейнеры легко развертывать, обновлять и масштабировать.

**Проблемы безопасности контейнеров**

| Проблема             | Объяснение                                                                        |
| -------------------- | --------------------------------------------------------------------------------- |
| Слабая изоляция      | Контейнеры изолированы хуже, чем виртуальные машины, и могут влиять друг на друга |
| Уязвимости в образах | Образы контейнеров могут содержать устаревшее или уязвимое ПО                     |
| Открытые реестры     | Без контроля доступа злоумышленники могут загружать вредоносные образы            |
| Зависимости          | Используемые библиотеки могут содержать уязвимости или быть скомпрометированы     |

**Как защитить контейнеры**

| Мера                    | Объяснение                                                                        |
| ----------------------- | --------------------------------------------------------------------------------- |
| Сканирование образов    | Проверка на наличие уязвимостей перед развертыванием                              |
| Защита реестров         | Ограничение доступа: кто может загружать и скачивать образы                       |
| Подпись образов         | Проверка подлинности и целостности контейнеров                                    |
| Укрепление хоста        | Защита ОС, настройка межсетевых экранов, правил VPC, ограниченных учётных записей |
| Минимизация компонентов | Чем меньше компонентов — тем меньше точек атаки                                   |
| Регулярные обновления   | Частое сканирование и установка патчей для контейнеров и зависимостей             |

### 3.5.15 Виртуализированные системы

**Виртуализированные системы** используются для размещения одной или нескольких операционных систем в памяти одного хост-компьютера или для запуска приложений, несовместимых с операционной системой хоста.

**Обеспечение безопасности виртуализированных систем**:

- Основным компонентом виртуализации является **гипервизор**, который управляет виртуальными машинами (VM), виртуальным хранилищем данных и виртуальными сетевыми компонентами.
- **Гипервизор** представляет собой **дополнительную поверхность атаки**.
- В виртуализированных средах необходимо защищать как **виртуальные машины**, так и **физическую инфраструктуру / гипервизор**.
- **Администраторские учётные записи гипервизора** и **сервисные учётные записи** являются целями атак, поскольку часто предоставляют доступ к виртуальным машинам и их данным; эти учётные записи должны быть защищены.
- **Виртуальные хосты должны быть укреплены**; чтобы защитить хост, избегайте использования его для чего-либо, кроме размещения виртуализированных компонентов.
- Виртуализированные системы должны проходить **тестирование безопасности** через **оценку уязвимостей** и **пентесты**.
- Виртуализация **не снижает требований к управлению безопасностью ОС** — управление патчами по-прежнему необходимо.
- Следует учитывать риски **разрастания виртуальных машин (VM Sprawl)** и **теневой ИТ (Shadow IT)**.
- **Побег из виртуальной машины (VM escape)**: происходит, когда программное обеспечение внутри гостевой ОС способно нарушить защиту изоляции, обеспечиваемую гипервизором.

**Минимизация риска VM escape**:

- Размещайте **высокочувствительные системы и данные на отдельных физических машинах**.
- Поддерживайте **всё программное обеспечение гипервизора в актуальном состоянии**, устанавливая патчи от поставщика.
- **Мониторьте индексы атак, уязвимостей и злоупотреблений** для новых угроз виртуальным машинам (которые могут быть лучше защищены); часто администраторы виртуализации имеют доступ ко всем виртуальным машинам.

## 3.6 — Жизненный цикл криптографических решений (Cryptographic lifecycle):

### 3.6.1 Жизненный цикл криптографических решений (например, управление ключами, выбор алгоритма)
- Учитывайте **закон Мура** (вычислительные возможности современных микропроцессоров удваиваются примерно каждые 2 года) и внедряйте соответствующие **контрольные механизмы управления**, чтобы гарантировать, что выбранные алгоритмы, протоколы и длины ключей будут достаточны для сохранения целостности криптосистемы на необходимый срок — чтобы сохранить секретную информацию в безопасности.
- Укажите **криптографические алгоритмы**, допустимые для использования в организации (например, AES, 3DES и RSA).
- Определите **допустимые длины ключей** для каждого алгоритма в зависимости от **чувствительности передаваемой информации**.
- Перечислите **безопасные протоколы транзакций** (например, TLS), которые могут использоваться.
- По мере роста вычислительной мощности **снижается стойкость криптографических алгоритмов**; учитывайте **эффективный срок действия сертификата или шаблона сертификата**, а также всей криптографической системы.
- TLS использует **временный симметричный сеансовый ключ** между сервером и клиентом, который передаётся с использованием **асимметричной криптографии**; при этом весь контент защищается **симметричной криптографией**.
- Помимо атак методом перебора (brute force), учитывайте такие факторы, как **обнаружение ошибки или проблемы в алгоритме или системе**.

##### Определения NIST, описывающие алгоритмы и длины ключей:
- **approved (утверждённый)** — алгоритм, указанный как рекомендация NIST или FIPS
- **acceptable (приемлемый)** — алгоритм + длина ключа безопасны на сегодняшний день
- **deprecated (устаревающий)** — алгоритм и длина ключа допустимы, но несут определённый риск
- **restricted (ограниченный)** — использование алгоритма и/или длины ключа устарело и должно быть избегаемо
- **legacy (наследуемый)** — алгоритм и/или длина ключа устарели и должны использоваться только при необходимости
- **disallowed (запрещённый)** — алгоритм и/или длина ключа более не разрешены для указанного применения

### 3.6.2 — Криптографические методы

##### Симметричное шифрование

Использует **один и тот же ключ** для шифрования и дешифрования. Симметричное шифрование использует **общий секретный ключ**, доступный всем пользователям криптосистемы. Симметричное шифрование **быстрее**, чем асимметричное, потому что можно использовать **меньшие ключи** для того же уровня защиты. Недостаток в том, что пользователи или системы должны найти способ **безопасно поделиться ключом** и надеяться, что ключ используется **только для указанной коммуникации**. Симметричное шифрование может использовать **потоковые шифры** или **блочные шифры**. В основном применяется для **массового шифрования** и обеспечивает **только услугу конфиденциальности**. «Одинаковый» — синоним симметричного. «Разный» — синоним асимметричного. Общее количество ключей, необходимых для полной связи n сторон с использованием симметричной криптографии, задаётся формулой: **(n(n - 1)) / 2**

##### Типы симметричных шифров:

- **Потоковые шифры** — шифруют данные побитно.
- **Блочные шифры** — шифруют данные блоками фиксированной длины.

##### Симметричные криптосистемы работают в нескольких дискретных режимах:

- **Режим электронной кодовой книги (ECB)**: Самый простой и самый слабый из режимов; каждый блок открытого текста шифруется отдельно, но одинаковым способом. **Преимущества**: быстрый, блоки можно обрабатывать одновременно **Недостатки**: любое повторение открытого текста создаёт одинаковый шифртекст
- **Режим сцепления блоков шифра (CBC)**: Режим блочного шифра, который шифрует открытый текст с использованием операции XOR (исключающее ИЛИ); XOR блока с предыдущим шифртекстом называется «сцеплением». Это означает, что расшифровка блока шифртекста зависит от всех предыдущих блоков. CBC использует **вектор инициализации (IV)** — случайное значение или одноразовый номер, общий для отправителя и получателя. **Преимущества**: сцепление делает дешифровку сложнее; XOR предотвращает одинаковый шифртекст; ошибка в одном бите влияет на текущий и следующий блок **Недостатки**: блоки должны обрабатываться по порядку, не одновременно (медленнее); уязвим к атакам POODLE и GOLDENDOODLE
- **Режим обратной связи шифра (CFB)**: Потоковая версия CBC; использует IV и шифр из предыдущего блока, поэтому ошибки могут распространяться. Главное отличие — шифр из предыдущего блока сначала шифруется, затем XOR'ится с текущим блоком. **Преимущества**: быстрее, чем CBC **Недостатки**: ошибка в одном блоке может перейти в следующий
- **Режим обратной связи вывода (OFB)**: Превращает блочный шифр в синхронный потоковый шифр; на основе IV и ключа генерирует поток ключей, который затем XOR'ится с открытым текстом. Как и в CFB, процессы шифрования и дешифрования идентичны, и **не требуется дополнение (padding)**. **Преимущества**: не нужен уникальный одноразовый номер для каждого сообщения; устойчив к повторным атакам **Недостатки**: нет защиты целостности, уязвим к ошибкам управления IV, возможна ошибка при повреждении блока шифртекста, нет параллельной обработки
- **Режим счётчика (CTR)**: Ключевая особенность — можно параллелить шифрование и дешифрование, не требует сцепления; использует **функцию счётчика** для генерации одноразового номера для каждого блока; номер шифруется и затем XOR'ится с открытым текстом. **Преимущества**: быстрый, считается безопасным **Недостатки**: нет целостности, требуется хеширование
- **Режим Галуа/счётчика (GCM)**: Объединяет режим счётчика (CTR) с аутентификацией Галуа; можно не только шифровать данные, но и **аутентифицировать источник данных** (обеспечивает целостность и конфиденциальность); включает аутентификационные данные и использует хеширование. **Преимущества**: очень быстрый, признан NIST и используется в стандарте IEEE 802.1AE **Недостатки**: в основном связаны со сложностью реализации
- **Режим счётчика с MAC на основе сцепления блоков шифра (CCM)**: Использует режим счётчика, поэтому нет распространения ошибок; нет дублирования, но используется сцепление, поэтому **не может работать параллельно**; MAC (код аутентификации сообщения) обеспечивает аутентификацию и целостность. **Преимущества**: нет распространения ошибок, есть аутентификация и целостность **Недостатки**: не может работать параллельно

##### Примеры симметричных алгоритмов:

`Twofish`, `Serpent`, `AES (Rijndael)`, `Camellia`, `Salsa20`, `ChaCha20`, `Blowfish`, `CAST5`, `Кузнечик`, `RC4/5/6`, `DES`, `3DES`, `Skipjack`, `Safer`, `IDEA`

Наиболее распространённым режимом работы симметричного шифрования сегодня является **GCM (Galois/Counter Mode)**.

##### Почему GCM — самый популярный режим:

- **Обеспечивает одновременно шифрование и аутентификацию** → защищает не только конфиденциальность, но и целостность данных
- **Очень быстрый и эффективный** → хорошо подходит для высоконагруженных систем и сетевых протоколов
- **Поддерживается в стандартах** → используется в TLS 1.2 и 1.3, IEEE 802.1AE (MACsec), IPsec и других
- **Подходит для параллельной обработки** → ускоряет выполнение в многопоточных системах

##### Как работает GCM

[[Режим GCM]]

##### Асимметричное шифрование

Процесс, использующий **разные ключи** для шифрования и дешифрования, при котором **вычислительно невозможно определить ключ дешифрования**, зная ключ шифрования. Асимметричные алгоритмы (также называемые **алгоритмами с открытым ключом**, поскольку один из пары ключей доступен всем) обеспечивают **удобный механизм обмена ключами** и **масштабируются** на большое количество пользователей (решают две основные проблемы симметричных систем). Асимметричные криптосистемы **избегают проблемы передачи общего секретного ключа**, используя пары **открытого и закрытого ключей** для безопасной связи без сложной системы распределения ключей.

- **Открытый ключ** — часть пары, которую можно публиковать
- **Закрытый ключ** — должен оставаться приватным и защищённым
- Безопасность асимметричного шифрования **полностью зависит от защиты закрытого ключа**
- Хотя асимметричное шифрование **медленнее**, оно **лучше подходит для обмена данными между сторонами**
- Обеспечивает **конфиденциальность, аутентификацию и непричастность (non-repudiation)**

##### Использование:

- Чтобы **зашифровать сообщение**: используйте **открытый ключ** получателя
- Чтобы **расшифровать сообщение**: используйте **свой закрытый ключ**

##### Наиболее распространённые асимметричные криптосистемы:

- **RSA (Rivest-Shamir-Adleman)** — основан на факторизации произведения простых чисел
- **Diffie-Hellman** — основан на модульной арифметике
- **ElGamal** — расширение Diffie-Hellman, также использует модульную арифметику
- **ECC (Elliptic Curve Cryptography)** — основан на задаче дискретного логарифма на эллиптических кривых; обеспечивает **большую безопасность при той же длине ключа**

##### Квантовая криптография

- **Квантовые вычисления** — новая и продвинутая технология, способная усилить области ИИ, шифрования, медицины и науки
- Классические вычисления используют **электрические или оптические импульсы**, представляющие 0 и 1
- Квантовые вычисления используют **кубиты**, которые могут представлять **0 и 1 одновременно** и в многомерной форме

##### Квантовое превосходство (Quantum Supremacy)

Способность квантовых компьютеров **легко решать сложные задачи** (например, факторизацию больших чисел и дискретные логарифмы), что делает алгоритмы вроде RSA и Diffie-Hellman **уязвимыми**

##### Постквантовая криптография (Post-Quantum Cryptography, PQC)

- Трудно предсказать, когда квантовые вычисления сделают текущие методы шифрования устаревшими (или уже сделали)

##### Сравнение криптографических методов

| Тип шифрования                 | Ключи                            | Скорость                    | Назначение                                        | Примеры алгоритмов             | Режимы / особенности                                | Примеры использования                         | Уровень стойкости (по NIST)                                             |
| ------------------------------ | -------------------------------- | --------------------------- | ------------------------------------------------- | ------------------------------ | --------------------------------------------------- | --------------------------------------------- | ----------------------------------------------------------------------- |
| **Симметричное**               | Один общий ключ                  | Быстрое                     | Массовое шифрование, конфиденциальность           | AES, ChaCha20, Blowfish        | ECB, CBC, CFB, OFB, CTR, GCM, CCM                   | VPN, TLS-сессии, шифрование дисков            | ✅ **Approved** (AES-256), ⚠️ **Deprecated** (3DES)                      |
| **Асимметричное**              | Пара: открытый + закрытый        | Медленное                   | Обмен ключами, цифровые подписи                   | RSA, Diffie-Hellman, ElGamal   | Использует пары ключей, обеспечивает аутентификацию | SSL/TLS, PGP, цифровые подписи, обмен ключами | ✅ **Approved** (RSA ≥2048), ⚠️ **Restricted** (RSA <1024)               |
| **ECC (эллиптические кривые)** | Пара ключей, как в асимметричном | Быстрое при коротких ключах | То же, что и асимметричное, но с меньшими ключами | ECDSA, ECDH                    | Основано на задаче дискретного логарифма на кривых  | Мобильные устройства, IoT, TLS, блокчейн      | ✅ **Approved** (P-256, P-384), ⚠️ **Acceptable** (нестандартные кривые) |
| **Квантовое**                  | Кубиты, квантовые состояния      | Потенциально сверхбыстрое   | Будущая защита, квантовая коммуникация            | QKD, Lattice-based, Hash-based | Использует принципы квантовой механики              | Постквантовая криптография, защита HDNL       | 🧪 **Experimental**, 🔮 **PQC — в разработке**                          |

### 3.6.3 Инфраструктура открытых ключей (PKI)

**Инфраструктура открытых ключей (PKI)**: иерархия доверительных отношений, позволяющая комбинировать асимметричную и симметричную криптографию вместе с хешированием и цифровыми сертификатами (что даёт нам гибридную криптографию).

PKI выдаёт сертификаты вычислительным устройствам и пользователям, позволяя им применять криптографию (например, для отправки зашифрованных электронных сообщений, шифрования веб-сайтов или использования IPsec для шифрования передачи данных).

Многие поставщики предоставляют услуги PKI; вы можете использовать PKI приватно и исключительно для своей организации, можете получать сертификаты от доверенного стороннего поставщика или делать и то, и другое (что является распространённой практикой).

PKI состоит из:
- **центров сертификации (CA)**: серверов, предоставляющих одну или несколько функций PKI, таких как предоставление политик или выдача сертификатов;
- **сертификатов**: выдаются другим центрам сертификации или устройствам и пользователям;
- **политик и процедур**: например, как обеспечивается безопасность PKI;
- **шаблонов**: предопределённая конфигурация для конкретных целей, например, шаблон веб-сервера.

Центры сертификации создают цифровые сертификаты, содержащие открытые ключи пользователей системы; затем пользователи распространяют эти сертификаты среди тех, с кем хотят общаться; получатели сертификатов проверяют сертификат с помощью открытого ключа CA.

**Квантовое распределение ключей (QKD)**: в то время как традиционные методы безопасного распределения симметричных ключей осуществляются либо через внеполосный канал (некоторый альтернативный безопасный способ связи), либо гибридным методом (например, асимметричными методами, такими как Диффи-Хеллман), потенциально новым способом безопасной связи является использование квантовой механики для обмена ключами шифрования между двумя сторонами, где, согласно принципу неопределённости Гейзенберга, измерение квантового состояния неизбежно нарушает его, а подслушивание QKD будет обнаружено ("безусловная безопасность").

##### Компоненты PKI

|Компонент|Назначение|
|---|---|
|**CA (Certification Authority)**|Центр сертификации, который выпускает и подписывает цифровые сертификаты|
|**Сертификаты**|Документы, содержащие публичный ключ и подтверждение его подлинности|
|**Политики и процедуры**|Определяют, как PKI управляется и защищается|
|**Шаблоны (templates)**|Предустановленные настройки для разных типов сертификатов (например, для веб-серверов)|

##### Уровни (tiers) PKI

|Уровень|Описание|
|---|---|
|**Одноуровневая PKI**|Один сервер выполняет все функции|
|**Двухуровневая PKI**|Корневой CA (offline) + подчинённые CA (выдают сертификаты)|
|**Трёхуровневая PKI**|Добавляется уровень политик (Policy CA), который тоже может быть offline|

Как правило, чем больше уровней — тем выше безопасность (но правильная конфигурация критически важна); чем больше уровней — тем сложнее и дороже построение и поддержка PKI.

PKI должна иметь **политику сертификатов** и **заявление о практике сертификатов (CSP)**:

- **политика сертификатов**: документирует, как ваша организация обрабатывает такие элементы, как идентификация запрашивающих, использование сертификатов и хранение закрытых ключей;
- **CSP**: документирует конфигурацию безопасности вашей PKI и обычно доступен публично.

Помимо выдачи сертификатов, PKI выполняет и другие функции:

- PKI должна предоставлять клиентам информацию об отзыве сертификатов;
    - если администратор отзывает выданный сертификат, клиенты должны иметь возможность получить эту информацию от вашей PKI;
- хранение закрытых ключей и информации о выданных сертификатах (может храниться в базе данных или каталоге);
- PKI использует **LDAP** при интеграции цифровых сертификатов в передачи данных.

### 3.6.4 Практики управления ключами (ротация)

Практики управления ключами: включают меры защиты, связанные с созданием, распространением, хранением, уничтожением, восстановлением и резервным хранением секретных ключей.

Криптография может использоваться как механизм безопасности для обеспечения конфиденциальности, целостности и доступности только в том случае, если ключи **не скомпрометированы**.

Существует три основных метода обмена секретными ключами:
- офлайн-распространение
- шифрование с открытым ключом
- алгоритм обмена ключами Диффи — Хеллмана

Управление ключами может быть сложным при симметричном шифровании, но гораздо проще при асимметричном шифровании.

Существует несколько задач, связанных с управлением ключами:
- Создание ключей
- Распространение ключей: процесс отправки ключа пользователю или системе; он должен быть безопасным и храниться в безопасном виде на вычислительном устройстве Ключи хранятся до и после распространения; при передаче пользователю они не должны «болтаться» на рабочем столе пользователя Ключи не должны быть в открытом виде вне криптографического устройства
- Распространение и обслуживание ключей должно быть автоматизировано (и скрыто от пользователя) Ключи должны быть резервно скопированы!
- Резервное хранение ключей (key escrow): процесс или субъект, способный восстановить потерянные или повреждённые криптографические ключи
	- **Восстановление ключей несколькими участниками**: когда для восстановления или реконструкции ключа требуется два или более субъекта
	- **Контроль `m` из `n`**: вы назначаете группу из (`n`) человек в качестве агентов восстановления, но для восстановления ключа требуется только подгруппа (`m`) из них
	- **Разделённое хранение**: позволяет двум или более людям совместно иметь доступ к ключу (например, каждый из двух человек хранит половину пароля к ключу)
- Ротация ключей: заменяйте ключи (удаляйте старые, внедряйте новые), чтобы снизить риск доступа скомпрометированного ключа
- Состояния ключей:
	- приостановка: временная блокировка
	- отзыв: постоянное аннулирование
	- истечение срока действия
	- уничтожение

### 3.6.5 Цифровые подписи и цифровые сертификаты (например, непричастность, целостность)

**Цифровые подписи**: обеспечивают доказательство того, что сообщение было отправлено конкретным пользователем криптосистемы, и гарантируют, что сообщение не было изменено во время передачи между двумя сторонами.

Цифровые подписи основаны на сочетании двух основных концепций — **криптографии с открытым ключом** и **хеш-функций**.

Cообщения подписанные цифровой подписью убеждают получателя, что сообщение действительно пришло от заявленного отправителя, обеспечивая **неотказуемость** (non-repudiation).

Cообщения подписанные цифровой подписью убеждают получателя, что сообщение не было изменено во время передачи; защищая как от **злонамеренного изменения** (третьей стороной, изменяющей смысл сообщения), так и от **непреднамеренного изменения** (ошибки в процессе передачи).

Процесс цифровой подписи **сам по себе не обеспечивает конфиденциальность** (он гарантирует только целостность, аутентификацию и неотказуемость).

Чтобы подписать сообщение цифровой подписью, сначала используется хеш-функция для создания хэша (дайджеста) сообщения; затем хэш шифруется **вашим закрытым ключом**.

Чтобы проверить цифровую подпись, расшифруйте подпись **открытым ключом отправителя** и сравните хэш сообщения с тем, который вы сгенерировали самостоятельно: если они совпадают — сообщение подлинное.

**FIPS 186-5 Стандарт цифровой подписи (DSS)** — определяет три метода генерации и проверки цифровых подписей, которые могут использоваться для защиты данных:

- Алгоритм Ривеста-Шамира-Адлемана (**RSA**)
- Алгоритм цифровой подписи на эллиптических кривых (**ECDSA**)
- Алгоритм цифровой подписи на кривых Эдвардса (**EdDSA**)

> **Примечание**: Алгоритм цифровой подписи (**DSA**) теперь следует использовать **только для проверки уже существующих подписей**.

### 3.7 Понимание методов криптоаналитических атак

#### 3.7.1 Полный перебор (Brute Force)

Атака, которая перебирает каждую возможную допустимую комбинацию ключа или пароля. 
**Суть:** Использует огромную вычислительную мощность для последовательного угадывания ключа, защищающего криптографическую связь.

#### 3.7.2 Атака только по шифртексту (Ciphertext-only attack)

**Только шифртекст**: атака, при которой у вас есть только зашифрованное сообщение (шифртекст) в распоряжении (без открытого текста). Если у вас достаточно образцов шифртекста, идея заключается в том, что вы можете расшифровать целевой шифртекст, основываясь на этих образцах.

#### 3.7.3 Атака с известным открытым текстом (Known-plaintext attack)

Атака, при которой злоумышленник знает часть открытого текста и соответствующий шифртекст. 
**Суть:** Использует это соответствие для анализа алгоритма и извлечения ключа.

**Известный открытый текст**: при этой атаке злоумышленник имеет копию зашифрованного сообщения вместе с открытым текстом, использованным для создания шифртекста (копии); это знание значительно помогает злоумышленнику во взломе более слабых кодов; цель — использовать открытый текст и связанный с ним шифртекст для вывода ключа шифрования.

**Линейный криптоанализ**: атака с известным открытым текстом, при которой злоумышленник изучает вероятностные линейные зависимости, называемые линейными аппроксимациями, между битами чётности открытого текста, шифртекста и скрытого ключа; считается наиболее эффективной техникой для использования статистических свойств шифртекста с целью нахождения корреляций между открытым текстом и шифртекстом.

#### 3.7.4 Частотный анализ (Frequency analysis)

**Частотный анализ**: атака, при которой используются характеристики языка для взлома шифров подстановки. Например, в английском языке буква "E" — самая распространённая, поэтому наиболее часто встречающаяся буква в зашифрованном шифртексте может быть заменой для "E". Другие примеры могут включать буквы, которые появляются дважды подряд, а также наиболее часто используемые слова в языке.

#### 3.7.5 Выбранный шифртекст (Chosen ciphertext)

**Выбранный шифртекст**: при атаке с выбранным шифртекстом злоумышленник имеет доступ к одному или нескольким открытым текстам, соответствующим произвольно выбранным шифртекстам; то есть злоумышленник способен расшифровывать выбранные части зашифрованного сообщения и использовать расшифрованные фрагменты для обнаружения ключа.

**Атака с выбранным открытым текстом (CPA)**: модель атаки в криптоанализе, при которой предполагается, что злоумышленник может получать шифртексты для произвольно выбранных открытых текстов с целью получения информации, снижающей безопасность схемы шифрования; CPA считается более мощной, чем атака с известным открытым текстом, однако менее мощной, чем атака с выбранным шифртекстом.

**Дифференциальный криптоанализ**: разновидность атаки с выбранным открытым текстом и общая форма криптоанализа, применимая в первую очередь к блочным шифрам, но также к потоковым шифрам и криптографическим хеш-функциям; это исследование того, как различия во входных данных могут повлиять на соответствующие различия на выходе; продвинутые методы, такие как дифференциальный криптоанализ, являются типами атак с выбранным открытым текстом.

**Пример**: злоумышленник может попытаться заставить получателя расшифровать модифицированный шифртекст, рассчитывая на то, что эта модификация вызовет предсказуемое изменение в открытом тексте.

#### 3.7.6 Атаки на реализацию (Implementation attacks)

**Атака на реализацию**: попытка использовать уязвимости в реализации криптографической системы. Сосредоточена на эксплуатации программного кода — не только ошибок или изъянов, но и методологии, применяемой при программировании системы шифрования. В этом типе атаки злоумышленники ищут слабые места в реализации, такие как программные ошибки или устаревшая прошивка.

#### 3.7.7 Атака по боковому каналу (Side-channel)

**Атаки по боковому каналу** стремятся использовать то, как компьютерные системы создают характерные следы активности, такие как изменения в загрузке процессора, потреблении энергии или электромагнитном излучении, чтобы отслеживать активность системы и извлекать информацию, которая в данный момент шифруется.

Подобно атаке на реализацию, атаки по боковому каналу ищут уязвимости **вне** основных криптографических функций.

Атака по боковому каналу может быть направлена на **процессор компьютера**, либо попытаться получить ключевую информацию об окружении во время шифрования или дешифрования, наблюдая за **электромагнитными излучениями** или **временем выполнения** операций дешифровки.

Информация о характеристиках бокового канала часто **комбинируется**, чтобы попытаться разрушить криптографию.

**Пример**: атака по времени (timing attack) — это разновидность атаки по боковому каналу.

#### 3.7.8 Инъекция ошибок (Fault-Injection)

**Инъекция ошибок**: злоумышленник пытается нарушить целостность криптографического устройства, вызывая какой-либо внешний сбой. Например, использование высоковольтного электричества, высокой или низкой температуры или других факторов для создания сбоя, который подрывает безопасность устройства.

#### 3.7.9 Атака по времени (Timing)

**Атака по времени**: атака по времени является примером атаки по боковому каналу, при которой злоумышленник точно измеряет, сколько времени занимают криптографические операции, получая информацию о криптографическом процессе, которая может быть использована для подрыва его безопасности.

#### 3.7.10 Атака «человек посередине» (Man-in-the-middle, MITM)

**Атака «человек посередине» (MITM)** (также известна как on-path или Adversary-in-the-middle, AitM): при этой атаке злоумышленник размещается между двумя сторонами, ведущими коммуникацию, и перехватывает все сообщения (включая установку криптографической сессии).

Злоумышленник отвечает на запросы инициализации от отправителя и устанавливает защищённую сессию с ним.

Затем злоумышленник устанавливает вторую защищённую сессию с предполагаемым получателем, используя другой ключ и выдавая себя за отправителя.

Таким образом, злоумышленник может «сидеть посередине» коммуникации и читать весь трафик, проходящий между двумя сторонами.

#### 3.7.11 Передача хеша (Pass the hash, PtH)

**Передача хеша (PtH)**: техника, при которой злоумышленник захватывает хеш пароля (а не сами символы пароля) и просто передаёт его для аутентификации и потенциального бокового перемещения по другим сетевым системам.

Злоумышленнику **не нужно расшифровывать хеш**, чтобы получить пароль в открытом виде.

Атаки PtH **эксплуатируют протокол аутентификации**, поскольку хеш пароля остаётся **статичным** для каждой сессии до тех пор, пока пароль не будет изменён.

Злоумышленники обычно получают хеши, **сканируя активную память системы** и используя другие техники.

Атаки PtH, как правило, **эксплуатируют уязвимости NTLM**, но злоумышленники также применяют аналогичные атаки против других протоколов, включая **Kerberos**.

#### 3.7.12 Вымогательское ПО (Ransomware)

**Вымогательское ПО (Ransomware)** — это тип вредоносного программного обеспечения, использующего криптографию как оружие. Используя многие из тех же методов, что и другие типы вредоносного ПО, вымогательское ПО генерирует ключ шифрования и шифрует критически важные файлы. Это шифрование делает данные недоступными для авторизованного пользователя или кого-либо ещё, кроме автора вредоносного ПО. Часто угрожает публичным раскрытием конфиденциальных данных, если выкуп не будет уплачен. Согласно исследованию 2020 года, 56% организаций подверглись атаке вымогательского ПО, 27% из тех, кто сообщил об атаке, решили заплатить, в среднем около $1.1 млн. Перед взаимодействием с авторами вымогательского ПО рекомендуется получить юридическую консультацию.

### 3.9 Проектирование мер безопасности объектов и помещений

Физическая безопасность помещений, где размещается сетевое оборудование — таких как шкафы коммутации или IDF (intermediate distribution frame). Это небольшие технические комнаты, в которых соединяются кабели здания с сетевыми устройствами: коммутаторами, маршрутизаторами, точками доступа, патч-панелями и иногда серверами.

**Что важно:**
- Доступ в такие помещения должен быть строго ограничен — только для сотрудников, отвечающих за ИТ-оборудование.  
- На двери должен быть электронный замок или система пропусков.
- Эти комнаты должны находиться в закрытых, непубличных зонах здания — чтобы попасть внутрь, человек должен пройти через ресепшен и контролируемую дверь.

Цель — защитить критичную инфраструктуру от несанкционированного доступа, случайных повреждений и потенциальных угроз безопасности.

##### Основные требования ФСТЭК к физической защите помещений (IDF/MDF)

1. **Контроль доступа**
	- Доступ только для уполномоченного персонала.  
	- Использование электронных систем контроля доступа (СКУД): пропускные системы, кодовые замки, биометрия.
	- Ведение журнала входов/выходов, хранение логов не менее 1 года.

2. **Расположение и планировка**
	- Помещение должно находиться в охраняемой зоне, изолированной от общего доступа.
	- Доступ к нему — через контролируемые точки (ресепшен, охрана).
	- Стены, потолок, двери — из материалов, препятствующих утечке речевой информации (при необходимости).

3. **Средства охраны**
	- Видеонаблюдение с записью и хранением данных.
	- Охранная сигнализация, реагирующая на вскрытие, движение, пожар.
	- Интеграция с системой мониторинга безопасности.

4. **Инженерные системы**
	- Резервное питание (ИБП) для критичного оборудования.
	- Контроль микроклимата: датчики температуры, влажности, оповещение при отклонениях.
	- Защита от затопления, пожара, электроперегрузок.

5. **Организация пространства**
	- Кабель-менеджмент: маркировка, аккуратная укладка, доступность для обслуживания.
	- Разделение зон: телекоммуникационная, серверная, электротехническая.
	- Хранение документации и инструментов — в закрытых шкафах.

6. **Документация и регламенты**
	- Утверждённый список сотрудников с доступом.
	- Регламент допуска подрядчиков и гостей (сопровождение, временные пропуска).
	- План действий при ЧС, эвакуации, инцидентах.
	- График проверок, обслуживания, тестов восстановления.

#### Что такое серверные помещения и дата-центры

Серверные комнаты, дата-центры, коммуникационные помещения, серверные хранилища и ИТ-шкафы — это закрытые, ограниченные и защищённые зоны, где размещаются критически важные серверы и сетевое оборудование. Они обеспечивают стабильную работу всей ИТ-инфраструктуры организации.

##### Различия между серверной и дата-центром

- **Серверная комната** — это более крупная версия шкафов коммутации (IDF), но **меньше, чем полноценный дата-центр**.
- Обычно содержит:
    - Сетевое оборудование (коммутаторы, маршрутизаторы)
    - Серверы
    - Системы резервного копирования
    - Иногда — устаревшее телекоммуникационное оборудование

##### Требования к безопасности и размещению

- Серверные должны быть **спроектированы так**, чтобы:
    - Обеспечивать оптимальные условия для работы оборудования
    - Исключать несанкционированный доступ или вмешательство
- **Расположение**:
    - В центральной части здания
    - Не на первом, последнем или подвальном этажах — это снижает риски затопления, взлома и перегрева
- **Входы**:
    - Один основной вход
    - Один аварийный выход
    - Все входы и выходы должны **логироваться** (записываться)
- **Контроль доступа**:
    - Только для уполномоченного персонала
    - Использование электронных замков, пропусков, биометрии

##### Дата-центры — более защищённые объекты

- В отличие от серверных, дата-центры могут включать:
    - Физическую охрану
    - Системы двойного контроля доступа (mantraps — шлюзы, где человек проходит поэтапную проверку)
- Бывают:
    - **Одноарендные** (single-tenant) — для одной организации
    - **Многоарендные** (multi-tenant) — для нескольких клиентов

#### Хранилища носителей информации

**Хранилища носителей информации** Хранилища носителей информации: часто используются для хранения резервных копий на лентах/дисках, новых, многоразовых и других носителей, и должны защищаться так же, как серверные помещения. В зависимости от требований может быть достаточно шкафа или сейфа. Новые чистые носители, а также носители, используемые повторно (например, USB-накопители, карты флэш-памяти, переносные жёсткие диски), должны быть защищены от кражи и восстановления остаточных данных. Возможные угрозы включают: кражу, повреждение, восстановление остаточных данных.

**Другие рекомендации:**
- Назначить ответственного сотрудника — библиотекаря или хранителя носителей.
- Использовать процесс регистрации/выдачи для отслеживания носителей
- Выполнять безопасную очистку накопителей или «обнуление» при возврате носителя
- Использовать надёжные методы очистки данных перед повторным использованием носителя.

**Примечание:** Сейф — это перемещаемый защищённый контейнер, не встроенный в конструкцию здания; Хранилище (vault) — это стационарный сейф, встроенный в конструкцию здания.

#### Ограниченные и рабочие зоны

**Ограниченные и рабочие зоны** — это участки внутри организации, где важно обеспечить повышенную безопасность. Они включают:

- **Зоны с ценными или важными активами**, например, оборудование, данные или системы, которые требуют ограниченного доступа.
- **Ограниченные рабочие зоны**, где проводятся чувствительные операции — например, управление сетью или кибербезопасностью.
- **Видеонаблюдение** обычно устанавливается только на входах и выходах, а не по всей комнате.
- **Уровень защиты** должен быть сопоставим с серверной или хранилищем носителей — то есть с контролем доступа, физической охраной и другими мерами.

Такие зоны проектируются так, чтобы сотрудники и посетители находились в безопасной среде, а доступ к критически важным ресурсам был строго контролируемым

#### Коммунальные системы и системы отопления, вентиляции и кондиционирования воздуха (HVAC)

Управление электропитанием по возрастанию: сетевые фильтры, стабилизатор/фильтр электропитания, источник бесперебойного питания (ИБП), генераторы.

**Типы ИБП:**
- **Двойное преобразование:** работает, получая питание от розетки, накапливая его в аккумуляторе, извлекая питание из аккумулятора и подавая его на устройство/устройства.
- **Линейно-интерактивный:** имеет сетевой фильтр, зарядное устройство/инвертор и регулятор напряжения, расположенные между источником питания от сети и оборудованием (аккумулятор не задействован при нормальных условиях).

**Типы проблем с коммерческим электропитанием:**
- **Сбой (fault):** кратковременное отключение питания
- **Отключение (blackout):** полная потеря питания
- **Провал (sag):** кратковременное понижение напряжения
- **Пониженное напряжение (brownout):** длительное понижение напряжения
- **Импульс (spike):** кратковременное повышение напряжения
- **Перенапряжение (surge):** длительное повышение напряжения
- **Пусковой ток (inrush):** начальный скачок тока, связанный с подключением к источнику питания

**Продумайте типы физических мер контроля для HVAC:**
- ограничьте непрерывность вентиляционных каналов только контролируемыми зонами
- используйте отдельные и резервные системы HVAC для компьютерного оборудования

**Помещения, содержащие в основном компьютеры, должны иметь:**
- температуру от 59 до 89,6 градусов по Фаренгейту (15 до 32 градусов по Цельсию)
- влажность в пределах от 20 до 80 процентов

Обратите внимание, что даже на антистатическом ковровом покрытии при низкой влажности возможен статический разряд в 20 000 вольт; и даже минимальные уровни статического электричества могут повредить электронное оборудование.

**Дата-центр:**
- должен быть подключён к другим электрическим цепям, чем зоны с персоналом
- обычно используется резервный генератор

### 4. Применение принципов безопасного проектирования в сетевых архитектурах (OSG-10, главы 11 и 12)

**4.1.1 Модели OSI и TCP/IP**

**TCP/IP**: также известна как модель DARPA или модель Министерства обороны США (DOD), включает четыре уровня:

- **Прикладной уровень** (уровень процессов),
- **Транспортный уровень** (уровень взаимодействия между хостами),
- **Интернет-уровень** (уровень межсетевого взаимодействия),
- **Канальный уровень** (уровень сетевого интерфейса или доступа к сети).

**OSI**: Эталонная модель взаимодействия открытых систем (Open Systems Interconnection, OSI), разработанная Международной организацией по стандартизации (ISO) для создания общей структуры или стандарта связи для всех компьютерных систем; представляет собой абстрактную структуру.

- Связь между уровнями осуществляется через **инкапсуляцию** (на каждом уровне заголовок и полезная нагрузка предыдущего уровня становятся полезной нагрузкой текущего уровня) и **деинкапсуляцию** (обратное действие, происходящее при движении данных вверх по уровням)

Сопоставление уровней моделей OSI и TCP/IP

| Уровень | Модель OSI                      | Модель TCP/IP                           | PDU (единица данных)              | Устройства                                                                     | Протоколы                                                                                                                                                           |
| ------- | ------------------------------- | --------------------------------------- | --------------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 7       | Прикладной (Application)        | Прикладной (Application)                | Данные                            | Межсетевой экран приложений                                                    | HTTP/s, DNS, DHCP, FTP, LPD, S-HTTP, TPFT, Telnet, SSH, SMTP, POP3, PEM, IMAP, NTP, SNMP, TLS/SSL, GBP, SIP, S/MIME, X Window, NFS и др.                            |
| 6       | Представительный (Presentation) | Прикладной (Application)                | Данные                            | —                                                                              | JPEG, ASCII, MIDI и др.                                                                                                                                             |
| 5       | Сеансовый (Session)             | Прикладной (Application)                | Данные                            | Прокси-сервер, межсетевой экран                                                | NetBIOS, RPC                                                                                                                                                        |
| 4       | Транспортный (Transport)        | Транспортный (Transport / Host-to-Host) | Сегменты (TCP) / Датаграммы (UDP) | —                                                                              | TCP (с установлением соединения), UDP (без установления соединения), TLS, BGP                                                                                       |
| 3       | Сетевой (Network)               | Интернет (Internet/IP)                  | Пакеты                            | Маршрутизатор, многослойный коммутатор, межсетевой экран с фильтрацией пакетов | IPv4, IPv6, IPSec, OSPF, EIGRP, ICMP, IGMP, RIP, NAT                                                                                                                |
| 2       | Канальный (Data Link)           | Сетевой доступ (Network Access / Link)  | Кадры                             | Коммутатор, мост, сетевой адаптер (NIC), точка доступа Wi-Fi                   | MAC, ARP, Ethernet 802.3 (проводной), CDP, LLDP, HDLC, PPP, PPTP, DSL, L2TP, IEEE 802.11 (беспроводной), SONET/SDH, VLAN, протоколы аутентификации (PAP, CHAP, EAP) |
| 1       | Физический (Physical)           | Сетевой доступ (Network Access / Link)  | Биты                              | Хабы, репитеры, концентраторы                                                  | Электрический сигнал (медный кабель), световой сигнал (оптоволокно), радиосигнал (воздух)                                                                           |

##### Уровень 7: Прикладной (Application Layer)

**Отвечает за:**
- взаимодействие пользовательских приложений, сетевых служб или операционной системы с стеком протоколов
- идентификацию и установление доступности партнёров по связи
- определение доступности ресурсов
- синхронизацию связи

**Использует**: потоки данных **Протоколы**: HTTP/S, DNS, DHCP, FTP, LPD, S-HTTP, TPFT, Telnet, SSH, SMTP, POP3, PEM, IMAP, NTP, SNMP, TLS/SSL, GBP, SIP, S/MIME, X Window, NFS и др. **Пример**: SIP — сигнальный протокол для установления, поддержки, изменения и завершения сеансов связи в реальном времени между IP-устройствами (например, голосовые и видеозвонки)

##### Уровень 6: Представительный (Presentation Layer)

**Отвечает за:**
- преобразование данных в формат, понятный любой системе, использующей модель OSI

**Связанные задачи:**
- представление данных
- преобразование символов
- сжатие данных
- шифрование данных

**Использует**: потоки данных **Примеры форматов**: JPEG, ASCII, MIDI и др.

##### Уровень 5: Сеансовый (Session Layer)

**Отвечает за:**
- установление, поддержание и завершение сеансов связи между двумя компьютерами

**Три фазы сеанса связи:**
- установление соединения
    - **Simplex**: односторонняя передача
    - **Half-duplex**: двусторонняя передача, но не одновременно
    - **Full-duplex**: двусторонняя передача одновременно
- передача данных
- завершение соединения

**Использует**: потоки данных **Протоколы**: NetBIOS, RPC

##### Уровень 4: Транспортный (Transport Layer)

**Отвечает за:**
- управление целостностью соединения и контроль сеанса
- прозрачную передачу данных и контроль передачи от конца до конца

**Определяет правила сеанса**, такие как:
- объём данных в сегменте
- проверка целостности сообщения
- определение потерь данных

**Протоколы:**
- **TCP**: надёжный, ориентированный на соединение, full-duplex; использует трёхэтапное рукопожатие: SYN → SYN-ACK → ACK
    - Флаги TCP: URG, ACK, PSH, RST, SYN, FIN (мнемоника: Unskilled Attackers Pester Real Security Folks)
    - Заголовок TCP: 10 полей, 160 бит (порт источника, порт назначения, номер последовательности, номер подтверждения, контрольная сумма и др.)
- **UDP**: без соединения, быстрая передача, best-effort
    - Заголовок UDP: 4 поля, 64 бита (порт источника, порт назначения, длина данных, контрольная сумма)
- **TLS**: работает на уровнях 4–7 в OSI, но только на уровне Transport в TCP/IP
- **BGP**: протокол обмена маршрутной информацией между маршрутизаторами

**Процессы**: сегментация, упорядочивание, проверка ошибок

##### Уровень 3: Сетевой (Network Layer)

**Отвечает за:**
- логическую адресацию
- маршрутизацию и направление доставки
- обнаружение ошибок и управление трафиком

**Протоколы:**

- **ICMP**: отправка сообщений об ошибках и управления; используется в Ping и Traceroute
- **IGMP**: управление группами multicast
- **Маршрутизация**:
    - **RIP**: протокол маршрутизации по количеству переходов (hop count)
    - **IGRP**: устаревший, проприетарный
    - **EIGRP**: улучшенный IGRP
    - **OSPF**: маршрутизация по кратчайшему пути
    - **IS-IS**: протокол маршрутизации
    - **BGP**: внешний протокол маршрутизации (path vector)

**Типы маршрутизации:**
- **Статическая**: администратор вручную задаёт маршруты
- **Динамическая**: маршруты определяются автоматически
- **Внутренняя (interior)**: принимает решения на основе ближайшего перехода
- **Внешняя (exterior)**: принимает решения на основе всей оставшейся траектории

**Протоколы маршрутизируемые**: IPX, IP **Единица данных**: пакеты

##### Уровень 2: Канальный (Data Link Layer)

**Отвечает за:**
- форматирование пакета для передачи
- добавление MAC-адресов источника и назначения

**MAC-адрес**: 6 байт (48 бит), шестнадцатеричный формат
- Первые 3 байта: OUI (идентификатор производителя)
- Последние 3 байта: уникальны для интерфейса

**Устройства**: коммутаторы, мосты, сетевые карты, точки доступа **Протоколы**: ARP, PPP, PPTP, L2TP, 802.1x, RARP, LLC, L2F **Единица данных**: кадры

##### Уровень 1: Физический (Physical Layer)

**Отвечает за:**
- преобразование кадра в биты для передачи по физической среде

**Устройства**: сетевые карты, хабы, повторители, концентраторы, усилители **Типы сигналов**:
- Электрический (медный кабель)
- Световой (оптоволокно)
- Радио (эфир)

**Топологии сети**:
- **Звезда**: все узлы подключены к одному концентратору
- **Сетка**: все узлы соединены между собой
- **Кольцо**: замкнутая петля, данные идут по кругу
- **Шина**: все устройства подключены к одному кабелю

**Кабели**: витая пара, коаксиальный, оптоволокно **Протоколы**: 802.11 (a/b/g/n/ac/ax — беспроводные сети)

#### 4.1.2 Протокол Интернета (IP) версии 4 и 6 (IPv6) (например: unicast, broadcast, multicast, anycast)

- IP является частью набора протоколов TCP/IP (Протокол управления передачей / Протокол Интернета).
- TCP/IP — это название четырёхуровневой сетевой модели IETF и её стека протоколов; четыре уровня:
    - Канальный (link) — физический
    - Интернет (internet) — сеть к сети
    - Транспортный (transport) — каналы для соединённой/несоединённой передачи данных
    - Прикладной (application) — где приложения используют сетевые службы
- IP обеспечивает основу для того, чтобы другие протоколы могли взаимодействовать; сам IP — это протокол без установления соединения.
- IPv4: доминирующий протокол, работающий на уровне 3; IP отвечает за адресацию пакетов, используя 32-битные адреса.
- IPv6: модернизация IPv4, использует 128-битные (16-байтовые) адреса, поддерживает 2^128 общих адресов; делает IPSec обязательным.
- TCP или UDP используется для связи через IP.
- IP-субсетизация: метод, используемый для деления большой сети на меньшие, управляемые части, называемые подсетями.
- IP-адреса: как адрес улицы, который идентифицирует устройство в сети в двух частях:
    - сеть: определяет «район» или сеть устройства
    - хост: указывает устройство («дом») в этом районе
- маска подсети: инструмент для деления IP-адреса на его сетевую и хостовую части; например, 192.168.1.15 с маской подсети 255.255.255.0 говорит нам, что 192.168.1 — это сеть, а 15 — это хост или часть устройства.