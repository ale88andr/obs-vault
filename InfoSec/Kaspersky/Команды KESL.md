
Просмотр информации о работе приложения в командной строке

```shell
kesl-control --app-info [--json]
```

## Лицензии и ключи

###### Просмотр инфоfdewрмации о лицензии и ключе

```shell
kesl-control -L --query [--json]
```

##### Управление лицензионными ключами

```shell
kesl-control [-L] --add-active-key <путь к файлу ключа/код активации>
```

где: 
- путь к файлу ключа – путь к файлу ключа. Если файл ключа находится в текущей директории, достаточно указать только имя файла. 
- код активации – код активации.

##### Добавить в приложение резервный лицензионный ключ

```shell
kesl-control [-L] --add-reserve-key <путь к файлу ключа/код активации>
```

##### Удалить активный ключ приложения

```shell
kesl-control [-L] --remove-active-key
```

##### Удалить резервный ключ приложения

```shell
kesl-control [-L] --remove-reserve-key
```


## Задачи

Просмотр всех задач

```shell
kesl-control --get-task-list
```

## Обновление баз и модулей приложения

Директория `kesl` c обновлениями

```
/var/opt/kaspersky/kesl/common/updates
```

##### Запустить задачу

```shell
kesl-control --start-task < идентификатор/имя задачи > [-W] [--progress]
```

где: 
- `< идентификатор/имя задачи >` – идентификатор, присвоенный задаче в момент создания, или имя задачи в командной строке. 
- `[-W]` – используйте эту команду совместно с командой запуска задачи, если вы хотите включить вывод текущих событий, связанных с этой задачей. 
- `[--progress]` – укажите этот ключ, если вы хотите отображать ход выполнения задачи.

Запустить задачу с идентификатором 1 и включить вывод текущих событий, связанных с задачей: 

```shell
kesl-control --start-task 1 -W
```

##### Остановить задачу

```shell
kesl-control --stop-task < идентификатор/имя задачи > [-W] [--progress]
```

##### Приостановить задачу

```shell
kesl-control --suspend-task < идентификатор/имя задачи >
```

##### Возобновить задачу

```shell
kesl-control --resume-task < идентификатор/имя задачи >
```

##### Удаление задачи

```shell
kesl-control --delete-task < идентификатор/имя задачи >
```

##### Вывод параметров задачи

```shell
kesl-control --get-settings < идентификатор/имя задачи > [--json]
```

##### Изменение параметров задачи

```shell
kesl-control --set-settings
```

##### Изменение параметров задачи с помощью конфигурационного файла

```shell
kesl-control --set-settings < идентификатор/имя задачи > --file < путь к конфигурационному файлу >
```

```shell
kesl-control --set-settings < идентификатор/имя задачи > < имя параметра >=< значение параметра > [< имя параметра >=< значение параметра >]
```

## Вывод общих параметров приложения

```shell
kesl-control --get-app-settings [--json]
```

- `--file < путь к конфигурационному файлу >` – путь к конфигурационному файлу, в который будут выведены общие параметры приложения. Если вы укажете имя файла без пути, файл будет создан в текущей директории. Если файл существует по указанному пути, он будет перезаписан. Если указанной директории не существует, конфигурационный файл не будет создан. 
- `--json` – выводить параметры в формате JSON. Если вы не укажете ключ `--json`, параметры будут выведены в формате `INI`

Изменение общих параметров приложения

```shell
kesl-control --set-app-settings
```

```shell
kesl-control --set-app-settings --file < путь к конфигурационному файлу > [--json]
```

```shell
kesl-control --set-app-settings < имя параметра >=< значение параметра > [< имя параметра >=< значение параметра >]
```

Примеры: 

Импортировать в приложение общие параметры из конфигурационного файла /home/test/kesl_config.ini: 

```shell
kesl-control --set-app-settings --file /home/test/kesl_config.ini 
```

Установить низкий уровень детализации файла трассировки: 

```shell
kesl-control --set-app-settings TraceLevel=NotDetailed
```

## Экспорт и импорт параметров приложения

```shell
kesl-control --export-settings --file < путь к конфигурационному файлу > [--json]
```

```shell
kesl-control --import-settings --file < путь к конфигурационному файлу > [--json]
```

## Просмотр списка пользователей и ролей

```shell
kesl-control [-U] --get-user-list
```

## Назначение роли пользователю

```shell
kesl-control [-U] --grant-role < роль > < пользователь >
```

Назначить роль audit пользователю test15: 

```shell
kesl-control --grant-role audit test15
```

## Запуск и остановка приложения

##### Запустить приложение

```shell
systemctl start kesl
```

##### Остановить приложение

```shell
systemctl stop kesl
```

##### Перезапустить приложение

```shell
systemctl restart kesl
```

##### Вывести статус приложения

```shell
systemctl status kesl
```

## Поиск вредоносного ПО

##### Выборочная проверка

```shell
kesl-control --scan-file < путь > [--action < действие >]
```

- `< путь >` – путь к файлу или директории, которые вы хотите проверить. Вы можете указать несколько путей, разделяя их пробелами. 
- `--action < действие >` – действие, которое приложение будет выполнять над зараженными объектами. Возможные значения: `Disinfect`, `Removed`, `Recommended`, `Skip`. Если вы не укажете ключ `--action`, приложение будет выполнять действие `Recommended`.

## Установка и удаление приложения

Инсталляционные пакеты kaspersky: https://www.kaspersky.ru/small-to-medium-business-security/downloads/endpoint?utm_content=downloads

##### Удаление приложения и графический пользовательский интерфейс
.deb

```shell
apt-get purge kesl kesl-gui klnagent64
```

.rpm

```shell
rpm -e kesl kesl-gui klnagent64
```

##### Установка агента администрирования

```shell
apt-get install ./klnagent64_<`номер сборки`>_amd64.deb
```

Настройка агента администрирования

```shell
/opt/kaspersky/klnagent64/lib/bin/setup/postinstall.pl
```

##### Установка kesl

1. Установите пакеты kesl и kesl-gui с помощью командной строки. Установить пакет kesl-gui можно только после установки пакета kesl.

```shell
apt-get install ./kesl_12.0-<`номер сборки`>_amd64.deb
apt-get install ./kesl-gui_12.0-<`номер сборки`>_amd64.deb
```

2. Запустите [скрипт первоначальной настройки приложения](https://support.kaspersky.com/KES4Linux/12.0.0/ru-RU/197897.htm "Первоначальная настройка приложения"). Обратите внимание на следующие шаги работы скрипта:
    - [Настройка параметров прокси-сервера](https://support.kaspersky.com/KES4Linux/12.0.0/ru-RU/197905.htm "Настройка параметров прокси-сервера").  
        Необходима, если устройство выходит в интернет через прокси-сервер. KESL использует прокси-сервер, чтобы получать обновления антивирусных баз с публичных серверов «‎Лаборатории Касперского», а также для активации приложения с помощью кода активации.
    - [Обновление баз приложения](https://support.kaspersky.com/KES4Linux/12.0.0/ru-RU/197906.htm "Запуск обновления баз приложения").  
        Пакет установки KESL не содержит антивирусные базы, поэтому их нужно обновить перед использованием приложения. Без антивирусных баз приложение неработоспособно.  
        Вы можете обновить базы после первоначальной настройки: запустите задачу Обновление по [инструкции](https://support.kaspersky.com/KES4Linux/12.0.0/ru-RU/197953.htm "Запуск и остановка задачи").
    - [Активация приложения](https://support.kaspersky.com/KES4Linux/12.0.0/ru-RU/197908.htm "Активация приложения").  
        Активируйте приложение с помощью [кода активации](https://support.kaspersky.com/KES4Linux/12.0.0/ru-RU/69430.htm "О коде активации") или [файла ключа](https://support.kaspersky.com/KES4Linux/12.0.0/ru-RU/69431.htm "О файле ключа"). При активации кодом приложению понадобится доступ в интернет для подключения к серверам активации «‎Лаборатории Касперского».

скрипт первоначальной настройки в интерактивном режиме

```shell
/opt/kaspersky/kesl/bin/kesl-setup.pl
```

скрипт первоначальной настройки в автоматическом режиме

```shell
/opt/kaspersky/kesl/bin/kesl-setup.pl --autoinstall=<`конфигурационный файл первоначальной настройки`>
```

3. Проверьте состояние KESL с помощью команды

```shell
kesl-control --app-info
```

4. Убедитесь, что:
    1. В информации о лицензии указано «‎Ключ действителен».
    2. В дате последнего выпуска баз приложения указана актуальная дата.
    3. Функциональность, которую вы планируете использовать, доступна. Некоторые задачи могут быть недоступны из-за ограничений лицензии.

Вы можете запустить скрипт еще раз и настроить KESL заново.
