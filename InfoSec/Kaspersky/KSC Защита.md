### 1. Как вредоносные программы попадают на компьютер

#### 1.1 Через браузер:
- Загрузка с диска (без согласия пользователя)
- За счет обмана пользователя

###### Уязвимый веб-браузер

У пользователя установлен уязвимый браузер. Используя уязвимость, веб-страница может заставить браузер загрузить и запустить на компьютере любую программу. Пользователь заходит на сомнительный веб-сайт — веб-сайт запускает на компьютере пользователя вредоносную программу. Вредоносный код может быть не на основных страницах веб-сайта, а в рекламных блоках, которые веб-сайт получает с других ресурсов.

**Чтобы защититься от такой атаки**:
- Устанавливайте обновления для веб-браузеров
- Не давайте пользователям запускать какие угодно браузеры
- Не давайте пользователям заходить на какие угодно веб-страницы
- Не давайте пользователям заходить известные зараженные сайты
- Не давайте веб-браузерам запускать дочерние процессы

###### Зараженный файл

Пользователь ищет в Интернете бесплатную программу. Например, бесплатную утилиту, которая делает что-то полезное для пользователя, или пиратскую версию платной программы, или генератор ключей для платной программы. Находит, загружает на компьютер и запускает.
Программа оказывается вредоносной. Может быть пользователь не разобрался и загрузил файл с подходящим названием с «интернет -помойки». Может быть злоумышленники подменили код у бесплатной программы или взломали страницу загрузки и подменили программу.

**Чтобы защититься от такой атаки**:
- Не давайте пользователям заходить на какие угодно веб-страницы
- Не давайте пользователям заходить известные сайты с вредоносными программами
- Проверяйте файлы, которые пользователь загружает из Интернет, средством защиты от угроз

#### 1.2 Через почту:
- Во вложении пользователь сам запускает
- Ссыпки в тепе письма на вредоносные веб-сайты

Пользователь получает по почте письмо, которое выглядит как письмо из банка, магазина, службы доставки, от партнера, знакомого и т.п. Текст письма просит перейти по ссылке или открыть вложение. По ссылке находится вредоносный или фишинговый веб-сайт. Во вложении — вредоносная программа или документ с вложенной вредоносной программой.

**Чтобы защититься от такой атаки**:
- Фильтруйте почту средствами защиты от спама (массовых анонимных рассылок)
- Проверяйте файлы, вложенные в электронные письма, средством защиты от угроз
- Не давайте пользователям сохранять на диск исполняемые файлы из электронных писем
- От ссылок в письмах защищайтесь как от атак через веб-браузер

#### 1.3 Через сменные носители
- Которые пользователь принес из дома или нашел на парковке

###### Своя «флешка»

Пользователь подключил к компьютеру флешку, скопировать на нее или с нее документы. На флешке есть вредоносная программа, которая использовала уязвимость в операционной системе, чтобы автоматически запуститься на компьютере. Либо пользователь подключил флешку, чтобы посмотреть, что на ней. Обнаружил документ или исполняемый файл с интригующим названием и решил открыть его. Файл оказался зараженным.

**Чтобы защититься от такой атаки**:
- Не разрешайте пользователям подключать к компьютеру неизвестные (или все) флешки — Проверяйте файлы на флешках средством защиты от угроз
- Устанавливайте обновления безопасности для операционной системы

###### BadUSB

Пользователь подключил к компьютеру USB-устройство, которое выглядит как флешка. Устройство зарегистрировалось в операционной системе как флешка, и как клавиатура. Через некоторое время устройство начало давать компьютеру команды, посылая сигналы нажатия клавиш.

**Чтобы защититься от такой атаки**, используйте средства защиты от атак BadUSB

#### 1.4 С других зараженных компьютеров по сети
- Пользователь сам копирует файл из общей палки
- Вредоносные программы атакуют уязвимые службы и программы на компьютере пользователя

###### Из общей папки

Пользователь скопировал из общей папки на другом компьютере программу и запустил ее. Программа оказалась вредоносной. Пользователь открыл документ из общей папки на другом компьютере. В документе был вредоносный код.

**Чтобы защититься от такой атаки**:
- Установите средства защиты на все компьютеры
- Проверяйте файлы, которые пользователи копируют, открывают или запускают

###### Атака по сети

В операционной системе на компьютере пользователя есть уязвимость. Если послать на определенный порт специальную последовательность пакетов, можно заставить уязвимую службу выполнить код, который содержится в этих пакетах. Зараженный компьютер в сети атакует уязвимую службу на всех окрестных компьютерах и заражает их.

**Чтобы защититься от такой атаки**:
- Устанавливайте обновления безопасности для операционной системы
- Запрещайте соединения с портами, которые не нужны для работы пользователя
- Проверяйте пакеты, которые принимает компьютер, на предмет сетевых атак средством защиты от угроз

### 2. Как вредоносные программы наносят вред

#### 2.1. Вымогатели

Вредоносная программа вымогатель шифрует документы и другие файлы на компьютере и в общих папках, и просит деньги за то, чтобы дать ключ шифрования. Ключ хранится на сервере злоумышленников. Вредоносная программа или загружает ключ с сервера, шифрует файлы и удаляет ключ; или формирует случайный ключ, посылает его на сервер, шифрует файлы и ключ удаляет. В любом случае программа-вымогатель связывается со своим сервером по сети.

**Чтобы защититься от такой атаки**:
- Регулярно делайте резервные копии всех важных файлов
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения 
- Используйте средства защиты, которые эвристически обнаруживают шифрование

#### 2.2. Шпионы

Вредоносная программа ищет незашифрованные или слабо зашифрованные пароли в настройках программ и в файлах на диске. Вредоносная программа перехватывает все, что вводит пользователь с клавиатуры, делает скриншоты экрана и снимки через веб-камеру. Все это программа оправляет на сервер злоумышленникам.

**Чтобы защититься от такой атаки**:
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения
- Используйте средства защиты, которые эвристически обнаруживают шпионские действия

#### 2.3. Сетевые вредоносные программы

Вредоносная программа записывает себя на подключенные к компьютеру флешки и в общие папки по сети. Вредоносная программа заражает соседние компьютеры через уязвимые службы. Вредоносная программа по команде из центра рассылает спам и участвует в DDOS-атаках.

**Чтобы защититься от такой атаки**:
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения
- Используйте средства защиты, которые эвристически обнаруживают опасные действия

#### 2.4. Загрузчики

Часто, чтобы заразить обойти средства защиты и заразить компьютер, злоумышленники используют очень простые файлы, которые не несут никакого прямого ущерба. Но эти файлы могут загрузить дополнительные вредоносные файлы, которые уже могут шифровать документы, воровать пароли и т.д.

**Чтобы защититься от такой атаки**:
- не давайте неизвестным программам устанавливать и принимать сетевые соединения

#### 2.5. Некачественные вредоносные программы

Вредоносная программа приводит к тому, что другие программы зависают или работают с ошибками, компьютер тормозит, спонтанно перезагружается и выводит синий экран.

**Чтобы защититься от такой атаки**:
- регулярно проверяйте файлы на компьютере средством защиты от угроз

#### 2.6. Компоненты Kaspersky Endpoint Security

| Потенциальные цели атак                                                           | Компонент                                |
| --------------------------------------------------------------------------------- | ---------------------------------------- |
| Устанавливайте обновления безопасности для операционной системы                   | Kaspersky Security Center                |
| Устанавливайте обновления для веб-браузеров и других программ                     | Kaspersky Security Center                |
| Не давайте пользователям запускать какие угодно браузеры                          | Контроль программ                        |
| Не давайте пользователям заходить на какие угодно вебстраницы                     | Веб-контроль                             |
| Не давайте веб-браузерам запускать дочерние процессы                              | Анализ поведения<br>Защита от эксплойтов |
| Не давайте пользователям сохранять на диск исполняемые файлы из электронных писем | Защита от почтовых угроз                 |
| Запрещайте соединения с портами, которые не нужны для работы пользователя         | Сетевой экран                            |
| Не разрешайте пользователям подключать к компьютеру неизвестные (или все) флешки  | Контроль устройств                       |
| Не давайте неизвестным программам устанавливать и принимать сетевые соединения    | Сетевой экран                            |

| Обнаружение атак                                                                                         | Компонент                                            |
| -------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| Установите средства защиты на все компьютеры                                                             | Kaspersky Security Center                            |
| Проверяйте файлы, которые пользователи копируют, открывают или запускают                                 | Защита от файловых угроз<br>Предотвращение вторжений |
| Проверяйте файлы на флешках средством защиты от угроз                                                    | Поиск вирусов                                        |
| Проверяйте файлы, вложенные в электронные письма, средством защиты от угроз                              | Защита от почтовых угроз                             |
| Проверяйте файлы, которые пользователь загружает из Интернет, средством защиты от угроз                  | Защита от веб-угроз                                  |
| Не давайте пользователям заходить известные зараженные и фишинговые сайты                                | Защита от веб-угроз                                  |
| Не давайте пользователям заходить известные сайты с вредоносными программами                             | Защита от веб-угроз                                  |
| Проверяйте пакеты, которые принимает компьютер, на предмет сетевых атак средствам защиты от угроз        | Защита от сетевых угроз                              |
| Не давайте пользователям возможность автоматически подключать любые USB устройства в качестве клавиатуры | Защита от атак BadUSB                                |
| Используйте средства защиты, которые эвристически обнаруживают опасные действия                          | Защита от атак BadUSB                                |
| Используйте средства защиты, которые эвристически обнаруживают опасные действия                          | Анализ поведения<br>Предотвращение вторжений         |
| Регулярно проверяйте файлы на компьютере средством защиты от угроз                                       | Поиск вирусов                                        |

### 3. Как настроить защиту файлов

#### 3.1. Как Kaspersky Endpoint Security защищает файлы?

С помощью драйвера `klif.sys` Защита от файловых угроз перехватывает все файловые операции (такие как, чтение, копирование, выполнение) и проверяет файлы, с которыми выполняются действия. В случае если файл заражен, операция блокируется, а сам файл лечится или удаляется.

Можно отключить Защиту от почтовых угроз и Защиту от веб-угроз, но пользователь все равно не сможет запустить зараженный файл, полученный по почте или из сети Интернет. В момент сохранения файла на диск его обнаружит и заблокирует Защита от файловых угроз. А запустить файл из вложения или веб-страницы без сохранения на диск нельзя.

Поэтому Защита от файловых угроз — один из важных компонентов Kaspersky Endpoint Security.

Защита от файловых угроз ищет вредоносные программы с помощью:
- Сигнатур вредоносных программ — база сигнатур — это «стоп-лист» известных вредоносных файлов. Если файл не соответствует ни одной записи в базе, значит он не вредоносный. Полноценный список, где у каждого известного вредоносного или зараженного файла есть отдельная запись, требует слишком много места, поэтому база сигнатур — это оптимизированный список, уменьшенный до размера, который можно загрузить на компьютер. Каждая запись идентифицирует семейство похожих угроз.
- Эвристического анализа (эмуляции выполнения) — помогает обнаруживать полиморфные вредоносные файлы, которые меняют свой код во время выполнения, и которые из-за этого сложно обнаружить по сигнатурам. Защита от файловых угроз запускает исполняемые файлы в специальной изолированной среде и ждет, не изменится ли код в памяти так, что начнет соответствовать сигнатуре.
- Проверки по `KSN` — Защита от файловых угроз посылает в KSN контрольную сумму файла и получает ответ: есть ли такой файл в базе KSN, и какая у него репутация. База KSN это и есть огромный список всех известных Лаборатории Касперского файлов (вернее, их контрольных сумм). В этом списке есть файлы с репутацией недоверенные. Это черный список, такие файлы Защита от файловых угроз блокирует. Есть файлы с репутацией доверенные. Это белый список, куда входят известные невредоносные файлы операционных систем и распространенных программ. Эти файлы Защита от файловых угроз не блокирует, даже если по сигнатурам они вредоносные. Вердикт KSN имеет больший приоритет, потому что KSN содержит больше информации, чем локальная база сигнатур.

Чтобы не замедлять компьютер, Защита от файловых угроз проверяет не все файлы, а только те файлы, которые могут заразить компьютер. Например, Защита от файловых угроз не проверяет архивы, потому что, чтобы запустить файл из архива, этот файл нужно извлечь. Если пользователь сам не извлек файл из архива, это делает операционная система незаметно для пользователя. В любом случае Защита от файловых угроз проверит и, если нужно, заблокирует извлеченные файлы.

Файлы, которые не проверила Защита от файловых угроз, проверяйте задачами поиска вирусов. Поиск вирусов проверяет файлы в указанной области и применяет те же методы, что и Защита от файловых угроз.

#### 3.2. Что и как настроить в Защите от файловых угроз

Защита от файловых угроз, как и Kaspersky Endpoint Security в целом, решает две задачи:
- Не дать вредоносным программам нанести ущерб
- Не мешать работать пользователю и программам

Чем больше файлов проверяет Защита от файловых угроз, тем лучше он решает первую задачу, и тем хуже вторую. И наоборот. Настройки по умолчанию обеспечивают баланс между защитой и производительностью. Меняя настройки, администратор может сместить баланс в ту или другую сторону.

###### Защита от файловых угроз проверяет не все типы файлов

Файлы, которые могут нанести вред компьютеру, это в основном исполняемые файлы, но не только. Документы Microsoft Office могут содержать исполняемый код (макросы), который может быть вредоносным. Даже документы без кода, некоторые графические файлы, могут использовать уязвимости в программах, которые их открывают, и заставить эти программы выполнить часть файла как код.

По умолчанию Защита от файловых угроз проверяет файлы по формату. Так Kaspersky Endpoint Security надежно защищает компьютер, поскольку проверяет все опасные файлы, но меньше загружает компьютер, поскольку проверяет не все файлы.

Проверять файлы только по расширению опасно. Например, вредоносный документ Word может иметь расширение `.123`, которое не входит в список проверяемых, но пользователь все равно может его открыть через контекстное меню Открыть с помощью. К тому же, проверять по расширению не намного быстрее, чем проверять по формату. Пользователь не заметит разницы в производительности.

Если администратор хочет улучшить производительность медленных компьютеров, лучше начать с исключений для программ, с которыми работают пользователи.

Эвристический анализ в Kaspersky Endpoint Security запускает исполняемый программы в изолированной среде и смотрит, что они делают. В первую очередь эвристический анализ помогает обнаруживать полиморфные вредоносные программы, которые меняют свой код во время выполнения.

###### Защита от файловых угроз не проверяет файлы, которые уже проверяла

Большая часть файлов на компьютере меняется редко, поэтому проверяя только новые и измененные файлы, Защита от файловых угроз почти не загружает компьютер. В первые несколько дней, пока все файлы для Kaspersky Endpoint Security новые, пользователь может ощущать, что компьютер работает медленнее. Но довольно скоро Защита от файловых угроз перестает заметно влиять на производительность.

> Не выключайте опцию Проверять только новые и измененные файлы в Защите от файловых угроз, это замедлит компьютер.

![[Pasted image 20260216115225.png]]

![[Pasted image 20260216115245.png]]

![[Pasted image 20260216115303.png]]

###### Как Kaspersky Endpoint Security узнает, какие файлы менялись, а какие нет?

Файловая система NTFS (и ее наследник ReFS) записывает, когда файлы меняются, и гарантирует целостность этих записей. Поэтому на дисках с файловой системой NTFS Kaspersky Endpoint Security просто смотрит на дату изменения файла.

Файловая система `FAT32` может не записывать дату изменения, и не защищает саму дату изменения от изменений. Вредоносная программа может изменить файл, а потом записать ему какую угодно дату изменения. Поэтому на дисках с файловой системой `FAT32` Kaspersky Endpoint Security сохраняет в специальную базу контрольные суммы проверенных файлов. При следующем обращении Kaspersky Endpoint Security заново вычисляет контрольную сумму и сравнивает ее с сохраненной. Если суммы отличаются, значит файл изменился, и Защита от файловых угроз его проверяет.

###### Защита от файловых угроз не проверяет составные файлы (архивы и пр.)

| Параметры программы \| Базовая защита \| Защита от файловых угроз \| Проверять архивы                                                                                                                | Значение параметра       |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| Защита от файловых угроз проверяет файлы внутри архивов форматов RAR, ARJ, ZIP, CAB, LHA, JAR, ICE. Для этого Защита от файловых угроз распаковывает файлы из архива во временную папку или в память | Включено                 |
| Защита от файловых угроз не распаковывает архивы и не проверяет файлы в них                                                                                                                          | Выключено (по умолчанию) |
Чтобы проверить файлы в архиве, Защита от файловых угроз распаковывает архив, и на это уходит много ресурсов компьютера. Сами по себе архивы не опасны. Даже если в архиве есть вредоносный файл, его нельзя запустить из архива. Пользователь либо сам распакует архив, либо это сделает операционная система незаметно для пользователя. В любом случае вредоносный файл попадает на диск, и Защита от файловых угроз проверяет его как обычный файл.

> Не включайте опцию Проверять архивы в Защите от файловых угроз. Это замедлит компьютер и не повлияет на защиту

| Параметры программы \| Базовая защита \| Защита от файловых угроз \| Проверять дистрибутивы                                                                                                                       | Значение параметра       |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| Защита от файловых угроз проверяет файлы внутри самораспаковывающихся архивов и установочных пакетов, таких, как MSI Для этого Защита от файловых угроз извлекает файлы из пакета во временную папку или в память | Включено                 |
| Защита от файловых угроз не проверяет самораспаковывающиеся архивы и установочные пакеты                                                                                                                          | Выключено (по умолчанию) |
Установочные пакеты Защитой от файловых угроз проверять не нужно. Если пользователь копирует пакет, он не может заразить компьютер. Если пользователь запускает пакет, пакет сам извлекает из себя файлы и сохраняет их на диск, где их и проверяет Защита от файловых угроз.

| Параметры программы \| Базовая защита \| Защита от файловых угроз \| Проверять файлы офисных форматов                                                       | Значение параметра       |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| Защита от файловых угроз проверяет исполняемые куски не только в самих документах Microsoft Office, но и в объектах, вложенных в документы Microsoft Office | Включено  (по умолчанию) |
| Защита от файловых угроз проверяет исполняемые куски только непосредственно в документах Microsoft Office, но не во вложенных в них объектах                | Выключено                |
У файлов `Microsoft Office` сложная структура. Можно сказать, что внутри у документа `Microsoft Office` своя собственная файловая система с дополнительными файлами. Когда пользователь вставляет в документ `Word` график, который он подготовил в `Excel`, `Microsoft Office` может добавить в документ `Word` весь документ `Excel`, со всеми данными, формулами и макросами.

> Не отключайте проверку документов офисных форматов. Не проверять объекты, вложенные в офисные документы опасно. В них могут быть вредоносные макросы, которые программы Office запускают, не сохраняя предварительно на диск.

###### Защита от файловых угроз удаляет вредоносные программы

Вредоносные программы, обнаруженные Защитой от файловых угроз, нельзя оставлять необработанными. Поэтому настройки действий Защиты от файловых угроз должны быть обязательными. Оптимальным выбором будет пытаться лечить, а если лечение невозможно, удалять зараженные файлы. Большинство вредоносных файлов неизлечимы, потому что не содержат ничего кроме вредоносного кода.

Перед лечением или удалением файла его копия помещается в резервное хранилище. Это делается на случай, если файл понадобится восстановить. Например, если в нем была критично важная информация, или если файл был удален в результате ложного срабатывания.

#### 3.3. Что делать если Защита от файловых угроз замедляет компьютер

- Не проверяйте папку медленной программы
- Не проверяйте файлы, с которыми работает медленная программа
- Не проверяйте сетевые диски
- Не проверяйте файлы, подписанные доверенными сертификатами
- Остановите Защиту от файловых угроз, пока работает медленная программа

###### Как исключить папку программы

![[Pasted image 20260216120802.png]]

Исключения настраиваются в политике Kaspersky Endpoint Security: откройте раздел` Параметры программы | Общие настройки` и нажмите ссылку `Исключения`.

Исключения для папок доступны по ссылке Исключения из проверки и применяются ко всем компонентам защиты. Исключения из проверки состоят из трех атрибутов:
- Файл или папка — имя файла или каталога, на который распространяется исключение. В имени объекта можно использовать переменные окружения (%systemroot%, %userprofile% и другие) и спецсимволы `«*»` и `«?»`
- Название объекта — имя игнорируемой угрозы (как правило, имя вредоносной программы), которое тоже можно задать с использованием спецсимволов
- Хеш объекта — контрольная сумма файла (`SHA-256`), на который распространяется исключение.
- Компоненты защиты— перечень компонентов защиты, на которые распространяется правило

###### Как исключить файлы, к которым обращается процесс

![[Pasted image 20260216122741.png]]

Если на компьютере запускаются особенно ресурсоемкие приложения, их работа может замедляться Защитой от файловых угроз. Особенно это касается программ, выполняющих много операций с файлами, например, резервного копирования или дефрагментации. Чтобы избежать замедления во время работы таких приложений, сделайте их доверенными.

Для этого в окне настройки исключений добавьте исполняемый файл в список Доверенные программы. В окне Программа укажите путь к исполняемому файлу, и выберите тип разрешенных действий — Не проверять открываемые файлы. Путь может содержать переменные среды и символов `“*”` и `“?”`

###### Как не проверять сетевые диски

> Не проверять сетевые диски опасно. Перед тем, как выключить проверку сетевых дисков, будьте уверены, что на всех компьютерах сети установлены средства защиты. Не отключайте проверку сетевых дисков «на всякий случай», а только если это решает проблему пользователей

Чтобы не проверять сетевые диски, измените область защиты в настройках защиты от файловых угроз.

###### Как применить настройки к компьютерам

Настройки политики должны быть обязательными, т.е. с закрытым замком. Настройки с незакрытым замком не применяются к компьютерам.

#### 3.4. Как и зачем проверять файлы по расписанию

Чем помогает поиск вирусов, если Защита от файловых угроз все равно проверяет все опасные файлы? Поиск вирусов:
- Не дает пользователям распространять вредоносные программы в архивах
- Обновляет кэши KSN, обновляет данные о контрольных суммах файлов, после чего Защита от файловых угроз может проверять меньше файлов
- Проверяет файлы, которые не менялись. Защита от файловых угроз не проверяет такие файлы и иногда это может быть опасно

Задачи поиска вирусов выполняют проверку теми же способами, что и Защита от файловых угроз — используя сигнатурный и эвристический анализ, а также KSN. Разница в том, что **Защита от файловых угроз проверяет файлы на лету, когда к ним происходит обращение, а задачи поиска вирусов проверяют файлы по расписанию или по запросу**.

Задачи поиска вирусов можно запускать в нерабочее время. В таком случае нет необходимости слишком уж экономить ресурсы и можно выполнять проверку более тщательно. Поэтому, задача поиска будет ожидать ответа из KSN для вынесения окончательного вердикта, независимо от результатов проверки с помощью сигнатур и эвристики. Кроме того, поиском вирусов можно проверить объекты, исключенные из проверки в Защите от файловых угроз — архивы, инсталляционные пакеты, прочие файлы незаражаемых форматов.

###### Где и как искать опасные файлы

Настройки поиска вредоносных файлов задавайте в задачах поиска вирусов.

![[Pasted image 20260216131226.png]]

> Начиная с одиннадцатой версии Kaspersky Security Center, мастер первоначальной настройки сервера администрирования больше не создает задачу Быстрого поиска вируса. По умолчанию, поиск вирусов на компьютерах осуществляется специальной локальной задачей `Scan_IdleScan`.

Задача `Scan_ldleScan` требует меньше ресурсов, по сравнению с обычной задачей поиска вирусов. Выполняется при простое компьютера, не отображает уведомления пользователю и не сбрасывает статус Давно не выполнялся поиск вирусов. Параметры проверки и область проверки данной задачи изменить нельзя.

Если вы решили использовать собственную задачу поиска вирусов, рекомендуется отключить задачу `Scan_IdleScan`. Чтобы отключить задачу `Scan_IdleScan`, в свойствах политики Kaspersky Endpoint Security, перейдите в раздел `Параметры программы | Локальные задачи | Фоновая проверка` и снимите отметку с опции **Включить фоновую проверку**.

###### Область проверки

Область проверки представляет собой список путей к папкам и файлам, которые проверяются во время работы задачи. При указании пути допускается использование переменных среды (например, `%systemroot%`), а также символов `*` и `?` в имени файла или папки. Для папок, можно дополнительно выбрать: проверять все содержимое, включая подпапки, или только файлы, расположенные непосредственно в каталоге. В случае если подпапки не проверяются, иконка объекта помечается небольшим красным значком "минус".

Помимо файлов или каталогов в качестве объекта проверки можно указать:
- Моя почта — файлы данных Outlook (`.pst` и `.ost`)
- Память ядра —область памяти ядра операционной системы
- Запущенные программы и объекты автозапуска — область памяти, занятая процессами, и исполняемые файлы программ, которые запускаются при старте системы. Дополнительно, если в свойствах задачи выбран этот объект, в ходе поиска будет выполняться проверка на наличие руткитов (скрытых объектов файловой системы)
- Загрузочные секторы — проверяются загрузочные секторы жестких и съемных дисков
- Системное резервное хранилище — проверка папок `System Volume Information`
- Все съемные диски — съемные диски, подключенные в данный момент к компьютеру
- Все жесткие диски — жесткие диски компьютера
- Все сетевые диски — все сетевые диски, подключенные к компьютеру

Сделайте задачу, которая проверяет весь компьютер раз в неделю или раз в две недели. Если для такой задачи нет времени, когда ее можно выполнить, проверяйте хотя бы критические области:
- Память ядра
- Запущенные процессы и объекты автозапуска
- Загрузочные секторы
- `%systemroot%`\
- `%systemroot%\system\`
- `%systemroot%\system32\`
- `%system root%\system32\drivers\`
- `%systemroot%\syswow64\`
- `%system root%\syswow64\drivers\`

###### Учетная запись

По умолчанию задачи поиска запускаются на клиентских компьютерах с правами учетной записи локальной системы. В случае если в область проверки задачи входят сетевые диски или другие объекты, доступ к которым открыт не для всех пользователей, задача проверки не сможет их просканировать. Чтобы решить проблему, укажите в свойствах задачи учетную запись, обладающую необходимыми правами.

#### 3.5. Защита файлов: резюме

- Защита от файловых угроз и задачи поиска дополняют друг друга, оба важны
- Если Защита от файловых угроз сильно замедляет работу:
	—	Регулярно выполняйте поиск вирусов, поиск вирусов обновляет кэш проверенных файлов
	— Создайте исключения для папок
	—	Создайте исключения для исполняемых файлов
	—	Не проверяйте файлы, подписанные доверенными сертификатами
	—	Не проверяйте сетевые диски, если они защищены локально
	—	В крайнем случае, приостанавливайте Защиту от файловых угроз на время работы программы
- Настройте поиск вирусов на всех дисках компьютера
- Если нет удобного времени для поиска вирусов, используйте проверку при простое

> Не выключайте Защиту от файловых угроз. Запланируйте поиск вирусов на компьютерах

### 4. Настройка защиты от угроз по сети

#### 4.1. Как работает защита сети

![[Pasted image 20260216132758.png]]

Сеть — это один из основных путей распространения вредоносных программ. Поэтому защита сети и проверка сетевого трафика играет важную роль в обеспечении безопасности компьютера. В Kaspersky Endpoint Security за поиск вредоносных программ в сетевом трафике отвечают компоненты **Защита от почтовых угроз** и **Защита от веб-угроз**:

| Компонент                | Функции                                                                                                |
| ------------------------ | ------------------------------------------------------------------------------------------------------ |
| Защита от почтовых угроз | Удаляет вредоносный код из почтовых сообщений и вложений Переименовывает потенциально опасные вложения |
| Защита от веб-угроз      | Не дает загружать вредоносные файлы<br>Не дает заходить на вредоносные и фишинговые сайты              |
![[Pasted image 20260216133107.png]]

Перехват сетевого трафика Kaspersky Endpoint Security осуществляет с помощью `NDIS-фильтра`. Драйвер перехватывает исходящие соединения от программ на компьютере и передает пакеты сетевым компонентам защиты. Kaspersky Endpoint Security определяет протокол соединения, и передает пакеты соответствующему компоненту:
- `HTTP`, `HTTPS`, `FTP` - **Защита от веб-угроз**, **Веб-контроль**
- `SMTP`, `POP3`, `POP3S IMAP`, `NNTP` - **Защита от почтовых угроз**

Остальные пакеты поступают сразу к программам и приложениям, для которых они предназначены.

> Kaspersky Endpoint Security проверяет данные в защищенных соединениях (SSL/TLS)

Kaspersky Endpoint Security может перехватывать не все исходящие соединения, а только соединения на заданные порты. Для этого в политике Kaspersky Endpoint Security на вкладке Параметры программы выберите раздел `Общие настройки | Настройки сети` и в области `Контролируемые порты` выберите **Контролировать только выбранные сетевые порты**. Нажмите ссылку `Выбрано N портов` и укажите порты, которые нужно перехватывать.

Если вы не знаете, какие именно порты использует программа, включите опцию Контролировать все порты для указанных программ, и добавьте в список путь к исполняемому файлу программы.

###### Как Kaspersky Endpoint Security проверяет зашифрованный трафик

![[Pasted image 20260216133629.png]]

В процессе установки, `Kaspersky Endpoint Security` создает самоподписанный сертификат - `Kaspersky Endpoint Security Personal Root Certificate` и помещает его в локальное хранилище компьютера - `Trusted Root Certification Authorities`. При каждом запуске, KES проверяет наличие сертификата в хранилище, и если не его там нет, восстанавливает.

Проверка зашифрованного трафика (`SSL`/`TLS`) Kaspersky Endpoint Security осуществляется с помощью подмены сертификата. Kaspersky Endpoint Security перехватывает исходящее соединение от программы к серверу, получив сертификат сервера, KES генерирует аналогичный сеансовый сертификат, подписанный `Kaspersky Endpoint Security Personal Root Certificate` сертификатом, и отдает его клиентской программе. Это позволяет перехватить симметричный ключ шифрования и расшифровать весь сеанс связи.

Пользователь не получит никаких предупреждений от веб-браузера, поскольку `Kaspersky Endpoint Security Personal Root Certificate` находится в хранилище доверенных сертификатов.

Проверка зашифрованного трафика включена по умолчанию и влияет на работу следующих компонентов:
- Защита от веб-угроз
- Защита от почтовых угроз
- Веб-контроль

Протоколы `SSL`/`TLS` поддерживают три режима аутентификации: **аутентификация двух сторон**, **аутентификация сервера перед анонимным клиентом** и **полная анонимность**.

Например, когда пользователь подключается, по протоколу `https` к веб-серверу, в большинстве случаев используется второй режим аутентификации - **аутентификация сервера перед анонимным клиентом**. В этом случае подмена сертификата не вызывает проблем.

Большинство ресурсов в интернете используют защищенные соединения для передачи информации, поэтому не рекомендуется полностью отключать проверку защищенных соединений. Если проверка защищенных соединений мешает работе программ, настройте исключения.

Исключения настраиваются в политике Kaspersky Endpoint Security: откройте раздел `Параметры программы | Общие настройки | Настройки сети`. В области `Проверка защищенных соединений` доступны две ссылки для настройки исключений - **Доверенные адреса** и **Доверенные программы**.

Если проверка защищенных соединений мешает работе с веб-сайтом, добавьте адрес веб-сайта в список доверенных:
1.	Перейдите по ссылке Доверенные адреса
2.	Добавьте адрес веб-сайта в список. Чтобы задать маску, используйте спецсимволы `«*»` и `«?»`

Подмена сертификата для перечисленных в этом списке адресов сайтов осуществляться не будет.

Если все же у вас окажется программа, которая конфликтует с проверкой защищенных соединений, отключите для нее проверку зашифрованного трафика:
1.	Перейдите по ссылке Доверенные программы
2.	Добавьте исполняемый файл программы на вкладке Программы: укажите полный путь к файлу, используйте переменные среды, такие как `%System Root%`
3.	Отметьте флаг `Не проверять сетевой трафик`, выберите параметр `Только зашифрованный трафик` и снимите другие флаги
4.	Если сервера, с которыми работает программа, имеют постоянные адреса (или фиксированный диапазон адресов) и порты, укажите их в нижней части окна: так безопаснее

#### 4.2. Защита от почтовых угроз

Защита от почтовых угроз защищает от угроз, которые могут присутствовать в почтовых сообщениях. Перехват сообщений осуществляется на уровне протоколов (`POP3`, `SMTP`, `IMAP` и `NNTP`), а также путем встраивания в Microsoft Office Outlook (`MAPI`).

Защита от почтовых угроз обнаруживает и удаляет вредоносные программы, используя для этого сигнатуры вредоносных программ, эвристический анализ и Kaspersky Security Network. Кроме этого, в Защите от почтовых угроз есть возможность блокировать или переименовывать почтовые вложения, удовлетворяющие заданным маскам.

В зараженных сообщениях Защита от почтовых угроз меняет тему письма. В измененной теме указывается выполненное действие.

###### Настройки Защиты от почтовых угроз

**Область защиты**

Параметры безопасности определяют, кроме прочего, Область защиты. В терминах Защиты от почтовых угроз область защиты может принимать два значения:
- Входящие и исходящие сообщения
- Только входящие сообщения

Для защиты компьютера достаточно проверять только входящие сообщения. Проверка исходящих может предотвратить непреднамеренную отправку зараженного файла в архиве и избежать неприятной ситуации. Также проверку исходящих можно использовать для блокирования обмена вложениями определенных типов, например, музыки или видео.

**Встраивание в систему**

Группа параметров Дополнительные настройки уточняет область защиты:
- Проверять трафик POP3/SMTP/NNTP/IMAP — включает проверку сообщений электронной почты и электронных новостей, передаваемых по указанным протоколам
- Подключить расширение для Microsoft Outlook — включает проверку объектов на уровне клиента Microsoft Office Outlook при получении, прочтении и отправке.
- Проверка на уровне протоколов работает независимо от используемых почтовых клиентов. Но сообщения, передаваемые по не перехватывающимся протоколам, как например, при работе с серверами Microsoft Exchange или Lotus Notes, проверяться не будут.
- Проверка на уровне почтового клиента, наоборот, работает независимо от того, каким образом получено сообщение. Правда, список поддерживаемых клиентов весьма ограничен.

**Способы проверки**

Если вложенные файлы являются архивами, они могут быть распакованы и просканированы. Это поведение регулируется тремя настройками:
- Проверять вложенные архивы — позволяет полностью отключить проверку архивов. Как правило, лучше оставить этот параметр включенным, и проверять архивы на лету Защитой от почтовых угроз. Гораздо легче не допустить попадания инфицированного архива в почтовую базу, чем потом удалять его из базы задачей поиска вирусов.
- Проверять вложенные файлы офисных форматов
- Не проверять архивы размером более `NN` МБ — ограничивает объем проверяемых архивов или файлов офисных форматов. Вредоносные программы исключительно редко распространяются в файлах большого размера. Включив это ограничение, можно избежать задержки при получении больших составных файлов.
- Ограничить время проверки архива до `NN` с — реализует защиту от «архивных бомб», проверка которых требует очень много времени и вычислительных ресурсов, затрудняя работу с компьютером

###### Фильтр вложений

Остальные параметры касаются только вложенных файлов. Администратор может:
- Не применять фильтр — пропускает все невредоносные вложения
- Переименовывать вложения указанных типов3 — используется по умолчанию и переименовывает вложения исполняемых типов (`.exe`, `.bat`, `cmd` и т.п.). Это превентивная мера против неизвестных угроз. Пользователь не сможет запустить вложенный файл, не переименовав его сознательно.
- Удалять вложения указанных типов — надежнее защищает от заражения, и кроме того может применяться для пресечения обмена файлами определенных типов: например, музыкальными или видеофайлами

#### 4.3. Защита от веб-угроз

Защита от веб-угроз выполняет две важные функции:
- Блокирует доступ к фишинг-сайтам и потенциально опасным сайтам, анализируя адреса веб-страниц, которые открывает пользователь или программы
- Проверяет объекты, загружаемые по протоколам HTTP, HTTPS и FTP и блокирует вредоносные файлы

Для проверки ссылок используются четыре технологии:
- Проверка по базе вредоносных веб-адресов — простое сравнение адреса открываемого сайта с адресами веб-ресурсов, замеченных в размещении вредоносных программ, выполнении атак на компьютеры и прочей вредоносной деятельности
- Проверка по базе фишинговых веб-адресов — выполняется так же, как предыдущая проверка, только по базе сайтов замеченных в фишинге
- Эвристический анализ для обнаружения фишинговых ссылок — анализ содержимого сайтов на наличие HTML-кода характерного для фишинга
- Проверка в `KSN` — адреса открываемых сайтов проверяются в `KSN`. Опасные ссылки блокируются. Полученный ответ сохраняется в локальный кэш и используется при дальнейших проверках.

###### Настройки Защиты от веб-угроз

**Действия**

Ко всем обнаруженным опасным объектам применяется одинаковое действие, которое можно выбрать из двух доступных:
- Запрещать загрузку
- Информировать

В политике нужно устанавливать действие **Запрещать загрузку** и делать его обязательным, чтобы пользователи не имели возможности загружать опасные объекты или посещать опасные веб-сайты.

При попытке открыть запрещенный веб-ресурс или загрузить зараженный объект, в браузере будет показано уведомление о том, что загрузка заблокирована Kaspersky Endpoint Security.

###### Как сделать веб-сайт доверенным

Если Защита от веб-угроз ошибочно считает веб-сайт вредоносным или фишинговым, добавьте адрес веб-сайта в список доверенных:
1.	В разделе Базовая защита перейдите по ссылке Защиты от веб-угроз
2.	Включите параметр Не проверять веб-трафик с доверенных веб-адресов
3.	Добавьте адрес веб-сайта в список. Чтобы задать маску, используйте спецсимволы `«*»` и `«?»`

Адреса сайтов, перечисленные в этом списке, а также загружаемые с них объекты, не будут проверяться Защитой от веб-угроз.

Если Защита от веб-угроз ошибочно считает вредоносным файл, который пользователь загружает с веб-сайта, сделайте исключение для файлов в Общих настройках на вкладке Параметры программы. Примените исключение как минимум к `Защите от веб-угроз`, `Защите от файловых угроз` и к `Поиску вирусов`.

#### 4.4. Как не перехватывать весь трафик программы

![[Pasted image 20260217110538.png]]

Начиная с версии 10SP2, Kaspersky Endpoint Security использует драйвер, который не разрывает соединение, а использует функции операционной системы, чтобы получить доступ ко всем пакетам. Такой способ перехвата, как правило, не создает проблем в работе сетевых программ.

Если все же у вас окажется программа, которая конфликтует с новым методом перехвата, отключите для нее перехват трафика:
1. Откройте список доверенных процессов в политике Kaspersky Endpoint Security: откройте раздел Общие настройки | Исключения и перейдите по ссыпке Доверенные программы
2. Добавьте исполняемый файл программы в список Доверенные программы: укажите полный путь к файлу, используйте переменные среды, такие как %SystemRoot%
3. Отметьте флаг Не проверять сетевой трафик и снимите другие флаги
4. Если сервера, с которыми работает программа, имеют постоянные адреса (или фиксированный диапазон адресов) и порты, укажите их в нижней части окна: так безопаснее

#### 4.5. Защита сетевых соединений: резюме

Сетевые компоненты:
- Освобождают от работы Защиту от файловых угроз, которая медленнее
- Защищают от фишинга
- Защищают от новых угроз на известных вредоносных веб-сайтах
- Используют сигнатуры угроз, эвристический анализ страниц и репутацию файлов и веб-сайтов в KSN

Если сетевые компоненты мешают работе программы:
- Настройте доверенные веб-сайты в Защите от веб-угроз
- Настройте исключения для трафика исполняемых файлов
- Удалите порт программы из списка контролируемых портов

Сетевые компоненты Защита от почтовых угроз и Защита от веб-угроз не потребляют много ресурсов. Наоборот, они позволяют Защите от файловых угроз проверять меньше файлов, и улучшают производительность компьютера.

Защита от веб-угроз — единственный компонент, который защищает от фишинга. Он же защищает от новых угроз, которые распространяются через известные вредоносные веб-сайты.

> Не выключайте сетевые компоненты защиты, это не повлияет на производительность, но ухудшит защиту

Если Защита от веб-угроз или Защита от почтовых угроз ошибочно удаляют файлы, блокируют веб-сайты или мешают работе сетевых программ, настройте исключения:
- Исключения для веб-сайтов в настройках `Защита от веб-угроз`
- Исключения для программ в `Общих параметрах | Исключениях`
- Исключения для портов в `Общих параметрах | Исключениях`

### 5. Как настроить защиту от сложных угроз

#### 5.1. Как Kaspersky Endpoint Security защищает от новых

Известные программы-вымогатели поймает **Защита от файловых угроз** по сигнатурам или с помощью **Kaspersky Security Network**; опасны новые программы-вымогатели, которых нет в базах

**Защита от веб-угроз** не дает зайти на сайты, которые распространяют вредоносное ПО

**Защита от почтовых угроз** переименовывает опасные вложения, в том числе внутри архивов

**Защита от эксплойтов** не даст использовать известные и некоторые неизвестные уязвимости в программах

**Анализ поведения** использует технологии машинного обучения, чтобы обнаруживать опасные программы по их поведению, и заблокировать их

**Предотвращение вторжений** блокирует опасные действия программ с неизвестной репутацией

**Поставщик AMSI-защиты** не дает программам запускать вредоносные скрипты

Kaspersky Endpoint Security пытается обнаруживать и блокировать вредоносные программы, в том числе и новые, на всех этапах атаки:

|                                                                                                                                          |                                                                                                                                        |
| ---------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| Злоумышленники публикуют вредоносные программы на зараженных и вредоносных веб-сайтах. Часто эти же веб-сайты они использовали и раньше  | Защита от веб-угроз использует базу известных вредоносных сайтов и репутацию веб-сайтов в KSN, и не дает пользователям на них заходить |
| Злоумышленники рассылают новые вредоносные программы по почте                                                                            | Защита от почтовых угроз переименовывает исполняемые вложенные файлы, в том числе и в архивах                                          |
| Злоумышленники используют уязвимости в программах для запуска вредоносного кода                                                          | Защита от эксплойтов не дает использовать известные и некоторые неизвестные уязвимости в программах                                    |
| Новые вредоносные программы отличаются кодом, чтобы обойти проверку по сигнатурам, но ведут себя похоже на другие вредоносные программы  | Анализ поведения следит за тем, что делают программы, и обнаруживает новые вредоносные программы по их поведению                       |
| Зашифрованные данные статистически однородны, как будто их произвел генератор случайных чисел. Этим они отличаются от большинства файлов | Анализ поведения использует эвристический и статистический анализ, технологии машинного обучения, чтобы обнаружить шифрование файлов   |
| Новые вредоносные программы не имеют никакой репутации в KSN                                                                             | Предотвращение вторжений не дает программам без репутации использовать многие функции операционной системы                             |

В основном новым угрозам противостоят **Анализ поведения**, **Защита от эксплойтов** и **Предотвращение вторжений** при поддержке **Kaspersky Security Network**.

#### 5.2. Что делает Продвинутая защита

Компоненты и технологии, которые позволяют предотвращать или минимизировать последствия заражения новыми вредоносными программами, еще не внесенными в базы сигнатур, называют продвинутой защитой.

###### Как Анализ поведения защищает от новых угроз

**Записывает в журнал, что делают программы**
- Какие файлы открывают
- Какие соединения устанавливают
- Какие системные функции используют

**Сравниваете шаблонами опасного поведения (BSS)**

**Останавливает опасные программы, а их действия откатывает назад**

**Защищает от программ вымогателей**:
- обнаруживает попытки шифрования на компьютере
- обнаруживает попытки шифрования файлов в общих папках по сети с других компьютеров
- блокирует операции записи и изменения файлов в общих папках с атакующего компьютера (по умолчанию на 60 минут)

Если Анализ поведения обнаруживает вредоносное поведение, он прерывает программу, удаляет исполняемый файл и помещает его в Резервное хранилище.

Другие возможные действия:
- **Информировать** — не выполнять никаких действий, только занести факт обнаружения вредоносной активности в отчет
- **Завершать работу программы** — завершить и выгрузить вредоносную программу из памяти
- **Удалять файл** —завершить программу, удалить вредоносный файл, а копию поместить в Резервное хранилище

###### Как Защита от эксплойтов защищает от новых угроз

**Защита от эксплойтов** — защищает от широкого класса атак (эксплойтов), целью которых является получение прав администратора в системе или скрытое выполнение кода.

Эксплойты, как правило, используют атаку на переполнение буфера. В уязвимую программу или службу передаются некорректные параметры, обработка которых приводит к тому, что часть параметров уязвимая программа выполняет как код. В частности, с помощью таких атак на системные службы (которые выполняются с правами локальной системы) можно получить права администратора на компьютере.

Чаще всего с помощью такой атаки вредоносная программа пытается запустить саму себя с правами администратора. Включение данного параметра включает слежение за операциями запуска, и если уязвимая программа выполняет запуск другой программы не по инициативе пользователя, такой запуск блокируется.

###### Как Откат вредоносных действий защищает от новых угроз

**Откат вредоносных действий** — выполняет откат действий приложений, которые удаляются Защитой от файловых угроз, задачами поиска и Анализом поведения.

Откатываются изменения файловой системы (создание, перемещение, переименование файлов) и ключей реестра (удаление созданных вредоносной программой записей). Кроме того, для небольшой группы файлов и ключей делается снимок состояния на момент старта системы, что позволяет откатываться к сохраненной версии, если вредоносная программа вносила изменения в эти файлы и ключи. К таким особым объектам относятся файлы `hosts`, `boot.ini` и ключи реестра, отвечающие за запуск программ и служб при старте системы.

Эта же опция восстанавливает файлы, зашифрованные программами-вымогателями, которые шифруют файлы на дисках и в общих папках, после чего требуют выкуп.

Для отката вредоносных действий используется журнал активности программ, который ведет компонент Анализ поведения.

###### Как Предотвращение вторжений защищает от новых угроз

Основное назначение Предотвращения вторжений — регулировать действия уже запущенных программ, а именно, доступ к файловой системе, системному реестру и взаимодействие с другими программами.

###### Как Предотвращение вторжений вычисляет репутацию программ

Предотвращение вторжений разделяет программы на категории (группы доверия), для которых и задаются ограничения. Все программы делятся по уровню доверия, на четыре заранее фиксированные группы:
- Доверенные
- Слабые ограничения
- Сильные ограничения
- Недоверенные

Kaspersky Endpoint Security определяет группу доверия во время первого старта программы. Основным инструментом для определения категории служит Kaspersky Security Network. Если доступа к сети нет или в KSN нет информации о программе, категория определяется в зависимости от настроек:
- **Группа доверия для программ, которые не удалось распределить по другим группам** — эта настройка позволяет администратору выбрать, какую категорию назначить программам, у которых еще нет репутации. Администратор может выбрать одну из трех групп: **Сильные ограничения**, **Слабые ограничения**, **Недоверенные**
- **Доверять программам, имеющим цифровую подпись** — если этот параметр включен, программы, подписанные доверенными сертификатами, будут автоматически помещаться в группу **Доверенные**

###### Как Предотвращение вторжений ограничивает программы

Предотвращение вторжений ограничивает взаимодействие с другими программами и службами операционной системы, в зависимости от группы доверия. Обобщенно, ограничения по умолчанию для категорий доверия выглядят следующим образом:

| Наименование ограничения | Описание                                                                                                                                           |
| ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Доверенные**           | Нет ограничений                                                                                                                                    |
| **Слабые ограничения**   | Разрешено почти все, кроме внедрения в модули операционной системы и доступа к устройствам записи: веб-камерам и микрофонам                        |
| **Сильные ограничения**  | Запрещены взаимодействия с модулями операционной системы и другими программами. Разрешена работа только с собственным сегментом оперативной памяти |
| **Недоверенные**         | Запрещено все, в том числе запуск программы                                                                                                        |
Предотвращение вторжений позволяет ограничивать доступ к файлам и папкам на диске, а также к ключам системного реестра. У Предотвращения вторжений есть список защищаемых ресурсов.

Они сгруппированы в две категории:
1. Операционная система
2. Персональные данные

В каждой категории есть свои подкатегории и описания ресурсов: пути к папкам, маски файлов, маски ключей реестра. Изначально в списке защищаемых ресурсов уже присутствуют группы наиболее важных файлов и ключей реестра. Например, в категории Операционная система есть подкатегория Параметры автозапуска, где перечислены все ключи реестра, относящиеся к автозапуску программ.

#### 5.3. Как исключить программу из мониторинга

•	Доверяйте программам с достоверной цифровой подписью
—	В настройках Предотвращение вторжений
—	В настройках исключений
•	Если компонент расширенной защиты сообщает об угрозе, сделайте исключение для вердикта
•	Если Предотвращение вторжений ограничил права программы из-за репутации, переместите программу в категорию доверенных
•	Если программе мешает то, как Kaspersky Endpoint Security следит за ее активностью, сделайте исполняемый файл программы доверенным в настройках исключений

###### Как получить список программ с компьютера

1. Создайте задачу Инвентаризация для Kaspersky Endpoint Security
2. Сделайте ее задачей для наборов компьютеров
3. Настройте область поиска
4. Не запускайте на всех компьютерах, чтобы не перегружать сеть и базу. Запускайте на отдельных компьютерах, только чтобы наполнить список файлов

Собирать списки файлов со всех компьютеров не рекомендуется. Часто у администраторов есть тестовые компьютеры, на которых установлены все типичные программы. Если такие компьютеры есть, собирайте списки исполняемых файлов с них. А чтобы наполнить локальный список известных программ на тестовом компьютере, и не запускать все программы вручную, используйте задачу Инвентаризации.

Задача Инвентаризации сканирует файлы в указанных папках, находит исполняемые файлы, добавляет их в локальный список известных исполняемых файлов и активирует передачу данных на Сервер администрирования. Чтобы результаты сканирования попали на сервер, параметр информировать Сервер о запускаемых программах должен быть включен в политике Kaspersky Endpoint Security.

#### 5.5. Защита от новых угроз: резюме

- Kaspersky Endpoint Security следит за операциями, которые выполняют программы
- Предотвращение вторжений
	- смотрит на индивидуальные действия
	- смотрит на репутацию программы (KSN)
	- запрещает опасные действия программам с плохой репутацией
- Компоненты расширенной защиты
	- Ведут журнал действий
	- Сохраняют резервные копии важных файлов
	- Сравнивают последовательность действий с шаблонами поведения вредоносных программ
	- Блокируют программы с опасным поведением
	- Восстанавливают поврежденные файлы
- Против программ-вымогателей
	- Настройте Предотвращение вторжений блокировать доступ к документам всем программам кроме доверенных

Почти все компоненты Kaspersky Endpoint Security помогают защищать от новых угроз, но в первую очередь за это отвечают **Анализ поведения** и **Предотвращение вторжений**. Оба компонента следят за операциями, которые выполняют программы.

**Предотвращение вторжений** вычисляет репутацию исполняемых файлов и ограничивает действия программ с плохой или неизвестной репутацией. Репутацию программ поставляет Kaspersky Security Network или администратор, через настройки политики.

**Анализ поведения** следит не за отдельными действиями программ, а за тем, что они делают вообще. Для этого он записывает все, что делают программы в журнал и потом ищет в последовательности действий признаки вредоносной активности. С помощью журнала действий Откат вредоносных действий откатывает действия вредоносных программ.

У Анализа поведения есть специальные эвристики, чтобы обнаруживать действия программ-вымогателей, которые шифруют документы и требуют выкуп. Во многих случаях Анализ поведения с помощью Отката вредоносных действий может восстановить зашифрованные документы.

Чтобы лучше защититься от программ-вымогателей, настройте Предотвращение вторжений блокировать доступ к документам программам с плохой репутацией.

> Не выключайте Анализ поведения и Предотвращение вторжений. Это компоненты, в которых реализованы передовые технологии для защиты от самых сложных угроз

### 6. Как контролировать сетевые соединения

#### 6.1. Как Сетевой экран защищает от угроз

С точки зрения безопасности Сетевой экран выполняет две функции:
- Блокирует несанкционированные сетевые подключения к компьютеру, тем самым снижая вероятность его заражения
- Блокирует несанкционированную сетевую активность программ на клиентском компьютере. Это снижает риск возникновения эпидемий, а также ограничивает действия пользователей сознательно или неосознанно нарушающих политику безопасности

**Сетевой экран** тесно связан с **Предотвращением вторжений**. Предотвращение вторжений ограничивает доступ программ к настройкам операционной системы, другим программам и файлам пользователей. Сетевой экран смотрит на ту же репутацию программ и ограничивает их доступ к сети. Этим сетевой экран не дает уже запущенным вредоносным программам нанести ущерб: например, отправить пароли пользователя злоумышленнику.

Параллельно с Сетевым экраном пакеты анализирует **защита от сетевых угроз**. Если Сетевой экран использует относительно простые правила, чтобы блокировать пакеты и соединения, защита от сетевых угроз смотрит на последовательности пакетов и ищет в них следы сетевых атак, например, атак на переполнение буфера через известные уязвимости. Соединения, по которым идет атака, блокируются.

#### 6.2. Как работает сетевой экран в Kaspersky Endpoint Security

Сетевой экран контролирует соединения на сетевом и транспортном уровнях с помощью пакетных правил. Он анализирует водящие и исходящие пакеты, сравнивает их с имеющимися правилами и выполняет одно из двух действий:
- Разрешить
- Блокировать

###### Как сетевой экран анализирует пакеты и соединения

![[Pasted image 20260217132516.png]]

Сетевой экран смотрит на атрибуты пакета:
- Локальный и удаленный IP-адрес Протокол: `TCP`, `UDP`, `IGMP`, `GRE`, `ICMP`, `ICMPv6`
- Тип ICMP-пакета (`ICMP`)
- Локальный и удаленный порт (`TCP`,`UDP`)
- Направление: входящий, исходящий
- Сетевой интерфейс
- `TTL` (Time-to-ive)
- Процесс

Ищет **первое** подходящее правило и **применяет** его

Самая простая часть Сетевого экрана Kaspersky Endpoint Security это список пакетных сетевых правил. Чтобы его увидеть, откройте раздел Сетевой экран в политике Kaspersky Endpoint Security и перейдите по ссылке Сетевые пакетные правила.

Пакетное правило содержит следующие атрибуты:

| Действие         | Разрешать, Запрещать или По правилам программы<br>По правилам программы означает, что Сетевой экран пойдет искать подходящее правило в настройках программы, к которой относится пакет. А если у этой программы нет настроек, то в настройках репутационной группы, в которую входит программа                                                                                                                                                                                                                                                                                                                       |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Протокол         | `TCP`, `UDP`, `ICMP`, `ICMPv6`, `IGMP`, `GRE`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Направление      | **Входящее (пакет)** — применяется к входящим пакетам<br>**Входящее** — применяется к пакетам во входящих соединениях<br>**Входящее/исходящее** — применяется ко всем пакетам<br>**Исходящее (пакет)** — применяется к исходящим пакетам<br>**Исходящее** — применяется во всех пакетах в исходящих соединениях<br>Протокол TCP устанавливает соединения, поэтому вместе с протоколом TCP используйте направления Входящее, Исходящее и Входящее/Исходящее<br>Остальные протоколы не устанавливают соединения, а посылают пакеты. Вместе с ними используйте Входящее (пакет), Исходящее (пакет) и Входящее/Исходящее |
| Удаленные порты  | Порты на удаленном компьютере<br>Можно задать для протоколов TCP и UDP<br>Чтобы задать несколько портов, перечислите их через запятую: например, 25, 110<br>Чтобы указать диапазон, используйте дефис: 0-1024                                                                                                                                                                                                                                                                                                                                                                                                        |
| Локальные порты  | Порты на локальном компьютере<br>Можно задать для протоколов `TCP` и `UDP`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ICMP-тип         | Эхо-запрос, ответ на эхо-запрос, истекло время жизни пакета, цель недоступна и т.д.<br>Можно выбрать для протоколов ICMP и ICMPv6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ICMP-код         | Уточняющий код для некоторых ICMP-типов. Можно выбрать код `0`, `1` или `2`<br>Например для ICMP-пакета Цель недоступна, код `0` означает Сеть недоступна, код `1` — Хост недоступен, код `2` — Протокол недоступен                                                                                                                                                                                                                                                                                                                                                                                                  |
| Сетевые адаптеры | Позволяет указать сетевой адаптер по типу интерфейса. IP-адресу и МАС-адресу<br>Типы интерфейсов: Loopback, Проводная сеть (Ethernet), Беспроводная сеть (Wi-Fi), Туннель, PPP-соединение, РРРоЕ-соединение, VPN-соединение, Модемное соединение                                                                                                                                                                                                                                                                                                                                                                     |
| TTL              | Время жизни пакета                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Удаленные адреса | Адреса удаленных компьютеров, которые можно задать прямо или косвенно<br>Чтобы задать адреса прямо, выберите Адреса из списка и наполните список IP-адресов<br>Чтобы задать адреса косвенно, выберите Любой адрес или Адрес подсети. Адрес подсети может быть: Доверенные сети, Локальные сети и Публичные сети                                                                                                                                                                                                                                                                                                      |
| Локальные адреса | Адреса локального компьютера (у компьютера может быть много адресов)<br>Можно выбрать или Любой адрес, или Адреса из списка и наполнить список                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

Сетевой экран сравнивает атрибуты пакета с атрибутами правила, и если все они совпадают — протокол, порты, направление, сетевой адаптер, локальный адрес, удаленный адрес —то применяет действие, указанное в правиле.

Применение правила может сопровождаться записью в журнале работы сетевого экрана. За это отвечает параметр **Записать в отчет**.

Сетевой экран смотрит на правила по порядку **сверху вниз** и **применяет первое подходящее**. Чтобы изменить порядок правил, выберите правило и переместите его кнопками **Вверх** и **Вниз**.

###### Как сетевой экран решает, какие сети локальные?

![[Pasted image 20260217133748.png]]

Адреса удаленных компьютеров в правилах могут быть заданы косвенно, как Адреса подсети: Доверенные сети, Локальные сети или Публичные сети. Как Сетевой экран решает, какие адреса относятся к каким сетям?

Статусы сетей указывает администратор в политике Kaspersky Endpoint Security. А если политика ничего не говорит о статусе сети, Сетевой экран определяет статус сетей самостоятельно на клиентском компьютере.

Чтобы добавить в политику сеть и выбрать ее статус:
1. Нажмите ссылку **Настройка сети** в разделе `Базовая защита | Сетевой экран`
2. Нажмите кнопку **Добавить** над списком
3. Введите удобное имя подсети и выберите ее тип
4. Укажите адрес подсети в формате <IР-адрес>/<длина маски в битах>, например `192.168.0.0/24`

На компьютере к сетям из политики Сетевой экран добавляет сети, настроенные для сетевых адаптеров компьютера. Если сеть адаптера совпадает или входит в сеть из политики, она получает статус сети из политики.

Если сеть адаптера не входит ни в одну из сетей из политики, Сетевой экран выбирает ей статус исходя из статуса сети в операционной системе. Если сеть доменная, рабочая или домашняя, Сетевой экран дает ей статус Локальной сети. Если сеть публичная в операционной системе, она будет публичной и для Сетевого экрана Kaspersky Endpoint Security.

Все остальные адреса считаются адресами публичных сетей.

#### 6.3. Что делает сетевой экран с настройками по умолчанию

1. Разрешает DNS и почту программам с позитивной репутацией(`Доверенные` и `Слабые ограничения`)
2. Запрещает `DNS` и почту программам с негативной репутацией (`Сильные ограничения` и `Недоверенные`)
3. Разрешает всем программам прочую сетевую активность в доверенных сетях
4. Разрешает сетевую активность в локальных сетях программам с позитивной репутацией
5. Запрещает удаленный доступ к рабочему столу и общим папкам в публичных сетях
6. Разрешает прочую сетевую активность в публичных сетях программам с положительной репутацией
7. Запрещает прочую сетевую активность в публичных сетях программам с отрицательной репутацией
8. Разрешает ответы на исходящие ICMP-запросы в публичных сетях
9. Запрещает входящие ICMP-запросы в публичных сетях

###### Что если сетевой экран мешает работать программе

Подавляющее большинство программ, использующих сеть, автоматически относятся к группам **Доверенные** и **Слабые ограничения**, и поэтому могут беспрепятственно обмениваться данными по сети.

Но малоизвестные программы с открытым кодом или программы собственной разработки могут получить репутацию **Сильные ограничения** и не смогут работать с сетью.

Чтобы дать доступ к сети программам с репутацией Сильные ограничения, используйте один из следующих подходов:
- Измените репутацию программы, добавьте ее исполняемый файл в репутацию Слабые ограничения или доверенные, как описано в разделе 4.3
- Если файлы программы подписаны сертификатом, используйте настройки Предотвращения вторжений, чтобы доверять файлам этой программы
- Если файлы не подписаны сертификатом, подумайте над тем, чтобы подписать их самоподписанным сертификатом и использовать настройки исключений, чтобы доверять этому сертификату
- Или разрешите адреса и порты, которые использует программа, простыми пакетными правилами. Пакетные правила обрабатываются раньше, чем правила для программ и репутаций.

> Поместите свои правила в начало списка пакетных правил

#### 6.4. Зачем нужна защита от сетевых угроз

Под сетевыми угрозами понимаются сканирование портов, атаки на отказ в обслуживании, атаки на переполнение буфера и другие способы удаленного вредоносного воздействия на программы и службы, запущенные на компьютере.

Защита от сетевых угроз работает на основании сигнатур и блокирует все соединения, которые соответствуют описаниям известных сетевых атак.

Защита от сетевых угроз практически не имеет настраиваемых параметров. Если компонент включен, то атаки блокируются автоматически.

В качестве дополнительной реакции Kaspersky Endpoint Security может блокировать все пакеты с атакующего компьютера в течение некоторого заданного времени. За это отвечает опция Добавить атакующий компьютер в список блокирования на NN мин., которая по умолчанию включена и блокирует компьютеры на 60 минут. При необходимости заблокированный компьютер можно разблокировать вручную, но только в локальном интерфейсе Kaspersky Endpoint Security.

> Иногда Защита от сетевых угроз считает большое количество пакетов от камер наблюдения и других подобных устройств атакой, и блокирует пакеты. Чтобы этого избежать, добавьте адреса устройств в список исключений. Защита от сетевых угроз не будет анализировать пакеты с доверенных адресов.

###### Что делает защита от МАС-спуфинга

Предотвращает подмен у адресов в `ARP`-таблице, принимая только те ответы для которых был отправлен запрос

После выполнения `ARP`-запроса все ответы кроме первого игнорируются

#### 6.5. Защита сети: резюме

- Сетевой экран
	- Уменьшает поверхность атаки
	- Не дает вредоносным программам пользоваться сетью
	- Защищает общие папки в публичных сетях
- Защита от сетевых угроз
	- Защищает от атак через защищенные соединения
	- Защищает от модификации АРР таблиц
- Если компоненты мешают программе
	- Сделайте разрешающее правило в сетевом экране для портов программы
	- Сделайте программу доверенной
	- Добавьте адрес компьютера, на котором запущена программа, в исключения защиты от сетевых угроз

### 7. Как защитить компьютер за пределами сети

#### 7.1. Каким локальным сетям доверять

Внутри корпоративной сети компьютеры подвергаются меньшей опасности заражения, чем за ее пределами. Вполне разумно было бы менять настройки компьютеров, когда они перемещаются за пределы офиса.

В частности, политика по умолчанию считает все сети с адресами `10.0.0.0/8`, `172.16.0.0/12` и `192.168.0.0/16` локальными и разрешает в них доступ к общим папкам компьютера, службам Windows и доступ к рабочему столу компьютера по протоколу `RDP`.

Но за пределами сети компании адреса `10.0.0.0/8`,`172.16.0.0/12` и `192.168.0.0/16` могут быть у сетей отелей, кафе, аэропортов и других публичных точек доступа. Доверять им как локальным сетям опасно.

Используйте специальные политики для автономных пользователей, чтобы изменить настройки Kaspersky Endpoint Security за пределами сети компании.

#### 7.2. Как создать политику для компьютеров вне офиса

Политика **Для автономных пользователей** —это третий возможный статус политики, кроме **Активная** и **Неактивная**

Политика для автономных пользователей может быть в любой группе. Причем в группе может быть только одна политика для автономных пользователей для конкретной версии Kaspersky Endpoint Security. Распространяется такая политика точно так же, как и активная политика, но если активная политика применяется немедленно, то политика для автономных пользователей — только после выполнения специальных условий (см. ниже).

Если в дочерней группе нет своей политики для автономных компьютеров, в ней будет применяться политика для автономных пользователей ближайшей родительской группы. В то же время, если политика для автономных пользователей есть и в родительской, и в дочерней группе, между собой они никак не связаны. Какие бы параметры ни были обязательными в политике родительской группы, политику для автономных пользователей дочерней группы это никак не ограничивает.

Иными словами, отдельные настройки автономных политик не наследуются — в отличие от активных политик, где отдельные настройки, закрытые замком, наследуются политиками дочерних групп. Автономные политики наследуются только целиком — теми подгруппами, где нет своей автономной политики.

###### Когда компьютеры переходят на политику для автономных пользователей

По умолчанию, компьютеры никогда не переходят на политику для автономных пользователей. Чтобы они переходили на такую политику, задайте условия в политике Агента администрирования одним из двух способов:
1.	Включите параметр `Включить автономный режим`, когда Сервер администрирования недоступен Компьютеры будут переходить на автономную политику, если компьютер не подключен ни к какой сети, или если Агент администрирования три раза подряд не смог синхронизироваться с Сервером администрирования. На практике обычно это означает, что компьютер был отключен от корпоративной сети. По умолчанию период синхронизации равен 15 минутам. Следовательно, в автономный режим клиент переключится мгновенно после отключения сети или через 30-45 минут, если сеть не отключалась.
2.	Настройте сетевые местонахождения для профиля `<Офлайн-режим>`

Лучше настройте сетевые местонахождения. С их помощью можно точнее описать, когда компьютер находится в сети компании, а когда нет.

В политике Агента администрирования есть разные условия для описания сетевых местонахождений. Многие из них простые и понятные, например, адрес подсети компьютера или адрес основного шлюза. Но они не могут точно определить сеть компании. Допустим, во внутренней сети используется подсеть `192.168.0.0/24`. Такая же сеть может быть в отеле, в кафе или в бесплатной точке доступа на улице. Поэтому условия по адресу подсети, шлюза или DNS-сервера недостаточно надежные. Лучше используйте **Условие для разрешимости имен** и укажите имя, которое есть только на внутреннем DNS-сервере компании. Настройте компьютеры переходить в автономный режим, когда они не могут разрешить это имя:
1.	В политике Агента администрирования откройте `Параметры программы | Сеть` и в области **Профили соединений** нажмите кнопку **Параметры**
2.	Добавьте параметры сетевого местоположения: нажмите кнопку Добавить над верхним списком
3.	Дайте сетевому местонахождению понятное название, например, `«Недоступно имя <внутреннее DNS-имя»`) и включите параметр **Описание активно**
4.	В поле Использовать профиль подключения выберите профиль `<Офлайн-режим>`
5.	Добавьте условие типа **Условие для разрешимости имен**
6.	Добавьте в список значений имя, которое разрешимо только во внутренней сети
7.	Под списком **DNS- или NetBIOS-имя устройства** переключите параметр в состояние **Не соответствует ни одному из значений списка**. Это будет означать, что условие срабатывает, если указанное имя разрешить не удается
8.	Сохраните условие

#### 7.3. Какие настройки задать компьютерам вне офиса

- Разрешите пользователю **запускать и останавливать задачи**
- Не доверяйте локальным сетям

### 8. Что еще есть в защите и зачем

#### 8.1. Что делает и зачем нужна самозащита

В Kaspersky Endpoint Security реализована технология самозащиты, предотвращающая несанкционированное отключение продукта и другие попытки нарушить его нормальное функционирование. Работа самозащиты регулируется двумя опциями в разделе `Общие настройки | Параметры программы | Настройки программы`:
- Параметр **Включить самозащиту** отвечает за защиту процессов Kaspersky Endpoint Security в оперативной памяти компьютера, его исполняемых и вспомогательных файлов на жестком диске и ключей в реестре системы
- Опция **Выключить возможность внешнего управления системными службами** не дает остановить службы8 Kaspersky Endpoint Security, кроме как через интерфейс продукта

#### 8.2. Что делает защита от атак BadUSB

Прошивка любой флэшки может быть модифицирована. При подключении к компьютеру, такая флэшка, может опознаваться операционной системой как другое устройство и скрытно выполнять ряд функций, предусмотренных злоумышленником. Например, флэшка может опознаваться как клавиатура и отправлять команды от имени вошедшего в систему пользователя. На практике, это могут быть совершенно любые действия: скрытая загрузка вредоносной программы или перехват и отправка конфиденциальных данных. И даже если пользователь не обладает правами Администратора в системе, это не решит проблему, так как существуют различные способы повышения привилегий, а прав обычного пользователя обычно хватает, чтобы организовать утечку данных.

Компонент Защита от атак `BadUSB` не позволяет подключаться USB-устройствам в качестве клавиатуры без авторизации пользователем. Происходит это следующим образом, при подключении USB-устройства, если оно опознается операционной системой как клавиатура, Защита от атак `BadUSB` вводит пользователю уведомление и просит пользователя авторизовать устройство.

По умолчанию компонент Защита от атак `BadUSB` не устанавливается на компьютеры. При необходимости, его можно до установить с помощью задачи Kaspersky Endpoint Security Смена состава компонентов. Компонент Защита от атак `BadUSB` рекомендуется устанавливать на ноутбуки.

#### 8.3. Как защитить Kaspersky Endpoint Security от пользователя

