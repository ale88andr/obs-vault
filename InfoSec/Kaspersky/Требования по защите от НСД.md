#Версия3

Организационно-технические меры защиты от НСД 

Должен быть реализован следующий комплекс организационно-технических мер защиты от НСД: 
- В системе регистрируется один пользователь с именем root, обладающий правами администратора, на которого возлагается обязанность конфигурировать ОС Windows, настраивать безопасность ОС, а также конфигурировать ПЭВМ, на которую установлена ОС Windows. 
- Для администратора выбирается надежный пароль входа в систему, удовлетворяющий следующим требованиям: длина пароля не менее 6 символов, среди символов пароля встречаются заглавные символы, прописные символы, цифры и специальные символы, срок смены пароля не реже одного раза в месяц, доступ к паролю должен быть обеспечен только пользователю root.
- Всем пользователям, зарегистрированным в ОС Windows, администратор в соответствии с политикой безопасности, принятой в организации, дает минимально возможные для нормальной работы права. Каждый пользователь ОС Windows, не являющийся администратором, может просматривать и редактировать только свои установки в рамках прав доступа, назначенных ему администратором. 
- На компьютере устанавливается только одна ОС Windows. Не используют нестандартные, измененные или отладочные версии ОС Windows такие, например, как Debug/Checked Build. На всех HDD должна быть установлена файловая система NTFS. 
- Права доступа к каталогам `%Systemroot%\System32\Config`, `%Systemroot%\System32\SPOOL`, `%Systemroot%\Repair`, `%Systemroot%\COOKIES`, `%Systemroot%\FORMS`, `%Systemroot%\HISTORY`, `%Systemroot%\SENDTO`, `%Systemroot%\PROFILES`, `%Systemroot%\OCCASHE`, `\TEMP`, а также файлам `boot.ini`, `autoexec.bat`, `config.sys`, `ntdetect.com` и `ntldr` должны быть установлены в соответствии с политикой безопасности, принятой в организации. 
- Должны быть установлены ограничения на доступ пользователей к системному реестру в соответствии с принятой в организации политикой безопасности, что реализуется при помощи ACL или установкой прав доступа при наличие NTFS. 
- Должна быть исключена возможность удаленного редактирования системного реестра. 
- Должна быть проведена установка `SECURITY_ATTRIBUTES` процессов и потоков в соответствии с требованиями безопасности всей системы в целом. 
- Если нет необходимости, не следует использовать протокол `SMB`. В случае необходимости использования протокола `SMB` параметры `EnableSecuritySignature (REG_DWORD)` и `RequareSecuritySignature(REG_DWORD)` в ключе `HKLM\System\CurrentControlSet\Services\LanManServer\Parametrs` должны быть установлены со значениями `1`. 
- У группы `Everyone` должны быть удалены все привилегии. 
- Должен быть переименован пользователь `Administrator`. 
- Должна быть отключена учетная запись для гостевого входа (`Guest`); 
- Должно быть исключено использование режима автоматического входа пользователя в операционную систему при ее загрузке. 
- Должно быть ограничено с учетом выбранной в организации политики безопасности использование пользователями сервиса `Sheduler`. 
- Должен быть отключен сервис `DCOM`. 
- Должны быть отключены сетевые протоколы, не используемые на данной ПЭВМ. В случае подключения ПЭВМ с установленным СКЗИ к общедоступным сетям передачи данных должно быть исключено использование `JavaScript`, `VBScript`, `ActiveX` и других программных объектов, загружаемых из сети. 
- Должна быть исключена возможность сетевого администрирования для всех, включая группу `Administrators`.  
- Должен быть закрыт доступ ко всем не используемым портам. 
- Должны включаться фильтры паролей, устанавливаемые вместе с пакетами обновлений ОС `Windows`. 
- Должны быть исключены исполнение и открытие файлов, полученных из общедоступных сетей передачи данных, без проведения соответствующих проверок на предмет содержания в них программных закладок и вирусов. 
- Должны быть удалены все общие ресурсы на ПЭВМ с установленным СКЗИ «КриптоПро CSP» (в том числе и создаваемые по умолчанию при установке ОС Windows, которые не используются. Права доступа к используемым общим ресурсам должны быть заданы в соответствии с политикой безопасности принятой в организации. 
- После установки операционной системы из каталога `%Systemroot%\System32\Config` должен быть удален файл `sam.sav`. 
- Должны использоваться наиболее защищенные протоколы аутентификации, реализованные в Windows, если функционирование СКЗИ не предусматривает применение других протоколов. 
- По возможности следует применять самые сильные шаблоны безопасности (Templates).
- Должна быть разработана система назначения и смены паролей. 
- Должно быть запрещено использование функции резервного копирования паролей. 
- Должны быть отключены режимы отображения окна всех зарегистрированных на ПЭВМ пользователей и быстрого переключения пользователей. 
- Должна быть отключена возможность удаленного администрирования ПЭВМ с установленным СКЗИ «КриптоПро CSP» 
- Должно быть ограничено количество неудачных попыток входа в систему, в соответствие с политикой безопасности, принятой в организации. Рекомендуется блокировать систему после трех неудачных попыток. 
- Должны использоваться система аудита в соответствие с политикой безопасности, принятой в организации, и организован регулярный анализ результатов аудита. 
- Должен проводиться регулярный просмотр сообщений в журнале событий `Event viewer`. 
- ОС Windows должна быть настроена на завершение работы при переполнении журнала аудита. 
- Должна быть обеспечена невозможность модификации ОС Windows через общедоступные каналы передачи данных (`Windows Update`, `Remote Assistance`, и т.п.); 
- После инсталляции ОС Windows должен быть установлен последний официальный Service Pack от фирмы Microsoft, существующий на момент установки ОС Windows. 
- Должны использоваться подписанные драйверы. 
- На все директории, содержащие системные файлы Windows и программы из комплекта СКЗИ, должны быть установлены права доступа, запрещающие запись всем пользователям, кроме Администратора (Administrator), Создателя/Владельца (Creator/Owner) и Системы (System). 
- Должна быть исключена возможность создания аварийного дампа оперативной памяти, так как он может содержать криптографически опасную информацию. 

Настройка системного реестра ОС Windows 2000/XP/2003/7/2008R2 при установке СКЗИ На ПЭВМ с установленной ОС Windows 2000/XP/2003/7/2008R2 при установке СКЗИ необходимо внести следующие изменения в системный реестр: 
- в ключе `HKLM\System\CurrentControlSet\Control\LSA`, установить параметр `RestrictAnonymous (REG_DWORD)` со значением `1` для исключения доступа анонимного пользователя (null-session) к списку разделяемых ресурсов, а также для исключения доступа к содержимому системного реестра; 
- для исключения утечки информации при передаче данных по именованному каналу `\\server\PIPE\SPOOLSS` удалить имя `SPOOLSS` из ключа `HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\NullSessionPipes`; 
- в ключе `HKLM\System\CurrentControlSet\Services\LanManServer\Parameters` установить параметры `AutoShareWks` и `AutoShareServer`, имеющие тип `REG_DWORD`, со значением `0` для запрета автоматического создания скрытых совместных ресурсов; 
- в ключе `HKLM\Software\Microsoft\WindowsNT\CurrentVersion\Winlogon` установить параметр `CashedLogonCount` (`REG_DWORD`) со значением `0` для отключения кэширования паролей последних десяти пользователей, вошедших в систему; 
- в ключе `HKLM\System\CurrentControlSet\Services\Eventlog\` (`LogName` – имя журнала для которого следует ограничить доступ пользователям группы `Everyone`) установить параметр `RestrictGuestAccess` (`REG_DWORD`) со значением `1` для исключения доступа группы `Everyone` к системному журналу и журналу приложений; 
- в ключе `HKLM\System\CurrentControlSet\Control\ SessionManager\MemoryManagment` установить параметр `ClearPageFileAtShutDown` (`REG_DWORD`) со значением `1` для включения механизма затирания файла подкачки при перезагрузке; 
- в ключе `HKLM\System\CurrentControlSet\Control\SecurePipeServers\` установить в соответствии с политикой безопасности принятой в организации разрешения на доступ к параметру `winreg` для ограничения удаленного доступа к реестру; в ключе `HKLM\SOFTWARE\Microsoft\WindowsNT\СurrentVersion\Winlogon\` установить параметр `AllocateFloppies` (`REG_SZ`) со значением `1` для исключения параллельного использования дисковода для гибких дисков; в ключе `HKLM\System\CurrentControlSet\Control\Lsa` установить параметр `AuditBaseObjects` (`REG_DWORD`) со значением `1` для включения аудита на базовые объекты системы; в ключе `HKLM\System\CurrentControlSet\Control\Lsa` установить параметр `FullPrivilegeAuditing` (`REG_BINARY`) со значением `1` для включения аудита привилегий; 
- для исключения передачи паролей пользователей по сети в открытом виде (ОС Windows 2000/XP) в ключе `HKLM\SYSTEM\CurrentControlSet\Services\MRxSmb\Parameters` установить параметр `EnablePlainTextPassword` (`REG_DWORD`) со значением `0`.

#Версия5

Требования по защите от НСД 

Должны выполняться требования по организационно-техническим и административным мерам обеспечения безопасности эксплуатации СКЗИ в объеме раздела раздела 5 ЖТЯИ.00101-02 95 01. Правила пользования. 

Для ОС Windows дополнительно должен быть реализован следующий комплекс организационнотехнических мер защиты от НСД: 
1) На всех `HDD/SSD` должна быть установлена файловая система `NTFS`. 
2) Права доступа к системным и критичным каталогам (например, `%Systemroot%\System32\config`) должны быть установлены в соответствии с политикой безопасности, принятой в организации. На все директории, содержащие системные файлы Windows и программы из комплекта СКЗИ, должны быть установлены права доступа, запрещающие запись всем, кроме пользователей Администратор (Administrator), СОЗДАТЕЛЬ-ВЛАДЕЛЕЦ (CREATOR OWNER) и СИСТЕМА (SYSTEM). 
3) Должны быть установлены ограничения на доступ пользователей к системному реестру в соответствии с принятой в организации политикой безопасности (например, с помощью ACL). 
4) Должна быть исключена возможность удаленного редактирования системного реестра (например, с помощью параметров ветки реестра `HKLM\System\CurrentControlSet\Control\SecurePipeServers\winreg`). 
5) Не рекомендуется использовать протокол `SMB`. В случае необходимости использования протокола `SMB` следует включить режимы подписи для `SMB-пакетов` (с помощью установки параметров реестра `EnableSecuritySignature` и `RequireSecuritySignature` ветки `HKLM\System\CurrentControlSet\Services\ LanManServer\Parameters` в значение «`1`») и запретить передачу незашифрованного пароля сторонним `SMB-серверам` (установив параметр `EnablePlainTextPassword` ветки реестра `HKEY_LOCAL_MACHINE\SYSTEM\ CurrentControlSet\Services\LanmanWorkstation\Parameters` в значение «`0`»). 
6) У группы `Everyone` должны быть удалены все привилегии. 
7) Должен быть переименован пользователь `Administrator`. 
8) Должна быть отключена учетная запись для гостевого входа (`Guest`). 
9) Должно быть исключено использование режима автоматического входа пользователя в операционную систему при ее загрузке. 
10) Должно быть ограничено с учетом выбранной в организации политики безопасности использование пользователями Планировщика заданий (`Task Scheduler`). 
11) Должны использоваться наиболее защищенные протоколы аутентификации, реализованные в ОС Windows, если функционирование СКЗИ не предусматривает применение других протоколов. 
12) По возможности следует применять самые сильные шаблоны безопасности (Templates). 
13) Должно быть запрещено использование функции резервного копирования паролей. 
14) Должны быть отключены режимы отображения всех зарегистрированных на ПЭВМ пользователей и быстрого переключения пользователей. 
15) Должен проводиться регулярный просмотр сообщений в журнале событий `Event Viewer` с периодичностью не реже 1 раза в неделю. 
16) В настройках ОС, отвечающих за ведение журналов событий, необходимо установить режим архивирования журнала при его заполнении, либо ОС Windows должна быть настроена на завершение работы в случае переполнения журнала аудита (например, с помощью групповой политики «Аудит: немедленное отключение системы, если невозможно внести в журнал записи об аудите безопасности»).
17) Должны использоваться только подписанные драйверы. 
18) Должен быть исключен доступ анонимного пользователя (null-session) к списку разделяемых ресурсов и содержимому системного реестра (например, с помощью установки параметра реестра `RestrictAnonymous` ветки `HKLM\SYSTEM\CurrentControlSet\Control\Lsa` в значение «`1`»). 
19) Необходимо запретить анонимный доступ к именованному каналу `SPOOLSS` (например, удалив имя `SPOOLSS` из ключа `HKLM\System\CurrentControlSet\Services\LanManServer\Parameters\ NullSessionPipes`). 
20) Необходимо запретить автоматическое создание скрытых совместных ресурсов (например, с помощью установки параметров реестра `AutoShareWks` и `AutoShareServer` ветки `HKLM\SYSTEM\ CurrentControlSet\Services\LanManServer\Parameters` в значение «`0`»). 
21) Необходимо отключить кэширование паролей последних 10 пользователей, вошедших в систему (например, с помощью ключа реестра `HKLM\Software\Microsoft\WindowsNT\CurrentVersion\Winlogo`n, установив параметр `CachedLogonsCount` со значением «`0`»). 
22) Необходимо запретить параллельное использование дисководов несколькими пользователями (например, с помощью ключа реестра `HKLM\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Winlogon`, установив параметры `AllocateFloppies` и `AllocateCDRoms` со значением «`1`»).