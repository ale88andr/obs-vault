### 1. Как вредоносные программы попадают на компьютер

#### 1.1 Через браузер:
- Загрузка с диска (без согласия пользователя)
- За счет обмана пользователя

###### Уязвимый веб-браузер

У пользователя установлен уязвимый браузер. Используя уязвимость, веб-страница может заставить браузер загрузить и запустить на компьютере любую программу. Пользователь заходит на сомнительный веб-сайт — веб-сайт запускает на компьютере пользователя вредоносную программу. Вредоносный код может быть не на основных страницах веб-сайта, а в рекламных блоках, которые веб-сайт получает с других ресурсов.

**Чтобы защититься от такой атаки**:
- Устанавливайте обновления для веб-браузеров
- Не давайте пользователям запускать какие угодно браузеры
- Не давайте пользователям заходить на какие угодно веб-страницы
- Не давайте пользователям заходить известные зараженные сайты
- Не давайте веб-браузерам запускать дочерние процессы

###### Зараженный файл

Пользователь ищет в Интернете бесплатную программу. Например, бесплатную утилиту, которая делает что-то полезное для пользователя, или пиратскую версию платной программы, или генератор ключей для платной программы. Находит, загружает на компьютер и запускает.
Программа оказывается вредоносной. Может быть пользователь не разобрался и загрузил файл с подходящим названием с «интернет -помойки». Может быть злоумышленники подменили код у бесплатной программы или взломали страницу загрузки и подменили программу.

**Чтобы защититься от такой атаки**:
- Не давайте пользователям заходить на какие угодно веб-страницы
- Не давайте пользователям заходить известные сайты с вредоносными программами
- Проверяйте файлы, которые пользователь загружает из Интернет, средством защиты от угроз

#### 1.2 Через почту:
- Во вложении пользователь сам запускает
- Ссыпки в тепе письма на вредоносные веб-сайты

Пользователь получает по почте письмо, которое выглядит как письмо из банка, магазина, службы доставки, от партнера, знакомого и т.п. Текст письма просит перейти по ссылке или открыть вложение. По ссылке находится вредоносный или фишинговый веб-сайт. Во вложении — вредоносная программа или документ с вложенной вредоносной программой.

**Чтобы защититься от такой атаки**:
- Фильтруйте почту средствами защиты от спама (массовых анонимных рассылок)
- Проверяйте файлы, вложенные в электронные письма, средством защиты от угроз
- Не давайте пользователям сохранять на диск исполняемые файлы из электронных писем
- От ссылок в письмах защищайтесь как от атак через веб-браузер

#### 1.3 Через сменные носители
- Которые пользователь принес из дома или нашел на парковке

###### Своя «флешка»

Пользователь подключил к компьютеру флешку, скопировать на нее или с нее документы. На флешке есть вредоносная программа, которая использовала уязвимость в операционной системе, чтобы автоматически запуститься на компьютере. Либо пользователь подключил флешку, чтобы посмотреть, что на ней. Обнаружил документ или исполняемый файл с интригующим названием и решил открыть его. Файл оказался зараженным.

**Чтобы защититься от такой атаки**:
- Не разрешайте пользователям подключать к компьютеру неизвестные (или все) флешки — Проверяйте файлы на флешках средством защиты от угроз
- Устанавливайте обновления безопасности для операционной системы

###### BadUSB

Пользователь подключил к компьютеру USB-устройство, которое выглядит как флешка. Устройство зарегистрировалось в операционной системе как флешка, и как клавиатура. Через некоторое время устройство начало давать компьютеру команды, посылая сигналы нажатия клавиш.

**Чтобы защититься от такой атаки**, используйте средства защиты от атак BadUSB

#### 1.4 С других зараженных компьютеров по сети
- Пользователь сам копирует файл из общей палки
- Вредоносные программы атакуют уязвимые службы и программы на компьютере пользователя

###### Из общей папки

Пользователь скопировал из общей папки на другом компьютере программу и запустил ее. Программа оказалась вредоносной. Пользователь открыл документ из общей папки на другом компьютере. В документе был вредоносный код.

**Чтобы защититься от такой атаки**:
- Установите средства защиты на все компьютеры
- Проверяйте файлы, которые пользователи копируют, открывают или запускают

###### Атака по сети

В операционной системе на компьютере пользователя есть уязвимость. Если послать на определенный порт специальную последовательность пакетов, можно заставить уязвимую службу выполнить код, который содержится в этих пакетах. Зараженный компьютер в сети атакует уязвимую службу на всех окрестных компьютерах и заражает их.

**Чтобы защититься от такой атаки**:
- Устанавливайте обновления безопасности для операционной системы
- Запрещайте соединения с портами, которые не нужны для работы пользователя
- Проверяйте пакеты, которые принимает компьютер, на предмет сетевых атак средством защиты от угроз

### 2. Как вредоносные программы наносят вред

#### 2.1. Вымогатели

Вредоносная программа вымогатель шифрует документы и другие файлы на компьютере и в общих папках, и просит деньги за то, чтобы дать ключ шифрования. Ключ хранится на сервере злоумышленников. Вредоносная программа или загружает ключ с сервера, шифрует файлы и удаляет ключ; или формирует случайный ключ, посылает его на сервер, шифрует файлы и ключ удаляет. В любом случае программа-вымогатель связывается со своим сервером по сети.

**Чтобы защититься от такой атаки**:
- Регулярно делайте резервные копии всех важных файлов
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения 
- Используйте средства защиты, которые эвристически обнаруживают шифрование

#### 2.2. Шпионы

Вредоносная программа ищет незашифрованные или слабо зашифрованные пароли в настройках программ и в файлах на диске. Вредоносная программа перехватывает все, что вводит пользователь с клавиатуры, делает скриншоты экрана и снимки через веб-камеру. Все это программа оправляет на сервер злоумышленникам.

**Чтобы защититься от такой атаки**:
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения
- Используйте средства защиты, которые эвристически обнаруживают шпионские действия

#### 2.3. Сетевые вредоносные программы

Вредоносная программа записывает себя на подключенные к компьютеру флешки и в общие папки по сети. Вредоносная программа заражает соседние компьютеры через уязвимые службы. Вредоносная программа по команде из центра рассылает спам и участвует в DDOS-атаках.

**Чтобы защититься от такой атаки**:
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения
- Используйте средства защиты, которые эвристически обнаруживают опасные действия

#### 2.4. Загрузчики

Часто, чтобы заразить обойти средства защиты и заразить компьютер, злоумышленники используют очень простые файлы, которые не несут никакого прямого ущерба. Но эти файлы могут загрузить дополнительные вредоносные файлы, которые уже могут шифровать документы, воровать пароли и т.д.

**Чтобы защититься от такой атаки**:
- не давайте неизвестным программам устанавливать и принимать сетевые соединения

#### 2.5. Некачественные вредоносные программы

Вредоносная программа приводит к тому, что другие программы зависают или работают с ошибками, компьютер тормозит, спонтанно перезагружается и выводит синий экран.

**Чтобы защититься от такой атаки**:
- регулярно проверяйте файлы на компьютере средством защиты от угроз

#### 2.6. Компоненты Kaspersky Endpoint Security

| Потенциальные цели атак                                                           | Компонент                                |
| --------------------------------------------------------------------------------- | ---------------------------------------- |
| Устанавливайте обновления безопасности для операционной системы                   | Kaspersky Security Center                |
| Устанавливайте обновления для веб-браузеров и других программ                     | Kaspersky Security Center                |
| Не давайте пользователям запускать какие угодно браузеры                          | Контроль программ                        |
| Не давайте пользователям заходить на какие угодно вебстраницы                     | Веб-контроль                             |
| Не давайте веб-браузерам запускать дочерние процессы                              | Анализ поведения<br>Защита от эксплойтов |
| Не давайте пользователям сохранять на диск исполняемые файлы из электронных писем | Защита от почтовых угроз                 |
| Запрещайте соединения с портами, которые не нужны для работы пользователя         | Сетевой экран                            |
| Не разрешайте пользователям подключать к компьютеру неизвестные (или все) флешки  | Контроль устройств                       |
| Не давайте неизвестным программам устанавливать и принимать сетевые соединения    | Сетевой экран                            |

| Обнаружение атак                                                                                         | Компонент                                            |
| -------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| Установите средства защиты на все компьютеры                                                             | Kaspersky Security Center                            |
| Проверяйте файлы, которые пользователи копируют, открывают или запускают                                 | Защита от файловых угроз<br>Предотвращение вторжений |
| Проверяйте файлы на флешках средством защиты от угроз                                                    | Поиск вирусов                                        |
| Проверяйте файлы, вложенные в электронные письма, средством защиты от угроз                              | Защита от почтовых угроз                             |
| Проверяйте файлы, которые пользователь загружает из Интернет, средством защиты от угроз                  | Защита от веб-угроз                                  |
| Не давайте пользователям заходить известные зараженные и фишинговые сайты                                | Защита от веб-угроз                                  |
| Не давайте пользователям заходить известные сайты с вредоносными программами                             | Защита от веб-угроз                                  |
| Проверяйте пакеты, которые принимает компьютер, на предмет сетевых атак средствам защиты от угроз        | Защита от сетевых угроз                              |
| Не давайте пользователям возможность автоматически подключать любые USB устройства в качестве клавиатуры | Защита от атак BadUSB                                |
| Используйте средства защиты, которые эвристически обнаруживают опасные действия                          | Защита от атак BadUSB                                |
| Используйте средства защиты, которые эвристически обнаруживают опасные действия                          | Анализ поведения<br>Предотвращение вторжений         |
| Регулярно проверяйте файлы на компьютере средством защиты от угроз                                       | Поиск вирусов                                        |

### 3. Как настроить защиту файлов

#### 3.1. Как Kaspersky Endpoint Security защищает файлы?

С помощью драйвера `klif.sys` Защита от файловых угроз перехватывает все файловые операции (такие как, чтение, копирование, выполнение) и проверяет файлы, с которыми выполняются действия. В случае если файл заражен, операция блокируется, а сам файл лечится или удаляется.

Можно отключить Защиту от почтовых угроз и Защиту от веб-угроз, но пользователь все равно не сможет запустить зараженный файл, полученный по почте или из сети Интернет. В момент сохранения файла на диск его обнаружит и заблокирует Защита от файловых угроз. А запустить файл из вложения или веб-страницы без сохранения на диск нельзя.

Поэтому Защита от файловых угроз — один из важных компонентов Kaspersky Endpoint Security.

Защита от файловых угроз ищет вредоносные программы с помощью:
- Сигнатур вредоносных программ — база сигнатур — это «стоп-лист» известных вредоносных файлов. Если файл не соответствует ни одной записи в базе, значит он не вредоносный. Полноценный список, где у каждого известного вредоносного или зараженного файла есть отдельная запись, требует слишком много места, поэтому база сигнатур — это оптимизированный список, уменьшенный до размера, который можно загрузить на компьютер. Каждая запись идентифицирует семейство похожих угроз.
- Эвристического анализа (эмуляции выполнения) — помогает обнаруживать полиморфные вредоносные файлы, которые меняют свой код во время выполнения, и которые из-за этого сложно обнаружить по сигнатурам. Защита от файловых угроз запускает исполняемые файлы в специальной изолированной среде и ждет, не изменится ли код в памяти так, что начнет соответствовать сигнатуре.
- Проверки по `KSN` — Защита от файловых угроз посылает в KSN контрольную сумму файла и получает ответ: есть ли такой файл в базе KSN, и какая у него репутация. База KSN это и есть огромный список всех известных Лаборатории Касперского файлов (вернее, их контрольных сумм). В этом списке есть файлы с репутацией недоверенные. Это черный список, такие файлы Защита от файловых угроз блокирует. Есть файлы с репутацией доверенные. Это белый список, куда входят известные невредоносные файлы операционных систем и распространенных программ. Эти файлы Защита от файловых угроз не блокирует, даже если по сигнатурам они вредоносные. Вердикт KSN имеет больший приоритет, потому что KSN содержит больше информации, чем локальная база сигнатур.

Чтобы не замедлять компьютер, Защита от файловых угроз проверяет не все файлы, а только те файлы, которые могут заразить компьютер. Например, Защита от файловых угроз не проверяет архивы, потому что, чтобы запустить файл из архива, этот файл нужно извлечь. Если пользователь сам не извлек файл из архива, это делает операционная система незаметно для пользователя. В любом случае Защита от файловых угроз проверит и, если нужно, заблокирует извлеченные файлы.

Файлы, которые не проверила Защита от файловых угроз, проверяйте задачами поиска вирусов. Поиск вирусов проверяет файлы в указанной области и применяет те же методы, что и Защита от файловых угроз.

#### 3.2. Что и как настроить в Защите от файловых угроз

Защита от файловых угроз, как и Kaspersky Endpoint Security в целом, решает две задачи:
- Не дать вредоносным программам нанести ущерб
- Не мешать работать пользователю и программам

Чем больше файлов проверяет Защита от файловых угроз, тем лучше он решает первую задачу, и тем хуже вторую. И наоборот. Настройки по умолчанию обеспечивают баланс между защитой и производительностью. Меняя настройки, администратор может сместить баланс в ту или другую сторону.

###### Защита от файловых угроз проверяет не все типы файлов

Файлы, которые могут нанести вред компьютеру, это в основном исполняемые файлы, но не только. Документы Microsoft Office могут содержать исполняемый код (макросы), который может быть вредоносным. Даже документы без кода, некоторые графические файлы, могут использовать уязвимости в программах, которые их открывают, и заставить эти программы выполнить часть файла как код.

По умолчанию Защита от файловых угроз проверяет файлы по формату. Так Kaspersky Endpoint Security надежно защищает компьютер, поскольку проверяет все опасные файлы, но меньше загружает компьютер, поскольку проверяет не все файлы.

Проверять файлы только по расширению опасно. Например, вредоносный документ Word может иметь расширение `.123`, которое не входит в список проверяемых, но пользователь все равно может его открыть через контекстное меню Открыть с помощью. К тому же, проверять по расширению не намного быстрее, чем проверять по формату. Пользователь не заметит разницы в производительности.

Если администратор хочет улучшить производительность медленных компьютеров, лучше начать с исключений для программ, с которыми работают пользователи.

Эвристический анализ в Kaspersky Endpoint Security запускает исполняемый программы в изолированной среде и смотрит, что они делают. В первую очередь эвристический анализ помогает обнаруживать полиморфные вредоносные программы, которые меняют свой код во время выполнения.

###### Защита от файловых угроз не проверяет файлы, которые уже проверяла

Большая часть файлов на компьютере меняется редко, поэтому проверяя только новые и измененные файлы, Защита от файловых угроз почти не загружает компьютер. В первые несколько дней, пока все файлы для Kaspersky Endpoint Security новые, пользователь может ощущать, что компьютер работает медленнее. Но довольно скоро Защита от файловых угроз перестает заметно влиять на производительность.

> Не выключайте опцию Проверять только новые и измененные файлы в Защите от файловых угроз, это замедлит компьютер.

![[Pasted image 20260216115225.png]]

![[Pasted image 20260216115245.png]]

![[Pasted image 20260216115303.png]]

###### Как Kaspersky Endpoint Security узнает, какие файлы менялись, а какие нет?

Файловая система NTFS (и ее наследник ReFS) записывает, когда файлы меняются, и гарантирует целостность этих записей. Поэтому на дисках с файловой системой NTFS Kaspersky Endpoint Security просто смотрит на дату изменения файла.

Файловая система `FAT32` может не записывать дату изменения, и не защищает саму дату изменения от изменений. Вредоносная программа может изменить файл, а потом записать ему какую угодно дату изменения. Поэтому на дисках с файловой системой `FAT32` Kaspersky Endpoint Security сохраняет в специальную базу контрольные суммы проверенных файлов. При следующем обращении Kaspersky Endpoint Security заново вычисляет контрольную сумму и сравнивает ее с сохраненной. Если суммы отличаются, значит файл изменился, и Защита от файловых угроз его проверяет.

###### Защита от файловых угроз не проверяет составные файлы (архивы и пр.)

| Параметры программы \| Базовая защита \| Защита от файловых угроз \| Проверять архивы                                                                                                                | Значение параметра       |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| Защита от файловых угроз проверяет файлы внутри архивов форматов RAR, ARJ, ZIP, CAB, LHA, JAR, ICE. Для этого Защита от файловых угроз распаковывает файлы из архива во временную папку или в память | Включено                 |
| Защита от файловых угроз не распаковывает архивы и не проверяет файлы в них                                                                                                                          | Выключено (по умолчанию) |
Чтобы проверить файлы в архиве, Защита от файловых угроз распаковывает архив, и на это уходит много ресурсов компьютера. Сами по себе архивы не опасны. Даже если в архиве есть вредоносный файл, его нельзя запустить из архива. Пользователь либо сам распакует архив, либо это сделает операционная система незаметно для пользователя. В любом случае вредоносный файл попадает на диск, и Защита от файловых угроз проверяет его как обычный файл.

> Не включайте опцию Проверять архивы в Защите от файловых угроз. Это замедлит компьютер и не повлияет на защиту

| Параметры программы \| Базовая защита \| Защита от файловых угроз \| Проверять дистрибутивы                                                                                                                       | Значение параметра       |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| Защита от файловых угроз проверяет файлы внутри самораспаковывающихся архивов и установочных пакетов, таких, как MSI Для этого Защита от файловых угроз извлекает файлы из пакета во временную папку или в память | Включено                 |
| Защита от файловых угроз не проверяет самораспаковывающиеся архивы и установочные пакеты                                                                                                                          | Выключено (по умолчанию) |
Установочные пакеты Защитой от файловых угроз проверять не нужно. Если пользователь копирует пакет, он не может заразить компьютер. Если пользователь запускает пакет, пакет сам извлекает из себя файлы и сохраняет их на диск, где их и проверяет Защита от файловых угроз.

| Параметры программы \| Базовая защита \| Защита от файловых угроз \| Проверять файлы офисных форматов                                                       | Значение параметра       |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| Защита от файловых угроз проверяет исполняемые куски не только в самих документах Microsoft Office, но и в объектах, вложенных в документы Microsoft Office | Включено  (по умолчанию) |
| Защита от файловых угроз проверяет исполняемые куски только непосредственно в документах Microsoft Office, но не во вложенных в них объектах                | Выключено                |
У файлов `Microsoft Office` сложная структура. Можно сказать, что внутри у документа `Microsoft Office` своя собственная файловая система с дополнительными файлами. Когда пользователь вставляет в документ `Word` график, который он подготовил в `Excel`, `Microsoft Office` может добавить в документ `Word` весь документ `Excel`, со всеми данными, формулами и макросами.

> Не отключайте проверку документов офисных форматов. Не проверять объекты, вложенные в офисные документы опасно. В них могут быть вредоносные макросы, которые программы Office запускают, не сохраняя предварительно на диск.

###### Защита от файловых угроз удаляет вредоносные программы

Вредоносные программы, обнаруженные Защитой от файловых угроз, нельзя оставлять необработанными. Поэтому настройки действий Защиты от файловых угроз должны быть обязательными. Оптимальным выбором будет пытаться лечить, а если лечение невозможно, удалять зараженные файлы. Большинство вредоносных файлов неизлечимы, потому что не содержат ничего кроме вредоносного кода.

Перед лечением или удалением файла его копия помещается в резервное хранилище. Это делается на случай, если файл понадобится восстановить. Например, если в нем была критично важная информация, или если файл был удален в результате ложного срабатывания.

#### 3.3. Что делать если Защита от файловых угроз замедляет компьютер

- Не проверяйте папку медленной программы
- Не проверяйте файлы, с которыми работает медленная программа
- Не проверяйте сетевые диски
- Не проверяйте файлы, подписанные доверенными сертификатами
- Остановите Защиту от файловых угроз, пока работает медленная программа

###### Как исключить папку программы

![[Pasted image 20260216120802.png]]

Исключения настраиваются в политике Kaspersky Endpoint Security: откройте раздел` Параметры программы | Общие настройки` и нажмите ссылку `Исключения`.

Исключения для папок доступны по ссылке Исключения из проверки и применяются ко всем компонентам защиты. Исключения из проверки состоят из трех атрибутов:
- Файл или папка — имя файла или каталога, на который распространяется исключение. В имени объекта можно использовать переменные окружения (%systemroot%, %userprofile% и другие) и спецсимволы `«*»` и `«?»`
- Название объекта — имя игнорируемой угрозы (как правило, имя вредоносной программы), которое тоже можно задать с использованием спецсимволов
- Хеш объекта — контрольная сумма файла (`SHA-256`), на который распространяется исключение.
- Компоненты защиты— перечень компонентов защиты, на которые распространяется правило

###### Как исключить файлы, к которым обращается процесс

![[Pasted image 20260216122741.png]]

Если на компьютере запускаются особенно ресурсоемкие приложения, их работа может замедляться Защитой от файловых угроз. Особенно это касается программ, выполняющих много операций с файлами, например, резервного копирования или дефрагментации. Чтобы избежать замедления во время работы таких приложений, сделайте их доверенными.

Для этого в окне настройки исключений добавьте исполняемый файл в список Доверенные программы. В окне Программа укажите путь к исполняемому файлу, и выберите тип разрешенных действий — Не проверять открываемые файлы. Путь может содержать переменные среды и символов `“*”` и `“?”`

###### Как не проверять сетевые диски

> Не проверять сетевые диски опасно. Перед тем, как выключить проверку сетевых дисков, будьте уверены, что на всех компьютерах сети установлены средства защиты. Не отключайте проверку сетевых дисков «на всякий случай», а только если это решает проблему пользователей

Чтобы не проверять сетевые диски, измените область защиты в настройках защиты от файловых угроз.

###### Как применить настройки к компьютерам

Настройки политики должны быть обязательными, т.е. с закрытым замком. Настройки с незакрытым замком не применяются к компьютерам.

#### 3.4. Как и зачем проверять файлы по расписанию

Чем помогает поиск вирусов, если Защита от файловых угроз все равно проверяет все опасные файлы? Поиск вирусов:
- Не дает пользователям распространять вредоносные программы в архивах
- Обновляет кэши KSN, обновляет данные о контрольных суммах файлов, после чего Защита от файловых угроз может проверять меньше файлов
- Проверяет файлы, которые не менялись. Защита от файловых угроз не проверяет такие файлы и иногда это может быть опасно

Задачи поиска вирусов выполняют проверку теми же способами, что и Защита от файловых угроз — используя сигнатурный и эвристический анализ, а также KSN. Разница в том, что **Защита от файловых угроз проверяет файлы на лету, когда к ним происходит обращение, а задачи поиска вирусов проверяют файлы по расписанию или по запросу**.

Задачи поиска вирусов можно запускать в нерабочее время. В таком случае нет необходимости слишком уж экономить ресурсы и можно выполнять проверку более тщательно. Поэтому, задача поиска будет ожидать ответа из KSN для вынесения окончательного вердикта, независимо от результатов проверки с помощью сигнатур и эвристики. Кроме того, поиском вирусов можно проверить объекты, исключенные из проверки в Защите от файловых угроз — архивы, инсталляционные пакеты, прочие файлы незаражаемых форматов.

###### Где и как искать опасные файлы

Настройки поиска вредоносных файлов задавайте в задачах поиска вирусов.

![[Pasted image 20260216131226.png]]

> Начиная с одиннадцатой версии Kaspersky Security Center, мастер первоначальной настройки сервера администрирования больше не создает задачу Быстрого поиска вируса. По умолчанию, поиск вирусов на компьютерах осуществляется специальной локальной задачей `Scan_IdleScan`.

Задача `Scan_ldleScan` требует меньше ресурсов, по сравнению с обычной задачей поиска вирусов. Выполняется при простое компьютера, не отображает уведомления пользователю и не сбрасывает статус Давно не выполнялся поиск вирусов. Параметры проверки и область проверки данной задачи изменить нельзя.

Если вы решили использовать собственную задачу поиска вирусов, рекомендуется отключить задачу `Scan_IdleScan`. Чтобы отключить задачу `Scan_IdleScan`, в свойствах политики Kaspersky Endpoint Security, перейдите в раздел `Параметры программы | Локальные задачи | Фоновая проверка` и снимите отметку с опции **Включить фоновую проверку**.

###### Область проверки

Область проверки представляет собой список путей к папкам и файлам, которые проверяются во время работы задачи. При указании пути допускается использование переменных среды (например, `%systemroot%`), а также символов `*` и `?` в имени файла или папки. Для папок, можно дополнительно выбрать: проверять все содержимое, включая подпапки, или только файлы, расположенные непосредственно в каталоге. В случае если подпапки не проверяются, иконка объекта помечается небольшим красным значком "минус".

Помимо файлов или каталогов в качестве объекта проверки можно указать:
- Моя почта — файлы данных Outlook (`.pst` и `.ost`)
- Память ядра —область памяти ядра операционной системы
- Запущенные программы и объекты автозапуска — область памяти, занятая процессами, и исполняемые файлы программ, которые запускаются при старте системы. Дополнительно, если в свойствах задачи выбран этот объект, в ходе поиска будет выполняться проверка на наличие руткитов (скрытых объектов файловой системы)
- Загрузочные секторы — проверяются загрузочные секторы жестких и съемных дисков
- Системное резервное хранилище — проверка папок `System Volume Information`
- Все съемные диски — съемные диски, подключенные в данный момент к компьютеру
- Все жесткие диски — жесткие диски компьютера
- Все сетевые диски — все сетевые диски, подключенные к компьютеру

Сделайте задачу, которая проверяет весь компьютер раз в неделю или раз в две недели. Если для такой задачи нет времени, когда ее можно выполнить, проверяйте хотя бы критические области:
- Память ядра
- Запущенные процессы и объекты автозапуска
- Загрузочные секторы
- `%systemroot%`\
- `%systemroot%\system\`
- `%systemroot%\system32\`
- `%system root%\system32\drivers\`
- `%systemroot%\syswow64\`
- `%system root%\syswow64\drivers\`

###### Учетная запись

По умолчанию задачи поиска запускаются на клиентских компьютерах с правами учетной записи локальной системы. В случае если в область проверки задачи входят сетевые диски или другие объекты, доступ к которым открыт не для всех пользователей, задача проверки не сможет их просканировать. Чтобы решить проблему, укажите в свойствах задачи учетную запись, обладающую необходимыми правами.

#### 3.5. Защита файлов: резюме

- Защита от файловых угроз и задачи поиска дополняют друг друга, оба важны
- Если Защита от файловых угроз сильно замедляет работу:
	—	Регулярно выполняйте поиск вирусов, поиск вирусов обновляет кэш проверенных файлов
	— Создайте исключения для папок
	—	Создайте исключения для исполняемых файлов
	—	Не проверяйте файлы, подписанные доверенными сертификатами
	—	Не проверяйте сетевые диски, если они защищены локально
	—	В крайнем случае, приостанавливайте Защиту от файловых угроз на время работы программы
- Настройте поиск вирусов на всех дисках компьютера
- Если нет удобного времени для поиска вирусов, используйте проверку при простое

> Не выключайте Защиту от файловых угроз. Запланируйте поиск вирусов на компьютерах

### 4. Настройка защиты от угроз по сети

#### 4.1. Как работает защита сети

![[Pasted image 20260216132758.png]]

Сеть — это один из основных путей распространения вредоносных программ. Поэтому защита сети и проверка сетевого трафика играет важную роль в обеспечении безопасности компьютера. В Kaspersky Endpoint Security за поиск вредоносных программ в сетевом трафике отвечают компоненты **Защита от почтовых угроз** и **Защита от веб-угроз**:

| Компонент                | Функции                                                                                                |
| ------------------------ | ------------------------------------------------------------------------------------------------------ |
| Защита от почтовых угроз | Удаляет вредоносный код из почтовых сообщений и вложений Переименовывает потенциально опасные вложения |
| Защита от веб-угроз      | Не дает загружать вредоносные файлы<br>Не дает заходить на вредоносные и фишинговые сайты              |
![[Pasted image 20260216133107.png]]

Перехват сетевого трафика Kaspersky Endpoint Security осуществляет с помощью `NDIS-фильтра`. Драйвер перехватывает исходящие соединения от программ на компьютере и передает пакеты сетевым компонентам защиты. Kaspersky Endpoint Security определяет протокол соединения, и передает пакеты соответствующему компоненту:
- `HTTP`, `HTTPS`, `FTP` - **Защита от веб-угроз**, **Веб-контроль**
- `SMTP`, `POP3`, `POP3S IMAP`, `NNTP` - **Защита от почтовых угроз**

Остальные пакеты поступают сразу к программам и приложениям, для которых они предназначены.

> Kaspersky Endpoint Security проверяет данные в защищенных соединениях (SSL/TLS)

Kaspersky Endpoint Security может перехватывать не все исходящие соединения, а только соединения на заданные порты. Для этого в политике Kaspersky Endpoint Security на вкладке Параметры программы выберите раздел `Общие настройки | Настройки сети` и в области `Контролируемые порты` выберите **Контролировать только выбранные сетевые порты**. Нажмите ссылку `Выбрано N портов` и укажите порты, которые нужно перехватывать.

Если вы не знаете, какие именно порты использует программа, включите опцию Контролировать все порты для указанных программ, и добавьте в список путь к исполняемому файлу программы.

###### Как Kaspersky Endpoint Security проверяет зашифрованный трафик

![[Pasted image 20260216133629.png]]

В процессе установки, `Kaspersky Endpoint Security` создает самоподписанный сертификат - `Kaspersky Endpoint Security Personal Root Certificate` и помещает его в локальное хранилище компьютера - `Trusted Root Certification Authorities`. При каждом запуске, KES проверяет наличие сертификата в хранилище, и если не его там нет, восстанавливает.

Проверка зашифрованного трафика (`SSL`/`TLS`) Kaspersky Endpoint Security осуществляется с помощью подмены сертификата. Kaspersky Endpoint Security перехватывает исходящее соединение от программы к серверу, получив сертификат сервера, KES генерирует аналогичный сеансовый сертификат, подписанный `Kaspersky Endpoint Security Personal Root Certificate` сертификатом, и отдает его клиентской программе. Это позволяет перехватить симметричный ключ шифрования и расшифровать весь сеанс связи.

Пользователь не получит никаких предупреждений от веб-браузера, поскольку `Kaspersky Endpoint Security Personal Root Certificate` находится в хранилище доверенных сертификатов.

Проверка зашифрованного трафика включена по умолчанию и влияет на работу следующих компонентов:
- Защита от веб-угроз
- Защита от почтовых угроз
- Веб-контроль

Протоколы `SSL`/`TLS` поддерживают три режима аутентификации: **аутентификация двух сторон**, **аутентификация сервера перед анонимным клиентом** и **полная анонимность**.

Например, когда пользователь подключается, по протоколу `https` к веб-серверу, в большинстве случаев используется второй режим аутентификации - **аутентификация сервера перед анонимным клиентом**. В этом случае подмена сертификата не вызывает проблем.

Большинство ресурсов в интернете используют защищенные соединения для передачи информации, поэтому не рекомендуется полностью отключать проверку защищенных соединений. Если проверка защищенных соединений мешает работе программ, настройте исключения.

Исключения настраиваются в политике Kaspersky Endpoint Security: откройте раздел `Параметры программы | Общие настройки | Настройки сети`. В области `Проверка защищенных соединений` доступны две ссылки для настройки исключений - **Доверенные адреса** и **Доверенные программы**.

Если проверка защищенных соединений мешает работе с веб-сайтом, добавьте адрес веб-сайта в список доверенных:
1.	Перейдите по ссылке Доверенные адреса
2.	Добавьте адрес веб-сайта в список. Чтобы задать маску, используйте спецсимволы `«*»` и `«?»`

Подмена сертификата для перечисленных в этом списке адресов сайтов осуществляться не будет.

Если все же у вас окажется программа, которая конфликтует с проверкой защищенных соединений, отключите для нее проверку зашифрованного трафика:
1.	Перейдите по ссылке Доверенные программы
2.	Добавьте исполняемый файл программы на вкладке Программы: укажите полный путь к файлу, используйте переменные среды, такие как `%System Root%`
3.	Отметьте флаг `Не проверять сетевой трафик`, выберите параметр `Только зашифрованный трафик` и снимите другие флаги
4.	Если сервера, с которыми работает программа, имеют постоянные адреса (или фиксированный диапазон адресов) и порты, укажите их в нижней части окна: так безопаснее

#### 4.2. Защита от почтовых угроз

Защита от почтовых угроз защищает от угроз, которые могут присутствовать в почтовых сообщениях. Перехват сообщений осуществляется на уровне протоколов (`POP3`, `SMTP`, `IMAP` и `NNTP`), а также путем встраивания в Microsoft Office Outlook (`MAPI`).

Защита от почтовых угроз обнаруживает и удаляет вредоносные программы, используя для этого сигнатуры вредоносных программ, эвристический анализ и Kaspersky Security Network. Кроме этого, в Защите от почтовых угроз есть возможность блокировать или переименовывать почтовые вложения, удовлетворяющие заданным маскам.

В зараженных сообщениях Защита от почтовых угроз меняет тему письма. В измененной теме указывается выполненное действие.

###### Настройки Защиты от почтовых угроз

**Область защиты**

Параметры безопасности определяют, кроме прочего, Область защиты. В терминах Защиты от почтовых угроз область защиты может принимать два значения:
- Входящие и исходящие сообщения
- Только входящие сообщения

Для защиты компьютера достаточно проверять только входящие сообщения. Проверка исходящих может предотвратить непреднамеренную отправку зараженного файла в архиве и избежать неприятной ситуации. Также проверку исходящих можно использовать для блокирования обмена вложениями определенных типов, например, музыки или видео.

**Встраивание в систему**

Группа параметров Дополнительные настройки уточняет область защиты:
- Проверять трафик POP3/SMTP/NNTP/IMAP — включает проверку сообщений электронной почты и электронных новостей, передаваемых по указанным протоколам
- Подключить расширение для Microsoft Outlook — включает проверку объектов на уровне клиента Microsoft Office Outlook при получении, прочтении и отправке.
- Проверка на уровне протоколов работает независимо от используемых почтовых клиентов. Но сообщения, передаваемые по не перехватывающимся протоколам, как например, при работе с серверами Microsoft Exchange или Lotus Notes, проверяться не будут.
- Проверка на уровне почтового клиента, наоборот, работает независимо от того, каким образом получено сообщение. Правда, список поддерживаемых клиентов весьма ограничен.

**Способы проверки**

Если вложенные файлы являются архивами, они могут быть распакованы и просканированы. Это поведение регулируется тремя настройками:
- Проверять вложенные архивы — позволяет полностью отключить проверку архивов. Как правило, лучше оставить этот параметр включенным, и проверять архивы на лету Защитой от почтовых угроз. Гораздо легче не допустить попадания инфицированного архива в почтовую базу, чем потом удалять его из базы задачей поиска вирусов.
- Проверять вложенные файлы офисных форматов
- Не проверять архивы размером более `NN` МБ — ограничивает объем проверяемых архивов или файлов офисных форматов. Вредоносные программы исключительно редко распространяются в файлах большого размера. Включив это ограничение, можно избежать задержки при получении больших составных файлов.
- Ограничить время проверки архива до `NN` с — реализует защиту от «архивных бомб», проверка которых требует очень много времени и вычислительных ресурсов, затрудняя работу с компьютером

###### Фильтр вложений

Остальные параметры касаются только вложенных файлов. Администратор может:
- Не применять фильтр — пропускает все невредоносные вложения
- Переименовывать вложения указанных типов3 — используется по умолчанию и переименовывает вложения исполняемых типов (`.exe`, `.bat`, `cmd` и т.п.). Это превентивная мера против неизвестных угроз. Пользователь не сможет запустить вложенный файл, не переименовав его сознательно.
- Удалять вложения указанных типов — надежнее защищает от заражения, и кроме того может применяться для пресечения обмена файлами определенных типов: например, музыкальными или видеофайлами

#### 4.3. Защита от веб-угроз

Защита от веб-угроз выполняет две важные функции:
- Блокирует доступ к фишинг-сайтам и потенциально опасным сайтам, анализируя адреса веб-страниц, которые открывает пользователь или программы
- Проверяет объекты, загружаемые по протоколам HTTP, HTTPS и FTP и блокирует вредоносные файлы

Для проверки ссылок используются четыре технологии:
- Проверка по базе вредоносных веб-адресов — простое сравнение адреса открываемого сайта с адресами веб-ресурсов, замеченных в размещении вредоносных программ, выполнении атак на компьютеры и прочей вредоносной деятельности
- Проверка по базе фишинговых веб-адресов — выполняется так же, как предыдущая проверка, только по базе сайтов замеченных в фишинге
- Эвристический анализ для обнаружения фишинговых ссылок — анализ содержимого сайтов на наличие HTML-кода характерного для фишинга
- Проверка в `KSN` — адреса открываемых сайтов проверяются в `KSN`. Опасные ссылки блокируются. Полученный ответ сохраняется в локальный кэш и используется при дальнейших проверках.

###### Настройки Защиты от веб-угроз

**Действия**

Ко всем обнаруженным опасным объектам применяется одинаковое действие, которое можно выбрать из двух доступных:
- Запрещать загрузку
- Информировать

В политике нужно устанавливать действие **Запрещать загрузку** и делать его обязательным, чтобы пользователи не имели возможности загружать опасные объекты или посещать опасные веб-сайты.

При попытке открыть запрещенный веб-ресурс или загрузить зараженный объект, в браузере будет показано уведомление о том, что загрузка заблокирована Kaspersky Endpoint Security.

###### Как сделать веб-сайт доверенным

Если Защита от веб-угроз ошибочно считает веб-сайт вредоносным или фишинговым, добавьте адрес веб-сайта в список доверенных:
1.	В разделе Базовая защита перейдите по ссылке Защиты от веб-угроз
2.	Включите параметр Не проверять веб-трафик с доверенных веб-адресов
3.	Добавьте адрес веб-сайта в список. Чтобы задать маску, используйте спецсимволы `«*»` и `«?»`

Адреса сайтов, перечисленные в этом списке, а также загружаемые с них объекты, не будут проверяться Защитой от веб-угроз.

Если Защита от веб-угроз ошибочно считает вредоносным файл, который пользователь загружает с веб-сайта, сделайте исключение для файлов в Общих настройках на вкладке Параметры программы. Примените исключение как минимум к `Защите от веб-угроз`, `Защите от файловых угроз` и к `Поиску вирусов`.

