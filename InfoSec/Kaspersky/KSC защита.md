### 1. Как вредоносные программы попадают на компьютер

#### 1.1 Через браузер:
- Загрузка с диска (без согласия пользователя)
- За счет обмана пользователя

###### Уязвимый веб-браузер

У пользователя установлен уязвимый браузер. Используя уязвимость, веб-страница может заставить браузер загрузить и запустить на компьютере любую программу. Пользователь заходит на сомнительный веб-сайт — веб-сайт запускает на компьютере пользователя вредоносную программу. Вредоносный код может быть не на основных страницах веб-сайта, а в рекламных блоках, которые веб-сайт получает с других ресурсов.

**Чтобы защититься от такой атаки**:
- Устанавливайте обновления для веб-браузеров
- Не давайте пользователям запускать какие угодно браузеры
- Не давайте пользователям заходить на какие угодно веб-страницы
- Не давайте пользователям заходить известные зараженные сайты
- Не давайте веб-браузерам запускать дочерние процессы

###### Зараженный файл

Пользователь ищет в Интернете бесплатную программу. Например, бесплатную утилиту, которая делает что-то полезное для пользователя, или пиратскую версию платной программы, или генератор ключей для платной программы. Находит, загружает на компьютер и запускает.
Программа оказывается вредоносной. Может быть пользователь не разобрался и загрузил файл с подходящим названием с «интернет -помойки». Может быть злоумышленники подменили код у бесплатной программы или взломали страницу загрузки и подменили программу.

**Чтобы защититься от такой атаки**:
- Не давайте пользователям заходить на какие угодно веб-страницы
- Не давайте пользователям заходить известные сайты с вредоносными программами
- Проверяйте файлы, которые пользователь загружает из Интернет, средством защиты от угроз

#### 1.2 Через почту:
- Во вложении пользователь сам запускает
- Ссыпки в тепе письма на вредоносные веб-сайты

Пользователь получает по почте письмо, которое выглядит как письмо из банка, магазина, службы доставки, от партнера, знакомого и т.п. Текст письма просит перейти по ссылке или открыть вложение. По ссылке находится вредоносный или фишинговый веб-сайт. Во вложении — вредоносная программа или документ с вложенной вредоносной программой.

**Чтобы защититься от такой атаки**:
- Фильтруйте почту средствами защиты от спама (массовых анонимных рассылок)
- Проверяйте файлы, вложенные в электронные письма, средством защиты от угроз
- Не давайте пользователям сохранять на диск исполняемые файлы из электронных писем
- От ссылок в письмах защищайтесь как от атак через веб-браузер

#### 1.3 Через сменные носители
- Которые пользователь принес из дома или нашел на парковке

###### Своя «флешка»

Пользователь подключил к компьютеру флешку, скопировать на нее или с нее документы. На флешке есть вредоносная программа, которая использовала уязвимость в операционной системе, чтобы автоматически запуститься на компьютере. Либо пользователь подключил флешку, чтобы посмотреть, что на ней. Обнаружил документ или исполняемый файл с интригующим названием и решил открыть его. Файл оказался зараженным.

**Чтобы защититься от такой атаки**:
- Не разрешайте пользователям подключать к компьютеру неизвестные (или все) флешки — Проверяйте файлы на флешках средством защиты от угроз
- Устанавливайте обновления безопасности для операционной системы

###### BadUSB

Пользователь подключил к компьютеру USB-устройство, которое выглядит как флешка. Устройство зарегистрировалось в операционной системе как флешка, и как клавиатура. Через некоторое время устройство начало давать компьютеру команды, посылая сигналы нажатия клавиш.

**Чтобы защититься от такой атаки**, используйте средства защиты от атак BadUSB

#### 1.4 С других зараженных компьютеров по сети
- Пользователь сам копирует файл из общей палки
- Вредоносные программы атакуют уязвимые службы и программы на компьютере пользователя

###### Из общей папки

Пользователь скопировал из общей папки на другом компьютере программу и запустил ее. Программа оказалась вредоносной. Пользователь открыл документ из общей папки на другом компьютере. В документе был вредоносный код.

**Чтобы защититься от такой атаки**:
- Установите средства защиты на все компьютеры
- Проверяйте файлы, которые пользователи копируют, открывают или запускают

###### Атака по сети

В операционной системе на компьютере пользователя есть уязвимость. Если послать на определенный порт специальную последовательность пакетов, можно заставить уязвимую службу выполнить код, который содержится в этих пакетах. Зараженный компьютер в сети атакует уязвимую службу на всех окрестных компьютерах и заражает их.

**Чтобы защититься от такой атаки**:
- Устанавливайте обновления безопасности для операционной системы
- Запрещайте соединения с портами, которые не нужны для работы пользователя
- Проверяйте пакеты, которые принимает компьютер, на предмет сетевых атак средством защиты от угроз

### 2. Как вредоносные программы наносят вред

#### 2.1. Вымогатели

Вредоносная программа вымогатель шифрует документы и другие файлы на компьютере и в общих папках, и просит деньги за то, чтобы дать ключ шифрования. Ключ хранится на сервере злоумышленников. Вредоносная программа или загружает ключ с сервера, шифрует файлы и удаляет ключ; или формирует случайный ключ, посылает его на сервер, шифрует файлы и ключ удаляет. В любом случае программа-вымогатель связывается со своим сервером по сети.

**Чтобы защититься от такой атаки**:
- Регулярно делайте резервные копии всех важных файлов
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения 
- Используйте средства защиты, которые эвристически обнаруживают шифрование

#### 2.2. Шпионы

Вредоносная программа ищет незашифрованные или слабо зашифрованные пароли в настройках программ и в файлах на диске. Вредоносная программа перехватывает все, что вводит пользователь с клавиатуры, делает скриншоты экрана и снимки через веб-камеру. Все это программа оправляет на сервер злоумышленникам.

**Чтобы защититься от такой атаки**:
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения
- Используйте средства защиты, которые эвристически обнаруживают шпионские действия

#### 2.3. Сетевые вредоносные программы

Вредоносная программа записывает себя на подключенные к компьютеру флешки и в общие папки по сети. Вредоносная программа заражает соседние компьютеры через уязвимые службы. Вредоносная программа по команде из центра рассылает спам и участвует в DDOS-атаках.

**Чтобы защититься от такой атаки**:
- Не давайте неизвестным программам устанавливать и принимать сетевые соединения
- Используйте средства защиты, которые эвристически обнаруживают опасные действия

#### 2.4. Загрузчики

Часто, чтобы заразить обойти средства защиты и заразить компьютер, злоумышленники используют очень простые файлы, которые не несут никакого прямого ущерба. Но эти файлы могут загрузить дополнительные вредоносные файлы, которые уже могут шифровать документы, воровать пароли и т.д.

**Чтобы защититься от такой атаки**:
- не давайте неизвестным программам устанавливать и принимать сетевые соединения

#### 2.5. Некачественные вредоносные программы

Вредоносная программа приводит к тому, что другие программы зависают или работают с ошибками, компьютер тормозит, спонтанно перезагружается и выводит синий экран.

**Чтобы защититься от такой атаки**:
- регулярно проверяйте файлы на компьютере средством защиты от угроз

#### 2.6. Компоненты Kaspersky Endpoint Security

| Потенциальные цели атак                                                           | Компонент                                |
| --------------------------------------------------------------------------------- | ---------------------------------------- |
| Устанавливайте обновления безопасности для операционной системы                   | Kaspersky Security Center                |
| Устанавливайте обновления для веб-браузеров и других программ                     | Kaspersky Security Center                |
| Не давайте пользователям запускать какие угодно браузеры                          | Контроль программ                        |
| Не давайте пользователям заходить на какие угодно вебстраницы                     | Веб-контроль                             |
| Не давайте веб-браузерам запускать дочерние процессы                              | Анализ поведения<br>Защита от эксплойтов |
| Не давайте пользователям сохранять на диск исполняемые файлы из электронных писем | Защита от почтовых угроз                 |
| Запрещайте соединения с портами, которые не нужны для работы пользователя         | Сетевой экран                            |
| Не разрешайте пользователям подключать к компьютеру неизвестные (или все) флешки  | Контроль устройств                       |
| Не давайте неизвестным программам устанавливать и принимать сетевые соединения    | Сетевой экран                            |

| Обнаружение атак                                                                                         | Компонент                                            |
| -------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| Установите средства защиты на все компьютеры                                                             | Kaspersky Security Center                            |
| Проверяйте файлы, которые пользователи копируют, открывают или запускают                                 | Защита от файловых угроз<br>Предотвращение вторжений |
| Проверяйте файлы на флешках средством защиты от угроз                                                    | Поиск вирусов                                        |
| Проверяйте файлы, вложенные в электронные письма, средством защиты от угроз                              | Защита от почтовых угроз                             |
| Проверяйте файлы, которые пользователь загружает из Интернет, средством защиты от угроз                  | Защита от веб-угроз                                  |
| Не давайте пользователям заходить известные зараженные и фишинговые сайты                                | Защита от веб-угроз                                  |
| Не давайте пользователям заходить известные сайты с вредоносными программами                             | Защита от веб-угроз                                  |
| Проверяйте пакеты, которые принимает компьютер, на предмет сетевых атак средствам защиты от угроз        | Защита от сетевых угроз                              |
| Не давайте пользователям возможность автоматически подключать любые USB устройства в качестве клавиатуры | Защита от атак BadUSB                                |
| Используйте средства защиты, которые эвристически обнаруживают опасные действия                          | Защита от атак BadUSB                                |
| Используйте средства защиты, которые эвристически обнаруживают опасные действия                          | Анализ поведения<br>Предотвращение вторжений         |
| Регулярно проверяйте файлы на компьютере средством защиты от угроз                                       | Поиск вирусов                                        |

### 3. Как настроить защиту файлов

#### 3.1. Как Kaspersky Endpoint Security защищает файлы?

С помощью драйвера `klif.sys` Защита от файловых угроз перехватывает все файловые операции (такие как, чтение, копирование, выполнение) и проверяет файлы, с которыми выполняются действия. В случае если файл заражен, операция блокируется, а сам файл лечится или удаляется.

Можно отключить Защиту от почтовых угроз и Защиту от веб-угроз, но пользователь все равно не сможет запустить зараженный файл, полученный по почте или из сети Интернет. В момент сохранения файла на диск его обнаружит и заблокирует Защита от файловых угроз. А запустить файл из вложения или веб-страницы без сохранения на диск нельзя.

Поэтому Защита от файловых угроз — один из важных компонентов Kaspersky Endpoint Security.

Защита от файловых угроз ищет вредоносные программы с помощью:
- Сигнатур вредоносных программ — база сигнатур — это «стоп-лист» известных вредоносных файлов. Если файл не соответствует ни одной записи в базе, значит он не вредоносный. Полноценный список, где у каждого известного вредоносного или зараженного файла есть отдельная запись, требует слишком много места, поэтому база сигнатур — это оптимизированный список, уменьшенный до размера, который можно загрузить на компьютер. Каждая запись идентифицирует семейство похожих угроз.
- Эвристического анализа (эмуляции выполнения) — помогает обнаруживать полиморфные вредоносные файлы, которые меняют свой код во время выполнения, и которые из-за этого сложно обнаружить по сигнатурам. Защита от файловых угроз запускает исполняемые файлы в специальной изолированной среде и ждет, не изменится ли код в памяти так, что начнет соответствовать сигнатуре.
- Проверки по `KSN` — Защита от файловых угроз посылает в KSN контрольную сумму файла и получает ответ: есть ли такой файл в базе KSN, и какая у него репутация. База KSN это и есть огромный список всех известных Лаборатории Касперского файлов (вернее, их контрольных сумм). В этом списке есть файлы с репутацией недоверенные. Это черный список, такие файлы Защита от файловых угроз блокирует. Есть файлы с репутацией доверенные. Это белый список, куда входят известные невредоносные файлы операционных систем и распространенных программ. Эти файлы Защита от файловых угроз не блокирует, даже если по сигнатурам они вредоносные. Вердикт KSN имеет больший приоритет, потому что KSN содержит больше информации, чем локальная база сигнатур.

Чтобы не замедлять компьютер, Защита от файловых угроз проверяет не все файлы, а только те файлы, которые могут заразить компьютер. Например, Защита от файловых угроз не проверяет архивы, потому что, чтобы запустить файл из архива, этот файл нужно извлечь. Если пользователь сам не извлек файл из архива, это делает операционная система незаметно для пользователя. В любом случае Защита от файловых угроз проверит и, если нужно, заблокирует извлеченные файлы.

Файлы, которые не проверила Защита от файловых угроз, проверяйте задачами поиска вирусов. Поиск вирусов проверяет файлы в указанной области и применяет те же методы, что и Защита от файловых угроз.

#### 3.2. Что и как настроить в Защите от файловых угроз

Защита от файловых угроз, как и Kaspersky Endpoint Security в целом, решает две задачи:
- Не дать вредоносным программам нанести ущерб
- Не мешать работать пользователю и программам

Чем больше файлов проверяет Защита от файловых угроз, тем лучше он решает первую задачу, и тем хуже вторую. И наоборот. Настройки по умолчанию обеспечивают баланс между защитой и производительностью. Меняя настройки, администратор может сместить баланс в ту или другую сторону.

###### Защита от файловых угроз проверяет не все типы файлов

Файлы, которые могут нанести вред компьютеру, это в основном исполняемые файлы, но не только. Документы Microsoft Office могут содержать исполняемый код (макросы), который может быть вредоносным. Даже документы без кода, некоторые графические файлы, могут использовать уязвимости в программах, которые их открывают, и заставить эти программы выполнить часть файла как код.

По умолчанию Защита от файловых угроз проверяет файлы по формату. Так Kaspersky Endpoint Security надежно защищает компьютер, поскольку проверяет все опасные файлы, но меньше загружает компьютер, поскольку проверяет не все файлы.

Проверять файлы только по расширению опасно. Например, вредоносный документ Word может иметь расширение `.123`, которое не входит в список проверяемых, но пользователь все равно может его открыть через контекстное меню Открыть с помощью. К тому же, проверять по расширению не намного быстрее, чем проверять по формату. Пользователь не заметит разницы в производительности.

Если администратор хочет улучшить производительность медленных компьютеров, лучше начать с исключений для программ, с которыми работают пользователи.

Эвристический анализ в Kaspersky Endpoint Security запускает исполняемый программы в изолированной среде и смотрит, что они делают. В первую очередь эвристический анализ помогает обнаруживать полиморфные вредоносные программы, которые меняют свой код во время выполнения.

###### Защита от файловых угроз не проверяет файлы, которые уже проверяла

Большая часть файлов на компьютере меняется редко, поэтому проверяя только новые и измененные файлы, Защита от файловых угроз почти не загружает компьютер. В первые несколько дней, пока все файлы для Kaspersky Endpoint Security новые, пользователь может ощущать, что компьютер работает медленнее. Но довольно скоро Защита от файловых угроз перестает заметно влиять на производительность.

> Не выключайте опцию Проверять только новые и измененные файлы в Защите от файловых угроз, это замедлит компьютер.

![[Pasted image 20260216115225.png]]

![[Pasted image 20260216115245.png]]

![[Pasted image 20260216115303.png]]

###### Как Kaspersky Endpoint Security узнает, какие файлы менялись, а какие нет?

Файловая система NTFS (и ее наследник ReFS) записывает, когда файлы меняются, и гарантирует целостность этих записей. Поэтому на дисках с файловой системой NTFS Kaspersky Endpoint Security просто смотрит на дату изменения файла.

Файловая система `FAT32` может не записывать дату изменения, и не защищает саму дату изменения от изменений. Вредоносная программа может изменить файл, а потом записать ему какую угодно дату изменения. Поэтому на дисках с файловой системой `FAT32` Kaspersky Endpoint Security сохраняет в специальную базу контрольные суммы проверенных файлов. При следующем обращении Kaspersky Endpoint Security заново вычисляет контрольную сумму и сравнивает ее с сохраненной. Если суммы отличаются, значит файл изменился, и Защита от файловых угроз его проверяет.

