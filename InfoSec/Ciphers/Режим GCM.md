# 1. Режим GCM (Galois/Counter Mode)

**GCM** — это режим работы блочного шифра, который сочетает в себе:
- **CTR (Counter Mode)** — для шифрования данных
- **Аутентификацию Галуа (Galois)** — для проверки целостности и подлинности

Он обеспечивает **две ключевые функции одновременно**:
- **Конфиденциальность** — защита содержимого
- **Целостность и аутентификация** — защита от подделки и изменений

##### Преимущества GCM

- **Очень быстрый** — поддерживает параллельную обработку
- **Безопасный** — обеспечивает как шифрование, так и аутентификацию
- **Стандартизован** — используется в TLS, IPsec, IEEE 802.1AE
- **Устойчив к повторным атакам** — при правильном управлении одноразовыми номерами

## 1.1 Как работает GCM
1. **Генерация одноразового номера (nonce)**
    - Уникальное значение, используемое для каждого сообщения (например, счётчик или случайное число)
2. **Шифрование данных (CTR)**
    - Вместо прямого шифрования текста, GCM шифрует **счётчик**, а затем **XOR'ит** его с открытым текстом
    - Это позволяет **параллельно обрабатывать блоки**, ускоряя выполнение
3. **Генерация тега аутентификации (MAC)**
    - Используется **алгоритм Галуа** для создания **тега**, который проверяет, что данные не были изменены
    - Тег зависит от: шифртекста, одноразового номера, дополнительной аутентифицируемой информации (AAD)
4. **Отправка данных**
    - Получатель получает: шифртекст + тег аутентификации + одноразовый номер
5. **Проверка на стороне получателя**
    - Получатель расшифровывает данные и **проверяет тег**
    - Если тег не совпадает — данные считаются **подделанными или повреждёнными**

### 1.1.1 Что такое nonce

**Nonce** (от англ. _number used once_) — это **уникальное значение**, которое используется **один раз** в процессе шифрования. Оно **не является секретом**, но играет критически важную роль в обеспечении **уникальности шифрования**.

