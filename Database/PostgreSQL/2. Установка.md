
Обновляем списки пакетов:

```shell
sudo apt update
```

Загрузим PostgreSQL с утилитой `-contrib`:

```shell
sudo apt install postgresql postgresql-contrib
```

Загрузятся драйверы PostgreSQL последней версии и развернутся необходимые компоненты.

Запускаем сервис postgresql:

```shell
sudo systemctl start postgresql.service
```

Проверка статуса сервиса:

```shell
sudo systemctl status postgresql.service
```

#### 2.1. Работа с аккаунтом PostgreSQL

PostgreSQL применяет термин «`Роль`». Практически это тот же аккаунт в Ubuntu. При запуске СУБД роли сервиса привязываются к одноименным аккаунтам в Unix-системах.

Другими словами, при наличии роли в `PostgreSQL`, войти в СУБД можно с аккаунтом `Ubuntu`. При запуске СУБД генерируется аккаунт `postgres`, привязываемый к роли `PostgreSQL`.

##### Вариант 1

Входим в аккаунт пользователя `postgres`

```shell
sudo -i -u postgres
```

Открываем консоль Postgres:

```shell
psql
```

Возврат в аккаунт:

```shell
\q
```

##### Вариант 2

Входим в аккаунт `postgres` с `sudo`

```shell
sudo -u postgres psql
```

#### 2.2. Создание роли

Аккаунт `postgres` обладает правами администратора. Напишем `createuser`, эта команда сообщает, что мы добавляем новую роль. Чтобы указать имя роли и выдать суперюзера, применим флаг —`--interactive`.

```shell
sudo -u postgres createuser --interactive
```

Далее вводим имя

Команда для просмотра других ключей настроек:

```shell
man createuser
```


#### 2.3. Создание базы данных

Любому созданному аккаунту привязывается база данных с идентичным именем, то есть наш созданный «`tester`» начнет подключаться к базе данных `tester`.

Командой `createdb` можно добавить новую базу `PostgreSQL`, назвав ее `tester`:

```shell
sudo -u postgres createdb tester
```

#### 2.4. Переход в командную строку PostgreSQL с новой ролью

Работа в консоли `PostgreSQL` подразумевает наличие аккаунта `Ubuntu` с именем БД в `Postgres`.

Добавим аккаунт `Ubuntu`, используя `adduser` (предварительно выйдя из аккаунта `postgres`), назвав аналогично новой роли:

```shell
sudo adduser tester
```

Добавив аккаунт `tester`, переключаемся на него и подключаемся к консоли:

```shell
sudo -u tester psql
```

#### 2.5. Удаление PostgreSQL

Перед удалением `PostgreSQL` и очисткой сервера от следов сервиса удостоверимся, что СУБД остановлена.

```shell
ps -Cpostgres
```

Если СУБД остановлена, ответ на команду не должен показать никаких результатов. В ином случае, обслуживание нужно остановить. Остановить PostgreSQL:

```shell
sudo systemctl stop postgresql
```

Далее удаляем PostgreSQL:

```shell
sudo apt-get --purge remove postgresql\*
```

После удаления пропишем команды:

```shell
sudo rm -r /etc/postgresql/
sudo rm -r /var/lib/postgresql/
sudo userdel -r postgres
sudo groupdel postgres
```

#### 2.5 Установка pgAdmin 4

Если сервер `PostgreSQL` находится на одном компьютере, а программу `pgAdmin 4` будет стоять на другом, тогда необходимо настроить сервер `PostgreSQL`

Для начала заходим в PostgreSQL через терминал:

```shell
sudo -i -u postgres psql
```

Далее вводим команду «`\password`» для установки пароля.

По умолчанию сервер `Postgres` слушает только локальный интерфейс `127.0.0.1`. Чтобы изменить конфигурацию, с помощью любого редактора откройте файл `postgresql.conf`.

```shell
sudo nano /etc/postgresql/14/main/postgresql.conf
```

Находим в файле конфигурации раздел `CONNECTIONS AND AUTHENTICATION` и строку `#listen_addresses = 'localhost'`. Изменяем значение строки на `listen_addresses = '*'`. Если вы хотите, чтобы сервер слушал не все сетевые интерфейсы, а только выбранный, укажите его вместо звёздочки.

Последний шаг — разрешение подключений из сети. Чтобы установить его, нужно отредактировать файл `pg_hba.conf`.

```shell
sudo nano /etc/postgresql/14/main/pg_hba.conf
```

Найдите строку `IPv4 local connections`. Укажите нужную сеть.

```shell
host all all 10.92.192.0/24 scram-sha-256
```

Сохраняем файл и перезапускаем службу Postgres, чтобы изменения вступили в силу:

```shell
sudo service postgresql restart
```