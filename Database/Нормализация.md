
### Исходные данные

"Сотрудники"

|Сотрудник|Дата трудоустройства|Роли|Грейд|Зарплата|Кол-во мониторов|
|---|---|---|---|---|---|
|Иванов Иван Иванович|01.01.2024|бекендер, фрондендер, девопс, тимлид|сеньор|999|4|
|Семёнов Семён Семёныч|02.01.2024|бекендер|джун|200|2|
|Петр Петров Петрович|03.01.2024|фронтендер|джун|200|2|
|Алексеев Алексей Алексеич|04.01.2024|девопс|мидл|500|4|

---

## 1 Нормальная форма

Каждое поле содержит одно значение. Нет составных данных.

|Имя|Фамилия|Отчество|Дата трудоустройства|Роль|Грейд|Зарплата|Кол-во мониторов|
|---|---|---|---|---|---|---|---|
|Иван|Иванов|Иванович|01.01.2024|бекендер|сеньор|999|2|
|Иван|Иванов|Иванович|01.01.2024|фрондендер|сеньор|999|2|
|Иван|Иванов|Иванович|01.01.2024|девопс|сеньор|999|4|
|Иван|Иванов|Иванович|01.01.2024|тимлид|сеньор|999|1|
|Семён|Семёнов|Семёныч|02.01.2024|бекендер|джун|200|2|
|Петр|Петров|Петрович|02.01.2024|фронтендер|джун|200|2|
|Михаил|Михайлович|Михалыч|03.01.2024|девопс|мидл|500|4|

---

## 2 Нормальная форма

Первая нормальная форма + первичный ключ + отсутствие дублей

## 3 Нормальная форма

Вторая нормальная форма + все атрибуты зависят только от первичного ключа

"Грейды"

|id|название|Зарплата|
|---|---|---|
|1|сеньор|999|
|2|мидл|500|
|3|джун|200|

"Роли"

|id|название|Кол-во мониторов|
|---|---|---|
|1|бекендер|2|
|2|фронтендер|2|
|3|девопс|4|
|4|тимлид|1|

"Сотрудники"

|id|Имя|Фамилия|Отчество|Дата трудоустройства|
|---|---|---|---|---|
|1|Иван|Иванов|Иванович|01.01.2024|
|2|Семён|Семёнов|Семёныч|02.01.2024|
|3|Петр|Петров|Петрович|02.01.2024|
|4|Михаил|Михайлович|Михалыч|03.01.2024|

"Грейды сотрудников"

|id_сотрудника|id_грейда|
|---|---|
|1|1|
|2|3|
|3|3|
|4|2|

"Занимаемые роли"

|id_сотрудника|id_роли|
|---|---|
|1|1|
|1|2|
|1|3|
|1|4|
|2|1|
|3|2|
|4|3|

## Как выполнить нормализацию

Процесс нормализации данных нужно прописать на этапе проектирования базы, то есть до начала сбора данных. Если этого не сделать, есть риск, что база данных будет спроектирована плохо и её придётся переделывать.

## Правила нормализации баз данных

По правилам нормализации есть семь нормальных форм баз данных:

- Первая,
- Вторая,
- Третья,
- Нормальная форма Бойса-Кодда,
- Четвёртая,
- Пятая,
- Шестая.

Приводить данные к нормальным формам можно только последовательно. То есть в базе данных второй нормальной формы данные по умолчанию уже должны быть нормализованы по правилам первой нормальной формы и так далее. В итоге база данных в шестой нормальной форме — идеально нормализованная.

В некоторых случаях попытка нормализовать данные до «идеального» состояния может привести к созданию множества таблиц, ключей и связей. Это усложнит работу с базой и снизит производительность СУБД. Поэтому обычно данные нормализуют до третьей нормальной формы.

##### Первая нормальная форма

Первая нормальная форма сводится к трем правилам:
1. Каждая ячейка таблицы может хранить только одно значение.
2. Все данные в одной колонке могут быть только одного типа.
3. Каждая запись в таблице должна однозначно отличаться от других записей.

**1. Каждая ячейка – одно значение**

В базе данных не должно быть дубликатов и составных данных.

![[Pasted image 20250820155735.png]]

Слева данные о фамилии, имени и отчестве покупателей записаны в одно поле. Справа эти данные приведены к первой нормальной форме — каждый элемент записан в отдельное поле.

**2. Данные одного типа**

Разные данные в рамках одного поля тоже не дают выполнить агрегирующие запросы, например, поиск сумм, максимального, минимального. Еще усложняется обработка данных на уровне кода. В коде придется каким-то образом понимать, что из себя представляют данные.

**3. Уникальные записи**

Реляционная модель требует от нас уникальности каждой записи. Иначе нельзя понять, что к чему относится и с какой записью нужно работать при изменениях. Можно начать править не то и потерять важную информацию. При этом мы не можем полагаться на порядок данных внутри таблицы, так как он не гарантирован.

Лучшим вариантом будет добавить первичный ключ (`PRIMARY KEY`) — поле или набор полей, которые содержат уникальное значение для каждой записи. Первичный ключ не может меняться, его значение однозначно определяет любую запись в таблице.

Виды первичного ключа:

**Естественный** — когда используются значения из окружающего мира, например, email, ФИО или паспортные данные. При этом нужно убедиться, что ключ не будет повторяться. Такие первичные ключи используют редко из-за их ненадежности. Часто они не уникальны и могут изменяться или повторяться. Например, номер паспорта меняется при смене документа.

**Суррогатный** — когда используются автоматически генерируемые уникальные значения. Такой ключ поддерживается любой базой данных «из коробки». Иногда это просто числа, а иногда — сложные число-буквенные строки или хеши.

##### Вторая нормальная форма

Вторая нормальная форма включает в себя два требования:

1. Таблица должна быть в первой нормальной форме.
2. Все неключевые атрибуты таблицы должны зависеть от первичного ключа.

Если упростить: у каждой записи в базе данных должен быть **первичный ключ**. **Первичный ключ** — это элемент записи, который не повторяется в других записях.

Допустим, покупатель Егор Кузнецов купил цельнозерновой хлеб за 75 рублей в сетевом магазине продуктов города Москвы. Запись о его покупке появилась в базе данных. Нельзя исключать, что другой Егор Кузнецов в этот день купит такой же товар в другом магазине сети. Запись о покупке тоже появится в базе.

![[Pasted image 20250820160226.png]]

Чтобы записи не перепутались, можно добавить к ним идентификатор покупки, например номер чека. Идентификатор покупки — это первичный ключ.

##### Третья нормальная форма

Третья нормальная форма включает в себя два пункта:

1. Таблица должна быть во второй нормальной форме.
2. Все колонки в таблице зависят от первичного ключа и не зависят друг от друга.

В записи не должно быть столбцов с неключевыми значениями, которые зависят от других неключевых значений.

![[Pasted image 20250820160603.png]]

Личный номер сотрудника — это первичный ключ. Данные во втором и третьем столбце напрямую зависят от первичного ключа. Но между личным номером сотрудника и руководителем отдела только **косвенная** или **транзитивная связь**. Её в базе данных третьей нормальной формы быть не должно.

**Транзитивная зависимость в базе данных** — это косвенная связь между значениями в одной и той же таблице, которая вызывает функциональную зависимость. Чтобы достичь стандарта нормализации третьей нормальной формы (3NF), вы должны устранить любые переходные зависимости.

Данные о руководителях отделов нужно *вынести в другую таблицу*. Тогда в основной таблице не будет транзитивных связей, и она будет соответствовать третьей нормальной форме.

Данные не во всех случаях преобразовывают до третьей формы. Иногда для этого придётся создать много небольших таблиц, что усложнит базу и задачу разработчикам.

